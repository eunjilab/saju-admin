<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Í≤∞Í≥º ÏÉùÏÑ±Í∏∞ V3 | Ïö¥Î™ÖÏùÑ Îì£Îã§</title>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&family=Nanum+Myeongjo:wght@400;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Nanum Gothic', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
            line-height: 1.7;
        }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 30px 20px; }
        
        .header { text-align: center; margin-bottom: 30px; }
        .header .step-badge { display: inline-block; background: rgba(212, 175, 130, 0.2); border: 1px solid #d4af82; padding: 5px 15px; border-radius: 20px; font-size: 12px; color: #d4af82; margin-bottom: 10px; }
        .header h1 { font-size: 28px; color: #d4af82; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .header p { color: #888; font-size: 14px; }
        
        /* V3 Î≤ÑÏ†Ñ Î∞∞ÏßÄ Ï∂îÍ∞Ä */
        .version-badge { display: inline-block; background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); color: #fff; font-size: 11px; font-weight: bold; padding: 3px 10px; border-radius: 12px; }
        
        .main-layout { display: grid; grid-template-columns: 450px 1fr; gap: 30px; }
        @media (max-width: 1100px) { .main-layout { grid-template-columns: 1fr; } }
        
        .input-section { background: linear-gradient(135deg, rgba(212, 175, 130, 0.1) 0%, rgba(212, 175, 130, 0.05) 100%); border: 2px solid #d4af82; border-radius: 16px; padding: 25px; }
        .input-section h3 { font-size: 16px; color: #d4af82; margin-bottom: 15px; }
        .input-section p.hint { font-size: 13px; color: #aaa; margin-bottom: 15px; line-height: 1.7; }
        .input-textarea { width: 100%; height: 450px; background: #1a1a2e; border: 1px solid #444; border-radius: 8px; color: #e0e0e0; padding: 15px; font-size: 12px; font-family: monospace; resize: vertical; line-height: 1.6; }
        .input-textarea:focus { outline: none; border-color: #d4af82; }
        
        .btn-row { display: flex; gap: 10px; margin-top: 15px; }
        .btn { flex: 1; padding: 14px; border: none; border-radius: 8px; font-size: 14px; font-weight: bold; cursor: pointer; transition: all 0.3s; }
        .btn-primary { background: linear-gradient(135deg, #d4af82 0%, #b8956a 100%); color: #1a1a2e; }
        .btn-secondary { background: rgba(255, 255, 255, 0.1); color: #e0e0e0; border: 1px solid #444; }
        .btn:hover { transform: translateY(-2px); }
        
        .parse-result { margin-top: 15px; padding: 15px; background: rgba(0, 0, 0, 0.3); border-radius: 10px; font-size: 12px; display: none; }
        .parse-result.show { display: block; }
        .parse-result.success { border-left: 4px solid #4ade80; }
        .parse-result.error { border-left: 4px solid #ef4444; }
        .parsed-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
        .parsed-item { display: flex; justify-content: space-between; padding: 5px 0; }
        .parsed-item .label { color: #888; }
        .parsed-item .value { color: #d4af82; font-weight: bold; }
        .page-list { max-height: 150px; overflow-y: auto; margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.1); }
        .page-list-title { font-size: 11px; color: #888; margin-bottom: 8px; }
        .page-item { display: flex; align-items: center; gap: 8px; padding: 5px 8px; background: rgba(255, 255, 255, 0.03); border-radius: 5px; margin-bottom: 4px; font-size: 11px; }
        .page-item .num { width: 18px; height: 18px; background: #d4af82; color: #1a1a2e; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 9px; font-weight: bold; }
        
        .preview-panel { background: #fff; border-radius: 16px; overflow: hidden; }
        .preview-header { background: linear-gradient(135deg, #1a1a2e 0%, #2d2d4a 100%); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 10; }
        .preview-header h2 { font-size: 14px; color: #d4af82; }
        .btn-download { padding: 10px 20px; border: none; border-radius: 6px; font-size: 13px; cursor: pointer; font-weight: bold; background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%); color: #fff; transition: all 0.3s; }
        .btn-download:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(74, 222, 128, 0.3); }
        .preview-content { max-height: calc(100vh - 180px); overflow-y: auto; }
        .empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 500px; color: #888; background: #f8f6f1; }
        .empty-state .icon { font-size: 64px; margin-bottom: 20px; opacity: 0.3; }
    </style>
    
    <!-- Í≤∞Í≥ºÏßÄ Ïä§ÌÉÄÏùº -->
    <style id="resultStyles">
        .result-container { max-width: 600px; width: 100%; margin: 0 auto; font-family: 'Nanum Myeongjo', serif; background: #fffef9; color: #2d2418; line-height: 2.0; word-break: keep-all; background-image: radial-gradient(circle at 20% 50%, rgba(212,175,130,0.03) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(212,175,130,0.03) 0%, transparent 40%), radial-gradient(circle at 50% 80%, rgba(212,175,130,0.02) 0%, transparent 45%); }
        :root { --gold: #d4af82; --gold-dark: #b8956a; --gold-light: #e8d4b8; --navy: #3d4a6b; --navy-light: #4d5a7b; }
        
        /* Ïª§Î≤Ñ */
        .cover { background: linear-gradient(175deg, #1a1612 0%, #2d2418 40%, #3d3225 100%); color: #e8dcc8; text-align: center; padding: 50px 30px 55px; position: relative; }
        .cover::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: radial-gradient(circle at 15% 20%, rgba(212,175,130,0.04) 0%, transparent 25%), radial-gradient(circle at 85% 30%, rgba(212,175,130,0.04) 0%, transparent 25%); pointer-events: none; }
        .cover-line { width: 60px; height: 2px; background: linear-gradient(90deg, transparent, #a89068, transparent); margin: 0 auto 25px; }
        .cover-symbol { width: 70px; height: 70px; margin: 0 auto 25px; border: 2px solid rgba(168, 144, 104, 0.4); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 28px; font-weight: 700; color: #d4af82; position: relative; }
        .cover-symbol::after { content: ''; position: absolute; top: -8px; left: -8px; right: -8px; bottom: -8px; border: 1px solid rgba(168, 144, 104, 0.2); border-radius: 50%; }
        .cover-brand { font-size: 11px; letter-spacing: 6px; color: #a89068; margin-bottom: 20px; }
        .cover h1 { font-size: 36px; font-weight: 800; letter-spacing: 15px; margin-bottom: 8px; color: #f5efe3; text-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        .cover .subtitle { font-size: 14px; color: #a89068; letter-spacing: 4px; margin-bottom: 35px; }
        .cover-divider { width: 120px; height: 1px; background: linear-gradient(90deg, transparent, #a89068, transparent); margin: 0 auto 30px; }
        .cover-user { position: relative; z-index: 1; }
        .cover-user .pkg-label { font-size: 10px; letter-spacing: 3px; color: var(--gold); background: rgba(212, 175, 130, 0.15); padding: 8px 16px; border-radius: 20px; display: inline-block; margin-bottom: 18px; border: 1px solid rgba(212, 175, 130, 0.3); }
        .cover-user .name { font-size: 32px; font-weight: 700; color: #f5efe3; margin-bottom: 18px; }
        .cover-user .birth { font-size: 14px; color: #c4b5a0; margin-bottom: 8px; }
        .cover-user .saju { font-size: 18px; letter-spacing: 8px; color: var(--gold); font-weight: 600; }
        
        /* ÌûàÏñ¥Î°ú Ïπ¥Îìú */
        .hero-card { margin: 35px 20px; border-radius: 20px; padding: 40px 25px; text-align: center; color: #fff; border: 2px solid var(--gold); }
        .hero-card .label { font-size: 11px; letter-spacing: 4px; color: var(--gold); margin-bottom: 18px; }
        .hero-card .ilgan-char { font-size: 90px; font-weight: 800; margin-bottom: 12px; }
        .hero-card .ilgan-name { font-size: 26px; font-weight: 700; margin-bottom: 18px; letter-spacing: 3px; color: var(--gold-light); }
        .hero-card .ilgan-desc { font-size: 15px; line-height: 2.2; opacity: 0.9; max-width: 280px; margin: 0 auto; }
        
        /* ÏÑπÏÖò */
        .section { padding: 40px 20px; background: linear-gradient(180deg, #fffef9 0%, #fdfbf5 100%); position: relative; }
        .section::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 60px; height: 1px; background: linear-gradient(90deg, transparent, var(--gold-light), transparent); }
        .section-header { display: flex; align-items: center; gap: 12px; margin-bottom: 28px; }
        .section-icon { width: 42px; height: 42px; background: linear-gradient(135deg, var(--navy) 0%, var(--navy-light) 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: var(--gold); font-size: 18px; font-weight: 700; box-shadow: 0 3px 10px rgba(44,62,80,0.25); }
        .section-header h2 { font-size: 20px; font-weight: 700; color: var(--navy); letter-spacing: 2px; }
        
        /* ÏÇ¨Ï£º Í∑∏Î¶¨Îìú */
        .saju-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; max-width: 100%; margin: 0 auto; }
        .saju-pillar { background: linear-gradient(180deg, #fdfbf7 0%, #f5f0e6 100%); border: 1px solid #e5dccb; border-radius: 14px; padding: 12px 5px; text-align: center; position: relative; overflow: hidden; }
        .saju-pillar::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, var(--gold-light), var(--gold), var(--gold-light)); }
        .saju-pillar .pillar-label { font-size: 12px; color: #8b7355; margin-bottom: 10px; font-weight: 600; }
        .saju-pillar .heavenly, .saju-pillar .earthly { font-size: 32px; font-weight: 800; margin-bottom: 6px; }
        .saju-pillar .meaning { font-size: 11px; color: #8b7355; white-space: nowrap; }
        .wood { color: #2d5016; } .fire { color: #c41e3a; } .earth { color: #a08030; } .metal { color: #71797E; } .water { color: #1a5276; }
        
        /* Ïò§Ìñâ */
        .oheng-card { margin: 0 15px 30px; background: linear-gradient(135deg, #fdfbf7 0%, #f5f0e6 100%); border: 1px solid #e5dccb; border-radius: 16px; padding: 15px 10px; box-shadow: 0 4px 20px rgba(139,115,85,0.08); position: relative; overflow: hidden; }
        .oheng-card::before { content: ''; position: absolute; top: 0; left: 20px; right: 20px; height: 3px; background: linear-gradient(90deg, transparent, var(--gold), transparent); }
        .oheng-bar-list { display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px; }
        .oheng-bar-item { display: flex; align-items: center; gap: 8px; }
        .oheng-bar-label { width: 50px; display: flex; align-items: center; gap: 6px; }
        .oheng-bar-icon { width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700; color: #fff; }
        .oheng-bar-icon.wood-bg { background: linear-gradient(135deg, #4a7c23 0%, #2d5016 100%); }
        .oheng-bar-icon.fire-bg { background: linear-gradient(135deg, #e63946 0%, #c41e3a 100%); }
        .oheng-bar-icon.earth-bg { background: linear-gradient(135deg, #d4a017 0%, #8b6914 100%); }
        .oheng-bar-icon.metal-bg { background: linear-gradient(135deg, #9ca3af 0%, #71797E 100%); }
        .oheng-bar-icon.water-bg { background: linear-gradient(135deg, #2980b9 0%, #1a4d6e 100%); }
        .oheng-bar-icon.empty { opacity: 0.3; }
        .oheng-bar-name { font-size: 13px; font-weight: 600; color: #3d3225; }
        .oheng-bar-track { flex: 1; height: 20px; background: #ebe5d9; border-radius: 10px; overflow: hidden; position: relative; }
        .oheng-bar-fill { height: 100%; border-radius: 10px; min-width: 15px; }
        .oheng-bar-right { display: flex; flex-direction: column; align-items: flex-end; min-width: 40px; }
        .oheng-bar-value { font-size: 13px; font-weight: 700; color: #4a3d30; }
        .oheng-bar-info { font-size: 10px; color: #8b7355; }
        .oheng-bar-fill.wood-fill { background: linear-gradient(90deg, #4a7c23 0%, #5d9a2d 100%); }
        .oheng-bar-fill.fire-fill { background: linear-gradient(90deg, #c41e3a 0%, #e63946 100%); }
        .oheng-bar-fill.earth-fill { background: linear-gradient(90deg, #8b6914 0%, #d4a017 100%); }
        .oheng-bar-fill.metal-fill { background: linear-gradient(90deg, #71797E 0%, #9ca3af 100%); }
        .oheng-bar-fill.water-fill { background: linear-gradient(90deg, #1a4d6e 0%, #2980b9 100%); }
        .oheng-bar-empty-text { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); font-size: 11px; color: #a09080; }
        .oheng-warning { background: #fff8e7; border: 1px solid #f0d78c; border-radius: 8px; padding: 12px; display: flex; align-items: flex-start; gap: 8px; }
        .oheng-warning .icon { font-size: 16px; } .oheng-warning .text { font-size: 13px; color: #6b5a30; line-height: 1.7; }
        
        /* ÏñëÏùå Î∞∏Îü∞Ïä§ Ïπ¥Îìú */
        .yangum-card { margin: 0 20px 30px; background: linear-gradient(135deg, #fdfbf7 0%, #f5f0e6 100%); border: 1px solid #e5dccb; border-radius: 16px; padding: 25px 20px; }
        .yangum-gauge { display: flex; height: 32px; border-radius: 16px; overflow: hidden; margin: 20px 0; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); }
        .yangum-gauge .yang { background: linear-gradient(90deg, #f59e0b 0%, #fbbf24 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; font-size: 14px; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .yangum-gauge .eum { background: linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; font-size: 14px; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .yangum-labels { display: flex; justify-content: space-between; margin-bottom: 8px; }
        .yangum-labels .label { display: flex; align-items: center; gap: 6px; font-size: 13px; color: #5a4a38; }
        .yangum-labels .dot { width: 10px; height: 10px; border-radius: 50%; }
        .yangum-labels .dot.yang { background: #f59e0b; }
        .yangum-labels .dot.eum { background: #6366f1; }
        .yangum-type { background: linear-gradient(135deg, #3d3225 0%, #5a4a38 100%); border-radius: 12px; padding: 18px; text-align: center; margin-top: 20px; }
        .yangum-type .type-label { font-size: 11px; color: rgba(255,255,255,0.6); margin-bottom: 6px; }
        .yangum-type .type-name { font-size: 18px; font-weight: 700; color: #fbbf24; }
        .yangum-desc { margin-top: 20px; font-size: 14px; color: #5a4a38; line-height: 2.0; }
        
        /* Ïã†ÏÇ¥ Î∂ÑÏÑù Ïπ¥Îìú */
        .sinsal-card { margin: 0 20px 30px; background: linear-gradient(135deg, #fdfbf7 0%, #f5f0e6 100%); border: 1px solid #e5dccb; border-radius: 16px; padding: 25px 20px; }
        .sinsal-summary { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        .sinsal-group { background: #fff; border-radius: 12px; padding: 15px; }
        .sinsal-group.gilsin { border-left: 4px solid #22c55e; }
        .sinsal-group.hyungsin { border-left: 4px solid #f59e0b; }
        .sinsal-group .group-title { font-size: 13px; font-weight: 700; margin-bottom: 10px; display: flex; align-items: center; gap: 6px; }
        .sinsal-group.gilsin .group-title { color: #16a34a; }
        .sinsal-group.hyungsin .group-title { color: #d97706; }
        .sinsal-group .sinsal-list { font-size: 13px; color: #5a4a38; line-height: 1.8; }
        .sinsal-item { margin: 20px 0; padding: 20px; background: #fff; border-radius: 12px; border: 1px solid #e5dccb; }
        .sinsal-item.gilsin { border-left: 4px solid #22c55e; }
        .sinsal-item.yangmyeon { border-left: 4px solid #e65100; }
        .sinsal-item.hyungsin { border-left: 4px solid #c62828; }
        .sinsal-item .item-header { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; }
        .sinsal-item .item-icon { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 16px; }
        .sinsal-item.gilsin .item-icon { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); }
        .sinsal-item.yangmyeon .item-icon { background: linear-gradient(135deg, #e65100 0%, #ff8f00 100%); }
        .sinsal-item.hyungsin .item-icon { background: linear-gradient(135deg, #c62828 0%, #d32f2f 100%); }
        /* Ïã†ÏÇ¥ ÏöîÏïΩ Î™©Î°ù */
        .sinsal-summary-box { background: linear-gradient(135deg, #fdfbf7 0%, #f5f0e6 100%); border: 1px solid #e5dccb; border-radius: 16px; padding: 20px; margin: 20px 0; }
        .sinsal-summary-box .summary-title { font-size: 16px; font-weight: 700; color: var(--navy); margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #e5dccb; }
        .sinsal-summary-box .summary-group { margin-bottom: 15px; padding: 12px; border-radius: 10px; }
        .sinsal-summary-box .gilsin-group { background: rgba(46, 125, 50, 0.05); border-left: 3px solid #2e7d32; }
        .sinsal-summary-box .yangmyeon-group { background: rgba(230, 81, 0, 0.05); border-left: 3px solid #e65100; }
        .sinsal-summary-box .hyungsin-group { background: rgba(198, 40, 40, 0.05); border-left: 3px solid #c62828; }
        .sinsal-summary-box .group-title { font-weight: 700; font-size: 14px; margin-bottom: 10px; color: #4a3d30; }
        .sinsal-summary-box .summary-item { display: flex; flex-wrap: wrap; align-items: center; gap: 5px; padding: 5px 0; font-size: 13px; line-height: 1.6; }
        .sinsal-summary-box .item-marker { color: var(--gold); }
        .sinsal-summary-box .item-name { font-weight: 600; color: #4a3d30; }
        .sinsal-summary-box .item-hanja { color: #8b7355; font-size: 12px; }
        .sinsal-summary-box .item-desc { color: #666; font-size: 12px; }
        /* Ïã†ÏÇ¥ Ï¢ÖÌï© Ï°∞Ïñ∏ */
        .sinsal-advice { background: linear-gradient(135deg, #f5f0e6 0%, #e8e0d0 100%); border: 2px solid var(--gold); border-radius: 16px; padding: 25px; margin-top: 25px; }
        .sinsal-advice .advice-title { font-size: 18px; font-weight: 700; color: var(--navy); margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid var(--gold-light); }
        .sinsal-advice .advice-content { font-size: 14px; line-height: 1.9; color: #4a3d30; }
        .sinsal-item .item-name { font-size: 16px; font-weight: 700; color: #3d3225; }
        .sinsal-item .item-type { font-size: 11px; color: #8b7355; margin-top: 2px; }
        .sinsal-item .item-body { font-size: 14px; color: #5a4a38; line-height: 2.0; }
        .sinsal-combo { margin-top: 25px; padding: 20px; background: linear-gradient(135deg, #3d3225 0%, #5a4a38 100%); border-radius: 12px; color: #fff; }
        .sinsal-combo .combo-title { font-size: 14px; font-weight: 700; color: #d4af82; margin-bottom: 12px; }
        .sinsal-combo .combo-content { font-size: 14px; line-height: 2.0; opacity: 0.9; }
        
        /* Í≤©Íµ≠/Ïö©Ïã† Ïπ¥Îìú */
        .gyeokguk-card { margin: 0 20px 30px; background: linear-gradient(135deg, #f9f7f2 0%, #f0ebe0 100%); border: 1px solid #e5dccb; border-radius: 16px; padding: 25px 20px; }
        .gyeokguk-main { background: linear-gradient(135deg, #3d3225 0%, #5a4a38 100%); border-radius: 12px; padding: 20px; margin-bottom: 15px; }
        .gyeokguk-label { font-size: 11px; color: rgba(255,255,255,0.6); margin-bottom: 5px; }
        .gyeokguk-name { font-size: 20px; font-weight: 700; color: #d4af82; margin-bottom: 8px; }
        .gyeokguk-desc { font-size: 14px; color: rgba(255,255,255,0.85); line-height: 1.6; }
        .yongsin-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .yongsin-item { background: #fff; border: 1px solid #e5dccb; border-radius: 10px; padding: 15px; }
        .yongsin-item.highlight { background: linear-gradient(135deg, #fffbf0 0%, #fff8e7 100%); border-color: #d4af82; }
        .yongsin-item.caution { background: linear-gradient(135deg, #fff5f5 0%, #ffefef 100%); border-color: #e5a0a0; }
        .yongsin-item.caution .yongsin-value { color: #b06060; }
        .yongsin-type { font-size: 11px; color: #8b7355; margin-bottom: 5px; }
        .yongsin-value { font-size: 18px; font-weight: 700; color: #3d3225; margin-bottom: 5px; }
        .yongsin-desc { font-size: 12px; color: #6b5a30; line-height: 1.5; }
        .strength-bar { background: #ebe5d9; border-radius: 8px; padding: 12px 15px; margin-bottom: 15px; display: flex; align-items: center; justify-content: space-between; }
        .strength-label { font-size: 12px; color: #8b7355; }
        .strength-value { font-size: 14px; font-weight: 600; color: #3d3225; }
        
        /* Ìï¥ÏÑù Ïπ¥Îìú */
        .interpret-card { margin: 0 20px 25px; background: #fffef9; border: 1px solid #e5dccb; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(139,115,85,0.08); position: relative; }
        .interpret-card::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 4px; background: linear-gradient(180deg, var(--navy) 0%, var(--gold) 100%); }
        .interpret-card .card-header { background: linear-gradient(135deg, #f9f6ef 0%, #f0ebe0 100%); padding: 18px 20px 18px 24px; border-bottom: 1px solid #e5dccb; display: flex; align-items: center; gap: 12px; }
        .interpret-card .card-header .emoji { font-size: 24px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1)); } 
        .interpret-card .card-header h3 { font-size: 17px; font-weight: 700; color: var(--navy); }
        .interpret-card .card-body { padding: 25px 20px 25px 24px; text-align: center; }
        .interpret-card .card-body p { font-size: 15px; line-height: 2.2; color: #4a3d30; margin-bottom: 15px; word-break: keep-all; }
        
        /* ÌÇ§ÏõåÎìú ÌÉúÍ∑∏ */
        .keywords { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px; }
        .keyword-tag { background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%); color: #fff; padding: 10px 18px; border-radius: 25px; font-size: 13px; font-weight: 600; letter-spacing: 1px; }
        
        /* Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ */
        .checklist-item { display: flex; align-items: flex-start; gap: 10px; margin: 8px 0; }
        .checklist-item .checkbox { width: 18px; height: 18px; border-radius: 4px; flex-shrink: 0; margin-top: 2px; display: flex; align-items: center; justify-content: center; font-size: 11px; }
        .checklist-item .checkbox.empty { border: 2px solid var(--gold); background: #fffef9; }
        .checklist-item .checkbox.checked { background: var(--navy); color: #fff; }
        .checklist-item .text { flex: 1; font-size: 14px; color: #4a3d30; line-height: 1.6; }
        
        /* Ïö¥ÏÑ∏ Ïπ¥Îìú (2026ÎÖÑ) */
        .fortune-card { margin: 35px 20px; background: linear-gradient(135deg, #3d3225 0%, #2a2115 100%); border-radius: 20px; padding: 35px 25px; color: #ffffff; border: 2px solid var(--gold); box-shadow: 0 8px 30px rgba(0,0,0,0.2); }
        .fortune-card .card-title { font-size: 20px; font-weight: 700; margin-bottom: 28px; display: flex; align-items: center; gap: 10px; color: #ffffff; }
        .fortune-card .card-title .year { background: rgba(212, 175, 130, 0.25); padding: 6px 14px; border-radius: 8px; font-size: 15px; border: 1px solid rgba(212, 175, 130, 0.4); color: var(--gold); }
        .fortune-flow { display: flex; gap: 15px; margin-bottom: 25px; }
        .fortune-half { flex: 1; background: rgba(212, 175, 130, 0.1); border-radius: 14px; padding: 20px 15px; text-align: center; border: 1px solid rgba(212, 175, 130, 0.2); }
        .fortune-half .period { font-size: 12px; color: var(--gold); margin-bottom: 8px; font-weight: 600; }
        .fortune-half .rating { font-size: 26px; margin-bottom: 8px; }
        .fortune-half .desc { font-size: 13px; color: #ffffff; }
        .fortune-card .fortune-text { font-size: 14px; line-height: 2.1; color: #ffffff; }
        /* fortune-card ÎÇ¥Î∂Ä ÌÖçÏä§Ìä∏ Î∞ùÍ≤å */
        .fortune-card h2, .fortune-card h3, .fortune-card h4, .fortune-card h5 { color: #ffffff !important; background: transparent !important; border: none !important; padding: 0 !important; border-left: none !important; }
        .fortune-card p, .fortune-card li, .fortune-card span { color: #f5efe3 !important; }
        .fortune-card strong { color: #ffd700 !important; }
        .fortune-card em { color: #e8dcc8 !important; }
        .fortune-card ul, .fortune-card ol { color: #f5efe3 !important; }
        .fortune-card .checklist-item .text { color: #f5efe3 !important; }
        /* fortune-card ÎÇ¥Î∂Ä Î∞ïÏä§Îì§ Ïñ¥ÎëêÏö¥ ÌÖåÎßàÎ°ú ÌÜµÏùº */
        .fortune-card .goosebump-box, .fortune-card .saju-box, .fortune-card .advice-box,
        .fortune-card .caution-box, .fortune-card .hope-box, .fortune-card .strength-box,
        .fortune-card .empathy-box {
            background: linear-gradient(135deg, rgba(212,175,130,0.15) 0%, rgba(212,175,130,0.08) 100%) !important;
            border-left-color: var(--gold) !important;
        }
        .fortune-card .goosebump-box .label, .fortune-card .saju-box .label, .fortune-card .advice-box .label,
        .fortune-card .caution-box .label, .fortune-card .hope-box .label, .fortune-card .strength-box .label,
        .fortune-card .empathy-box .label { color: var(--gold) !important; }
        .fortune-card .goosebump-box .quote, .fortune-card .goosebump-box p, .fortune-card .saju-box p,
        .fortune-card .advice-box p, .fortune-card .caution-box p, .fortune-card .hope-box p,
        .fortune-card .strength-box p, .fortune-card .empathy-box p { color: #f5efe3 !important; }
        /* fortune-card ÎÇ¥Î∂Ä Ïù∏Ïö©Î¨∏/ÏΩîÎìúÎ∏îÎ°ùÎèÑ Ïñ¥Îë°Í≤å */
        .fortune-card [style*="background:#f9f6ef"], .fortune-card [style*="background:#f5f0e6"],
        .fortune-card [style*="background:linear-gradient(135deg,#f9f6ef"] {
            background: rgba(212,175,130,0.12) !important;
        }
        .fortune-card [style*="color:#4a3d30"], .fortune-card [style*="color:#2d2418"],
        .fortune-card [style*="color:#5d4e37"], .fortune-card [style*="color:#6b5744"],
        .fortune-card [style*="color:#5a4a38"], .fortune-card [style*="color:#5a4d40"] { color: #f5efe3 !important; }
        
        /* ÏõîÎ≥Ñ Ïö¥ÏÑ∏ */
        .monthly-section { padding: 40px 20px; }
        .monthly-grid { display: flex; flex-direction: column; gap: 15px; }
        .monthly-item { background: linear-gradient(135deg, #fdfbf7 0%, #f5f0e6 100%); border: 1px solid #e5dccb; border-radius: 14px; padding: 18px; }
        .month-header { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
        .month-num { background: var(--gold); color: #fff; padding: 5px 12px; border-radius: 20px; font-size: 13px; font-weight: 700; }
        .month-keyword { font-size: 15px; font-weight: 700; color: #2d2418; }
        .month-rating { margin-left: auto; font-size: 14px; }
        .month-text { font-size: 14px; line-height: 1.9; color: #4a3d30; }
        
        /* ÎåÄÏö¥ ÌÉÄÏûÑÎùºÏù∏ */
        .daeun-section { padding: 40px 20px; }
        .daeun-timeline { position: relative; padding-left: 25px; }
        .daeun-timeline::before { content: ''; position: absolute; left: 8px; top: 0; bottom: 0; width: 2px; background: linear-gradient(180deg, var(--gold), #e5dccb); }
        .daeun-item { position: relative; margin-bottom: 25px; padding: 18px; background: #fdfbf7; border: 1px solid #e5dccb; border-radius: 14px; }
        .daeun-item::before { content: ''; position: absolute; left: -21px; top: 22px; width: 12px; height: 12px; background: #e5dccb; border-radius: 50%; border: 2px solid #fff; }
        .daeun-item.current { background: linear-gradient(135deg, #fffef5 0%, #fff8e7 100%); border-color: var(--gold); }
        .daeun-item.current::before { background: var(--gold); box-shadow: 0 0 0 4px rgba(212, 175, 130, 0.3); }
        .daeun-period { font-size: 12px; color: var(--gold-dark); font-weight: 700; margin-bottom: 8px; }
        .daeun-title { font-size: 16px; font-weight: 700; color: #2d2418; margin-bottom: 8px; }
        .daeun-text { font-size: 14px; line-height: 1.9; color: #4a3d30; }
        .current-daeun-box { margin-top: 25px; padding: 20px; background: linear-gradient(135deg, #3d3225 0%, #2a2115 100%); border-radius: 14px; color: #e8dcc8; }
        .current-daeun-box .sub-label { color: var(--gold); font-size: 13px; font-weight: 700; margin-bottom: 10px; }
        .current-daeun-box p { color: #d4c5a9; font-size: 14px; line-height: 1.9; }
        
        /* Í∑ÄÏù∏/ÌîºÌï†ÏÇ¨Îûå */
        .gwiin-section { padding: 40px 20px; }
        .gwiin-grid { display: flex; flex-direction: column; gap: 20px; }
        .gwiin-card { padding: 25px 20px; border-radius: 16px; background: linear-gradient(135deg, #fdfbf7 0%, #f5f0e6 100%); border: 1px solid #e5dccb; }
        .gwiin-card.good { border-left: 4px solid var(--gold); }
        .gwiin-card.bad { border-left: 4px solid #a09080; }
        .gwiin-header { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; }
        .gwiin-header .emoji { font-size: 24px; }
        .gwiin-header h4 { font-size: 17px; font-weight: 700; color: #2d2418; }
        .gwiin-card p { font-size: 14px; line-height: 1.9; color: #4a3d30; margin-bottom: 15px; }
        .type-tags { display: flex; flex-wrap: wrap; gap: 8px; }
        .type-tag { padding: 8px 14px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        .type-tag.good { background: rgba(212, 175, 130, 0.2); color: var(--gold-dark); }
        .type-tag.bad { background: rgba(160, 144, 128, 0.2); color: #6b5a44; }
        
        /* ÏÑúÎ∏åÎ∞ïÏä§ */
        .sub-box { margin-top: 20px; padding: 18px; border-radius: 12px; background: #f9f6ef; border: 1px solid #e5dccb; }
        .sub-label { font-size: 13px; font-weight: 700; color: var(--gold-dark); margin-bottom: 10px; }
        .sub-box p { font-size: 14px; line-height: 1.9; color: #4a3d30; }
        .ideal-type { background: #fff5f5; border-color: #f0d5d5; }
        .warning-box { background: #fff8e7; border-color: #f0d78c; }
        .organs-box { background: #f5f5ff; border-color: #d5d5f0; }
        
        /* Part 2 ÌòïÏãù Î∞ïÏä§Îì§ - Í≥®ÎìúÌÜ§ ÌÜµÏùº */
        .goosebump-box { background: linear-gradient(135deg, #fffbf5 0%, #f9f3e8 100%); border-left: 4px solid #d4af82; padding: 20px; margin: 20px 0; border-radius: 0 12px 12px 0; text-align: left; }
        .goosebump-box .label { font-size: 12px; color: #8b7355; font-weight: 700; margin-bottom: 10px; }
        .goosebump-box .quote { font-size: 15px; color: #4a3d30; line-height: 2.0; word-break: keep-all; }
        
        .saju-box { background: linear-gradient(135deg, #f9f6ef 0%, #f0ebe0 100%); border-left: 4px solid #b8956a; padding: 20px; margin: 20px 0; border-radius: 0 12px 12px 0; text-align: left; }
        .saju-box .label { font-size: 12px; color: #8b7355; font-weight: 700; margin-bottom: 10px; }
        .saju-box p { font-size: 14px; line-height: 2.0; color: #4a3d30; word-break: keep-all; }
        
        .advice-box { background: linear-gradient(135deg, #fffbf5 0%, #f9f3e8 100%); border-left: 4px solid #d4af82; padding: 20px; margin: 20px 0; border-radius: 0 12px 12px 0; text-align: left; }
        .advice-box .label { font-size: 12px; color: #8b7355; font-weight: 700; margin-bottom: 10px; }
        .advice-box p { font-size: 14px; line-height: 2.0; color: #4a3d30; word-break: keep-all; }
        
        .caution-box { background: linear-gradient(135deg, #fef9f3 0%, #f5ede2 100%); border-left: 4px solid #c4a574; padding: 20px; margin: 20px 0; border-radius: 0 12px 12px 0; text-align: left; }
        .caution-box .label { font-size: 12px; color: #8b7355; font-weight: 700; margin-bottom: 10px; }
        .caution-box p { font-size: 14px; line-height: 2.0; color: #4a3d30; word-break: keep-all; }
        
        .hope-box { background: linear-gradient(135deg, #f9f6ef 0%, #f0ebe0 100%); border-left: 4px solid #d4af82; padding: 20px; margin: 20px 0; border-radius: 0 12px 12px 0; text-align: left; }
        .hope-box .label { font-size: 12px; color: #8b7355; font-weight: 700; margin-bottom: 10px; }
        .hope-box p { font-size: 14px; line-height: 2.0; color: #4a3d30; word-break: keep-all; }
        
        .empathy-box { background: linear-gradient(135deg, #f5f9f5 0%, #e8f0e8 100%); border-left: 4px solid #7cb07c; padding: 20px; margin: 20px 0; border-radius: 0 12px 12px 0; text-align: left; }
        .empathy-box .label { font-size: 12px; color: #5a8a5a; font-weight: 700; margin-bottom: 10px; }
        .empathy-box p { font-size: 14px; line-height: 2.0; color: #4a3d30; word-break: keep-all; }
        
        /* Íµ¨Î∂ÑÏÑ† */
        .divider { display: flex; align-items: center; justify-content: center; gap: 15px; margin: 35px 20px; color: #c4b5a0; font-size: 14px; }
        .divider::before, .divider::after { content: ''; flex: 1; height: 1px; background: linear-gradient(90deg, transparent, #d4c5a9, transparent); }
        
        /* ÏÑπÏÖò Íµ¨Î∂ÑÏÑ† (Î≤àÌò∏ + Ï†úÎ™©) */
        .section-divider { display: flex; align-items: center; justify-content: center; gap: 15px; margin: 40px 20px 25px; --sec-color: var(--navy); }
        .section-divider::before, .section-divider::after { content: ''; flex: 1; height: 1px; background: linear-gradient(90deg, transparent, #c4b5a0, transparent); }
        .section-divider .num { background: var(--sec-color); color: #fff; font-size: 11px; font-weight: 700; padding: 5px 12px; border-radius: 12px; letter-spacing: 1px; box-shadow: 0 2px 8px rgba(0,0,0,0.15); margin-right: 5px; }
        .section-divider .title { font-size: 14px; color: #3d3225; letter-spacing: 3px; font-weight: 600; }
        
        /* ÏÑπÏÖòÎ≥Ñ ÌÖåÎßà Ïª¨Îü¨ */
        .section-divider[data-num="01"] { --sec-color: #3d4a6b; }
        .section-divider[data-num="02"] { --sec-color: #6366f1; }
        .section-divider[data-num="03"] { --sec-color: #059669; }
        .section-divider[data-num="04"] { --sec-color: #8b5cf6; }
        .section-divider[data-num="05"] { --sec-color: #ec4899; }
        .section-divider[data-num="06"] { --sec-color: #f59e0b; }
        .section-divider[data-num="07"] { --sec-color: #ef4444; }
        .section-divider[data-num="08"] { --sec-color: #f97316; }
        .section-divider[data-num="09"] { --sec-color: #ec4899; }
        .section-divider[data-num="10"] { --sec-color: #3b82f6; }
        .section-divider[data-num="11"] { --sec-color: #eab308; }
        .section-divider[data-num="12"] { --sec-color: #22c55e; }
        .section-divider[data-num="13"] { --sec-color: #6366f1; }
        .section-divider[data-num="14"] { --sec-color: #14b8a6; }
        .section-divider[data-num="15"] { --sec-color: #8b5cf6; }
        .section-divider[data-num="16"] { --sec-color: #7c3aed; }
        .section-divider[data-num="17"] { --sec-color: #0891b2; }
        .section-divider[data-num="18"] { --sec-color: #ec4899; }
        .section-divider[data-num="19"] { --sec-color: #d4af82; }
        .section-divider[data-num="20"] { --sec-color: #8b7355; }
        
        /* ÎßàÎ¨¥Î¶¨ Ïπ¥Îìú */
        .final-card { margin: 35px 20px; background: linear-gradient(170deg, #2a2115 0%, #3d3225 50%, #2a2115 100%); border-radius: 20px; padding: 45px 28px; text-align: center; border: 1px solid rgba(212, 175, 130, 0.3); position: relative; }
        .final-card::before { content: '"'; position: absolute; top: 15px; left: 20px; font-size: 80px; font-family: Georgia; color: rgba(212,175,130,0.15); }
        .final-card .card-label { font-size: 11px; letter-spacing: 4px; color: var(--gold); margin-bottom: 25px; }
        .final-card .text { font-size: 17px; line-height: 2.4; color: #e8dcc8; margin-bottom: 25px; }
        .final-card .divider-line { width: 60px; height: 1px; background: var(--gold); margin: 0 auto 25px; }
        .final-card .quote { font-size: 15px; color: var(--gold); font-style: italic; line-height: 2; }
        .final-card .footer-text { font-size: 12px; color: #a89068; letter-spacing: 3px; margin-top: 25px; }
        
        .disclaimer { background: #f5f0e6; padding: 20px; border-radius: 12px; margin: 20px; font-size: 12px; color: #8b7355; text-align: center; line-height: 1.8; }
        .screenshot-guide { text-align: center; padding: 25px 20px; font-size: 14px; color: #8b7a60; background: linear-gradient(180deg, #fffef9 0%, #f5f0e6 100%); border-top: 1px solid #e5dccb; }
        
        /* Î™©Ï∞® ÌéòÏù¥ÏßÄ */
        .toc-page { padding: 30px 20px; background: linear-gradient(180deg, #fffef9 0%, #f9f6ef 100%); }
        .toc-page .page-title { text-align: center; margin-bottom: 20px; }
        .toc-page .page-title h2 { font-size: 18px; color: var(--navy); margin-bottom: 10px; }
        .toc-page .page-title .pkg-name { display: inline-block; background: linear-gradient(135deg, var(--navy) 0%, var(--navy-light) 100%); color: var(--gold); padding: 6px 16px; border-radius: 20px; font-size: 11px; letter-spacing: 2px; box-shadow: 0 3px 10px rgba(44,62,80,0.2); }
        .toc-list { list-style: none; background: #fffef9; border: 1px solid #e5dccb; border-radius: 12px; padding: 8px 16px; box-shadow: 0 4px 15px rgba(139,115,85,0.06); }
        .toc-item { display: flex; align-items: center; padding: 8px 0; border-bottom: 1px dashed #e5dccb; }
        .toc-item.clickable { cursor: pointer; }
        .toc-item.clickable:active { background: #f5f0e6; }
        .toc-item:last-child { border-bottom: none; }
        .toc-item .check { width: 18px; height: 18px; border-radius: 4px; margin-right: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .toc-item .check.included { background: var(--navy); }
        .toc-item .check.included::after { content: ''; width: 5px; height: 9px; border: solid #fff; border-width: 0 2px 2px 0; transform: rotate(45deg); margin-bottom: 2px; }
        .toc-item .check.excluded { background: #ddd; }
        .toc-item .check.excluded::after { content: ''; width: 8px; height: 2px; background: #999; }
        .toc-item .title { flex: 1; font-size: 13px; color: #3d3225; }
        .toc-item .title.excluded { color: #a89880; text-decoration: line-through; }
        .toc-item .num { font-size: 11px; color: #a89068; }
        .toc-item .hint-badge { font-size: 9px; background: #f0d78c; color: #6b5a30; padding: 2px 6px; border-radius: 8px; margin-left: 6px; }
        
        /* Ï†ïÏùò ÌéòÏù¥ÏßÄ */
        .def-page { padding: 40px 25px; background: linear-gradient(180deg, #f9f6ef 0%, #fffef9 100%); }
        .def-page .page-title { text-align: center; font-size: 20px; color: var(--navy); margin-bottom: 30px; }
        .def-item { margin-bottom: 18px; padding: 18px 20px; background: #fffef9; border-radius: 14px; border-left: 4px solid var(--navy); box-shadow: 0 3px 12px rgba(139,115,85,0.06); }
        .def-item .term { font-size: 15px; font-weight: 700; color: var(--navy); margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
        .def-item .term .icon { font-size: 18px; }
        .def-item .desc { font-size: 14px; color: #4a3d30; line-height: 1.9; }
        
        /* ÏÑπÏÖò ÎÇ¥ Ï†ïÏùò Î∞ïÏä§ */
        .section-def { background: linear-gradient(135deg, #fdfbf7 0%, #f9f5ed 100%); border-radius: 12px; padding: 15px 12px; margin-bottom: 20px; border: 1px solid rgba(212,175,130,0.3); }
        .section-def-title { font-size: 14px; font-weight: 700; color: var(--gold-dark); margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .section-def-title .icon { font-size: 16px; }
        .section-def-content { font-size: 13px; color: #5a4d40; line-height: 1.9; }
        .section-def-content strong { color: var(--navy); font-weight: 600; }
        .section-def-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px 15px; margin-top: 10px; }
        .section-def-grid.col-3 { grid-template-columns: repeat(3, 1fr); }
        .section-def-grid.col-5 { display: flex; flex-wrap: wrap; justify-content: center; gap: 4px 6px; }
        .section-def-item { font-size: 11px; color: #5a4d40; padding: 5px 6px; background: rgba(255,255,255,0.7); border-radius: 8px; }
        .section-def-item strong { color: var(--navy); display: block; font-size: 12px; margin-bottom: 2px; }
        
        .footer { background: linear-gradient(175deg, #1a1612 0%, #2d2418 100%); color: #a89068; text-align: center; padding: 40px 20px; }
        .footer .brand { font-size: 16px; font-weight: 600; letter-spacing: 8px; margin-bottom: 15px; color: #d4af82; }
        .footer .divider-line { width: 40px; height: 1px; background: #a89068; margin: 0 auto 15px; }
        .footer .trust-text { font-size: 12px; line-height: 1.8; opacity: 0.8; }
        
        /* ===== V3 Ï∂îÍ∞Ä: Ïó≠Ìïô ÌÜµÌï© Ïπ¥Îìú Ïä§ÌÉÄÏùº ===== */
        .yeokak-card { margin: 0 20px 25px; background: linear-gradient(135deg, #fffbf0 0%, #f9f3e8 100%); border: 2px solid var(--gold); border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(212,175,130,0.15); position: relative; }
        .yeokak-card::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 5px; background: linear-gradient(180deg, var(--gold) 0%, var(--gold-dark) 100%); }
        .yeokak-card .card-header { background: linear-gradient(135deg, #3d3225 0%, #5a4a38 100%); padding: 18px 20px 18px 24px; display: flex; align-items: center; gap: 12px; position: relative; }
        .yeokak-card .card-header .emoji { font-size: 24px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2)); }
        .yeokak-card .card-header h3 { font-size: 17px; font-weight: 700; color: var(--gold); flex: 1; }
        .yeokak-card .card-header .yeokak-tag { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); font-size: 10px; background: rgba(212,175,130,0.3); color: var(--gold-light); padding: 4px 10px; border-radius: 12px; border: 1px solid rgba(212,175,130,0.4); }
        .yeokak-card .card-body { padding: 25px 20px 25px 24px; }
        .yeokak-card .card-body p { font-size: 15px; line-height: 2.2; color: #4a3d30; margin-bottom: 15px; word-break: keep-all; }
        
        /* ÎßàÏßÄÎßâ ÌéòÏù¥ÏßÄ Í≥†Ï†ï Î¨∏Íµ¨ - Î∞ùÏùÄ ÌÜ§ÏúºÎ°ú Ï∞®Î≥ÑÌôî */
        .closing-section { background: linear-gradient(180deg, #fdfbf7 0%, #f5f0e6 100%); border-radius: 16px; padding: 35px 25px; margin: 30px 0; border: 2px solid var(--gold); box-shadow: 0 4px 15px rgba(139,115,85,0.1); }
        .closing-section h4 { color: var(--gold-dark); font-size: 16px; margin-bottom: 20px; text-align: center; letter-spacing: 1px; font-weight: 700; }
        .closing-section p { font-size: 14px; line-height: 2; color: #5a4a3a; text-align: center; margin: 10px 0; }
        .closing-section strong { color: var(--gold-dark); }
        .closing-section .divider { width: 50px; height: 2px; background: linear-gradient(90deg, transparent, var(--gold), transparent); margin: 20px auto; }
        .closing-section .channel-box { text-align: center; margin-top: 20px; }
        .closing-section .channel-badge { display: inline-block; background: linear-gradient(135deg, var(--gold-dark) 0%, var(--gold) 100%); border-radius: 25px; padding: 12px 24px; color: #fff; font-size: 14px; font-weight: 700; letter-spacing: 1px; box-shadow: 0 3px 10px rgba(139,115,85,0.3); }
        
        /* Ïù∏Ìä∏Î°ú ÌéòÏù¥ÏßÄ */
        .intro-page { background: linear-gradient(180deg, #1a1510 0%, #2a2115 100%); padding: 50px 25px 40px; margin: 0 0 30px; border-radius: 16px; border: 1px solid rgba(212,175,130,0.3); }
        .intro-header { text-align: center; margin-bottom: 40px; padding-bottom: 35px; border-bottom: 1px solid rgba(212,175,130,0.2); }
        .intro-header .icon { font-size: 32px; margin-bottom: 20px; }
        .intro-header h2 { color: var(--gold); font-size: 18px; letter-spacing: 2px; margin-bottom: 20px; }
        .intro-header p { color: #d4c4a8; font-size: 13px; line-height: 2; }
        .intro-body { padding: 25px 0; text-align: center; }
        .intro-body .moon-section { margin-bottom: 30px; }
        .intro-body .moon-title { color: var(--gold); font-size: 15px; margin-bottom: 18px; text-align: center; }
        .intro-body .moon-text { color: #e8dcc8; font-size: 14px; line-height: 2.2; text-align: center; }
        .intro-body .leaf-note { color: #a89068; font-size: 13px; line-height: 2; padding: 20px; background: rgba(212,175,130,0.08); border-radius: 8px; margin-top: 25px; text-align: center; }
        .intro-notice { margin-top: 25px; padding-top: 20px; border-top: 1px solid rgba(212,175,130,0.2); color: #8b7355; font-size: 11px; line-height: 1.8; text-align: center; }
        
        /* ÎÅù Î¨∏Íµ¨ */
        .report-credit { text-align: center; color: #8b7355; font-size: 12px; margin: 20px 0; padding: 15px; border-top: 1px solid rgba(139,115,85,0.2); }
        
        /* ‚òÖ Ïù∏Ïó∞ÏÉÅ CSSÎäî Î≥µÏÇ¨Îêú HTMLÏóê Ìè¨Ìï®ÎêòÏñ¥ ÏûàÏúºÎØÄÎ°ú Ïó¨Í∏∞ÏÑú Ï†ïÏùòÌïòÏßÄ ÏïäÏùå */
        /* Ï∂©Îèå Î∞©ÏßÄÎ•º ÏúÑÌï¥ Í∏∞Ï°¥ CSS ÏÇ≠Ï†úÎê® */
        
        /* ÌîåÎ°úÌåÖ Î™©Ï∞® */
        .toc-toggle { position: fixed; bottom: 80px; right: 20px; z-index: 9998; width: 50px; height: 50px; border-radius: 50%; background: linear-gradient(135deg, #d4af82, #b8956a); border: none; cursor: pointer; display: none; align-items: center; justify-content: center; font-size: 22px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); transition: transform 0.2s; }
        .toc-toggle:hover { transform: scale(1.1); }
        .toc-overlay { position: fixed; bottom: 140px; right: 20px; z-index: 9997; max-height: 50vh; max-width: 280px; overflow-y: auto; background: #fff; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.25); display: none; }
        .toc-overlay.show { display: block; animation: tocSlideUp 0.2s ease-out; }
        @keyframes tocSlideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .toc-header { padding: 15px 20px; background: linear-gradient(135deg, #d4af82, #b8956a); color: #fff; font-weight: 700; font-size: 14px; border-radius: 16px 16px 0 0; }
        .toc-items { padding: 10px 0; }
        .toc-items a { display: block; padding: 12px 20px; color: #4a3d30; text-decoration: none; font-size: 13px; border-bottom: 1px solid #f0ebe0; transition: background 0.2s; }
        .toc-items a:hover { background: #f9f6ef; }
        .toc-items a:last-child { border-bottom: none; }
        .toc-items .toc-num { display: inline-block; width: 24px; height: 24px; background: #f0ebe0; border-radius: 50%; text-align: center; line-height: 24px; font-size: 11px; margin-right: 10px; color: #8b7355; }
        @media (max-width: 600px) { .toc-overlay { right: 10px; left: 10px; max-width: none; bottom: 140px; } .toc-toggle { bottom: 80px; right: 15px; width: 45px; height: 45px; font-size: 20px; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="step-badge">STEP 5</div>
            <h1>üé¥ Í≤∞Í≥º ÏÉùÏÑ±Í∏∞ <span class="version-badge">V3</span></h1>
            <p>Claude Ï∂úÎ†•Î¨ºÏùÑ Í∑∏ÎåÄÎ°ú Î∂ôÏó¨ÎÑ£ÏúºÎ©¥ ÏûêÎèôÏúºÎ°ú HTML Í≤∞Í≥ºÏßÄÍ∞Ä ÏÉùÏÑ±Îê©ÎãàÎã§</p>
        </div>
        
        <div class="main-layout">
            <div class="input-section">
                <h3>ü§ñ Claude Ìï¥ÏÑù Í≤∞Í≥º Î∂ôÏó¨ÎÑ£Í∏∞</h3>
                <p class="hint">ClaudeÍ∞Ä ÏÉùÏÑ±Ìïú Í≤∞Í≥ºÎ¨ºÏùÑ <strong>Í∑∏ÎåÄÎ°ú</strong> Î∂ôÏó¨ÎÑ£ÏúºÏÑ∏Ïöî.<br>META Î∏îÎ°ùÏóêÏÑú Í≥†Í∞ùÏ†ïÎ≥¥, ÏÇ¨Ï£º, Ìå®ÌÇ§ÏßÄÎ•º ÏûêÎèô Ïù∏ÏãùÌï©ÎãàÎã§.</p>
                <button class="btn btn-secondary" onclick="pasteFromClipboard()" style="margin-bottom:10px; width:100%;">üìã ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóêÏÑú Î∂ôÏó¨ÎÑ£Í∏∞</button>
                <textarea class="input-textarea" id="claudeInput" placeholder="Claude Ï∂úÎ†•Î¨ºÏùÑ Ïó¨Í∏∞Ïóê Î∂ôÏó¨ÎÑ£ÏúºÏÑ∏Ïöî...

<!-- META
Ïù¥Î¶Ñ: ÌôçÍ∏∏Îèô
Ìå®ÌÇ§ÏßÄ: Ïä§ÌÉ†Îã§Îìú
...
-->

<!-- ÌéòÏù¥ÏßÄ 1: ÌëúÏßÄ -->
..."></textarea>
                
                <!-- Ïù∏Ïó∞ÏÉÅ HTML ÏûÖÎ†• (ÌîÑÎ¶¨ÎØ∏ÏóÑ) -->
                <details style="margin-top:15px;">
                    <summary style="cursor:pointer; color:#9b59b6; font-size:13px;">üíú Ïù∏Ïó∞ÏÉÅ Ïù¥ÎØ∏ÏßÄ HTML (ÌîÑÎ¶¨ÎØ∏ÏóÑ Ï†ÑÏö©)</summary>
                    <textarea class="input-textarea" id="inyeonHtmlInput" style="height:150px; margin-top:10px; border-color:#9b59b6;" placeholder="Step 4 Ïù∏Ïó∞ÏÉÅÏÉùÏÑ±Í∏∞ÏóêÏÑú Î≥µÏÇ¨Ìïú HTMLÏùÑ Ïó¨Í∏∞Ïóê Î∂ôÏó¨ÎÑ£ÏúºÏÑ∏Ïöî...

ÌîÑÎ¶¨ÎØ∏ÏóÑ Ìå®ÌÇ§ÏßÄÏùò Í≤ΩÏö∞, [Ïù∏Ïó∞ÏÉÅ_Ïù¥ÎØ∏ÏßÄ_ÏÇΩÏûÖ] ÏúÑÏπòÏóê Ïù¥ HTMLÏù¥ ÏÇΩÏûÖÎê©ÎãàÎã§."></textarea>
                </details>
                
                <div class="btn-row">
                    <button class="btn btn-primary" onclick="generateResult()">üé¥ Í≤∞Í≥ºÏßÄ ÏÉùÏÑ±</button>
                    <button class="btn btn-secondary" onclick="clearInput()">üóëÔ∏è Ï¥àÍ∏∞Ìôî</button>
                </div>
                <div class="parse-result" id="parseResult"></div>
            </div>
            
            <div class="preview-panel">
                <div class="preview-header">
                    <h2>üì± ÎØ∏Î¶¨Î≥¥Í∏∞</h2>
                    <button class="btn-download" onclick="downloadHTML()">üì• HTML Îã§Ïö¥Î°úÎìú</button>
                    <button class="btn-download" onclick="uploadToNetlify()" style="background:linear-gradient(135deg,#00ad9f,#008f82);">üîó ÎßÅÌÅ¨ ÏÉùÏÑ±</button>
                    <div id="upload-status" style="margin-left:10px;color:#00ad9f;font-size:13px;"></div>
                </div>
                <div class="preview-content" id="previewContent">
                    <div class="empty-state">
                        <div class="icon">üé¥</div>
                        <p>Claude Ï∂úÎ†•Î¨ºÏùÑ Î∂ôÏó¨ÎÑ£ÏúºÎ©¥<br>Í≤∞Í≥ºÏßÄÍ∞Ä ÏÉùÏÑ±Îê©ÎãàÎã§</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    
    <!-- SVG Îç∞Ïù¥ÌÑ∞ Ïô∏Î∂Ä ÌååÏùº (2025-12-18 Î∂ÑÎ¶¨) -->
    <script src="svg_data.js"></script>
    
    <script>

        // ÏßÄÏßÄ ÌïúÍ∏Ä/ÌïúÏûê ‚Üí ÏòÅÎ¨∏ ÏΩîÎìú Îß§Ìïë
        const JIJI_MAP = {
            'Â≠ê': 'ja', 'Ïûê': 'ja',
            '‰∏ë': 'chuk', 'Ï∂ï': 'chuk',
            'ÂØÖ': 'in', 'Ïù∏': 'in',
            'ÂçØ': 'myo', 'Î¨ò': 'myo',
            'Ëæ∞': 'jin', 'ÏßÑ': 'jin',
            'Â∑≥': 'sa', 'ÏÇ¨': 'sa',
            'Âçà': 'oh', 'Ïò§': 'oh',
            'Êú™': 'mi', 'ÎØ∏': 'mi',
            'Áî≥': 'shin', 'Ïã†': 'shin',
            'ÈÖâ': 'yu', 'Ïú†': 'yu',
            'Êàå': 'sul', 'Ïà†': 'sul',
            '‰∫•': 'hae', 'Ìï¥': 'hae'
        };
        
        // ÏßÄÏßÄÎ≥Ñ ÌïúÍ∏Ä Ïù¥Î¶Ñ (Ï∫°ÏÖòÏö©)
        const JIJI_NAMES = {
            'ja': 'Ïûê(Â≠ê)', 'chuk': 'Ï∂ï(‰∏ë)', 'in': 'Ïù∏(ÂØÖ)', 'myo': 'Î¨ò(ÂçØ)',
            'jin': 'ÏßÑ(Ëæ∞)', 'sa': 'ÏÇ¨(Â∑≥)', 'oh': 'Ïò§(Âçà)', 'mi': 'ÎØ∏(Êú™)',
            'shin': 'Ïã†(Áî≥)', 'yu': 'Ïú†(ÈÖâ)', 'sul': 'Ïà†(Êàå)', 'hae': 'Ìï¥(‰∫•)'
        };

        /**
         * Ïù∏Ïó∞ÏÉÅ SVG Base64 Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
         * @param {string} jiji - ÏßÄÏßÄ (ÌïúÍ∏Ä ÎòêÎäî ÌïúÏûê)
         * @param {string} gender - ÏÑ±Î≥Ñ ('ÎÇ®', 'Ïó¨', 'ÎÇ®ÏÑ±', 'Ïó¨ÏÑ±', 'male', 'female', 'm', 'f')
         * @returns {string|null} Base64 SVG Îç∞Ïù¥ÌÑ∞ ÎòêÎäî null
         */
        function getYeonsangSvg(jiji, gender) {
            // ÏßÄÏßÄ ÏΩîÎìú Î≥ÄÌôò
            const jijiCode = JIJI_MAP[jiji];
            if (!jijiCode) {
                console.warn('[Ïù∏Ïó∞ÏÉÅ] Ïïå Ïàò ÏóÜÎäî ÏßÄÏßÄ:', jiji);
                return null;
            }
            
            // ÏÑ±Î≥Ñ ÏΩîÎìú Î≥ÄÌôò
            let genderCode;
            const g = gender.toLowerCase().trim();
            if (['Ïó¨', 'Ïó¨ÏÑ±', 'female', 'f'].includes(g)) {
                genderCode = 'f';
            } else if (['ÎÇ®', 'ÎÇ®ÏÑ±', 'male', 'm'].includes(g)) {
                genderCode = 'm';
            } else {
                console.warn('[Ïù∏Ïó∞ÏÉÅ] Ïïå Ïàò ÏóÜÎäî ÏÑ±Î≥Ñ:', gender);
                return null;
            }
            
            // SVG ÌÇ§ ÏÉùÏÑ± Î∞è Îç∞Ïù¥ÌÑ∞ Î∞òÌôò
            const key = `${jijiCode}_${genderCode}`;
            const svg = SVG_DATA[key];
            
            if (!svg) {
                console.warn('[Ïù∏Ïó∞ÏÉÅ] SVG Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå:', key);
                return null;
            }
            
            console.log('[Ïù∏Ïó∞ÏÉÅ] SVG Î°úÎìú ÏÑ±Í≥µ:', key);
            return svg;
        }

        /**
         * Ïù∏Ïó∞ÏÉÅ Ïù¥ÎØ∏ÏßÄ HTML ÏÉùÏÑ±
         * @param {string} jiji - ÏßÄÏßÄ
         * @param {string} gender - ÏÑ±Î≥Ñ
         * @returns {string} Ïù∏Ïó∞ÏÉÅ Ïù¥ÎØ∏ÏßÄ HTML
         */
        function renderYeonsangImage(jiji, gender) {
            const svg = getYeonsangSvg(jiji, gender);
            const jijiCode = JIJI_MAP[jiji];
            const jijiName = jijiCode ? JIJI_NAMES[jijiCode] : jiji;
            const genderName = ['Ïó¨', 'Ïó¨ÏÑ±', 'female', 'f'].includes(gender.toLowerCase()) ? 'Ïó¨ÏÑ±' : 'ÎÇ®ÏÑ±';
            
            if (svg) {
                return `<div class="inyeon-image-container" style="text-align:center;margin:30px 0;">
                    <img src="${svg}" alt="${jijiName} ${genderName} Ïù∏Ïó∞ÏÉÅ" style="max-width:280px;width:100%;height:auto;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.1);">
                    <p style="margin-top:10px;font-size:14px;color:#6b5744;font-weight:500;">${jijiName} ${genderName}Ïùò Ïù∏Ïó∞ÏÉÅ</p>
                </div>`;
            } else {
                return `<div class="inyeon-image-container" style="text-align:center;margin:30px 0;">
                    <div style="padding:50px;background:linear-gradient(135deg,#f9f6ef,#f0ebe0);border-radius:16px;color:#8b7355;">
                        <p style="font-size:48px;margin-bottom:15px;">üé®</p>
                        <p style="font-size:16px;font-weight:600;">${jijiName} ${genderName}Ïùò Ïù∏Ïó∞ÏÉÅ</p>
                        <p style="font-size:12px;color:#aaa;margin-top:8px;">Ïù¥ÎØ∏ÏßÄÎ•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§</p>
                    </div>
                </div>`;
            }
        }

        let metaData = {};
        let pageData = [];
        
        function generateResult() {
            // ‚òÖ ÏûÖÎ†• Î∞õÏûêÎßàÏûê Ïù¥Ïä§ÏºÄÏù¥ÌîÑ Îî∞Ïò¥Ìëú Ï†úÍ±∞ (\" ‚Üí ")
            const text = document.getElementById('claudeInput').value.replace(/\\"/g, '"');
            const result = document.getElementById('parseResult');
            
            if (!text.trim()) {
                result.innerHTML = '<div style="color:#ef4444;">‚ö†Ô∏è Claude Ï∂úÎ†•Î¨ºÏùÑ Î∂ôÏó¨ÎÑ£Ïñ¥Ï£ºÏÑ∏Ïöî</div>';
                result.className = 'parse-result show error';
                return;
            }
            
            // META ÌååÏã±
            const metaMatch = text.match(/<!--\s*META\s*([\s\S]*?)-->/i);
            if (metaMatch) {
                const mc = metaMatch[1];
                metaData = {
                    orderCode: mc.match(/Ï£ºÎ¨∏ÏΩîÎìú:\s*(.+)/)?.[1]?.trim(),
                    name: mc.match(/(?:Ïù¥Î¶Ñ|ÏÑ±Ìï®|Í≥†Í∞ùÎ™Ö|ÏùòÎ¢∞Ïù∏):\s*([^\s]+)/)?.[1]?.trim(),
                    package: mc.match(/Ìå®ÌÇ§ÏßÄ:\s*(.+)/)?.[1]?.trim(),
                    birthDate: mc.match(/ÏÉùÎÖÑÏõîÏùº:\s*(.+)/)?.[1]?.trim(),
                    gender: mc.match(/ÏÑ±Î≥Ñ:\s*(ÎÇ®|Ïó¨)/)?.[1],
                    saju: mc.match(/ÏÇ¨Ï£º:\s*(.+)/)?.[1]?.trim(),
                    ilgan: mc.match(/ÏùºÍ∞Ñ:\s*(.+)/)?.[1]?.trim(),
                    oheng: mc.match(/Ïò§Ìñâ:\s*(.+)/)?.[1]?.trim(),
                    sipsungRaw: mc.match(/Ïã≠ÏÑ±:\s*(.+)/)?.[1]?.trim(),
                    // Í≤©Íµ≠/Ïö©Ïã† ÌååÏã±
                    gyeokguk: mc.match(/Í≤©Íµ≠:\s*(.+)/)?.[1]?.trim(),
                    strength: mc.match(/ÏùºÍ∞ÑÍ∞ïÏïΩ:\s*(.+)/)?.[1]?.trim(),
                    yongsin: mc.match(/Ïö©Ïã†:\s*(.+)/)?.[1]?.trim(),
                    huisin: mc.match(/Ìù¨Ïã†:\s*(.+)/)?.[1]?.trim(),
                    gisin: mc.match(/Í∏∞Ïã†:\s*(.+)/)?.[1]?.trim(),
                    gusin: mc.match(/Íµ¨Ïã†:\s*(.+)/)?.[1]?.trim(),
                    gilsin: mc.match(/Í∏∏Ïã†:\s*(.+)/)?.[1]?.trim(),
                    yangmyeon: mc.match(/ÏñëÎ©¥Ïã†:\s*(.+)/)?.[1]?.trim(),
                };
                
                ['Ïó∞Ï£º','ÏõîÏ£º','ÏùºÏ£º','ÏãúÏ£º'].forEach(p => {
                    const m = mc.match(new RegExp(p + ':\\s*([^\\(]+)\\s*\\(([^)]+)\\)'));
                    if (m) metaData[p] = { chars: m[1].trim(), sipsung: m[2].trim() };
                });
                
                // Ïò§Ìñâ ÌååÏã±: ÌïúÏûê OR ÌïúÍ∏Ä Î™®Îëê ÏßÄÏõê
                let om = metaData.oheng?.match(/Êú®([\d.]+)\s*ÁÅ´([\d.]+)\s*Âúü([\d.]+)\s*Èáë([\d.]+)\s*Ê∞¥([\d.]+)/);
                if (!om) om = metaData.oheng?.match(/Î™©([\d.]+)\s*Ìôî([\d.]+)\s*ÌÜ†([\d.]+)\s*Í∏à([\d.]+)\s*Ïàò([\d.]+)/);
                if (om) metaData.ohengValues = { wood: +om[1], fire: +om[2], earth: +om[3], metal: +om[4], water: +om[5] };
                
                // Ïã≠ÏÑ± Î∂ÑÌè¨ ÌååÏã± (Ï†ÑÏ≤¥ ÌÖçÏä§Ìä∏ÏóêÏÑú ÏßÅÏ†ë Ï∂îÏ∂ú)
                const bigyeopMatch = mc.match(/ÎπÑÍ≤Å[:\s]*([\d.]+)/);
                const siksangMatch = mc.match(/ÏãùÏÉÅ[:\s]*([\d.]+)/);
                const jaeseongMatch = mc.match(/Ïû¨ÏÑ±[:\s]*([\d.]+)/);
                const gwanseongMatch = mc.match(/Í¥ÄÏÑ±[:\s]*([\d.]+)/);
                const inseongMatch = mc.match(/Ïù∏ÏÑ±[:\s]*([\d.]+)/);
                if (bigyeopMatch || siksangMatch || jaeseongMatch || gwanseongMatch || inseongMatch) {
                    metaData.sipsungValues = {
                        bigyeop: bigyeopMatch ? +bigyeopMatch[1] : 0,
                        siksang: siksangMatch ? +siksangMatch[1] : 0,
                        jaeseong: jaeseongMatch ? +jaeseongMatch[1] : 0,
                        gwanseong: gwanseongMatch ? +gwanseongMatch[1] : 0,
                        inseong: inseongMatch ? +inseongMatch[1] : 0
                    };
                }
                
                // Ïù¥Î¶Ñ ÏóÜÏúºÎ©¥ Î≥∏Î¨∏ÏóêÏÑú "OOOÎãò" Ìå®ÌÑ¥ Ï∞æÍ∏∞
                if (!metaData.name) {
                    const nameMatch = text.match(/([Í∞Ä-Ìû£]{2,4})ÎãòÏùò?\s*(?:ÏÇ¨Ï£º|Ïö¥ÏÑ∏|Î™ÖÏãù|Ïò§Ìñâ)/);
                    if (nameMatch) metaData.name = nameMatch[1];
                }
                
                // ‚òÖ Ïù¥Î¶ÑÎ≥Ñ Ïù∏Ïó∞ÏÉÅ ÏûêÎèô Î°úÎìú (Ïù∏Ïó∞ÏÉÅ ÏûÖÎ†•ÎûÄÏù¥ ÎπÑÏñ¥ÏûàÏùÑ ÎïåÎßå)
                const inyeonInput = document.getElementById('inyeonHtmlInput');
                console.log('[Ïù∏Ïó∞ÏÉÅ Î°úÎìú] Ïù¥Î¶Ñ:', metaData.name, 'ÏûÖÎ†•ÎûÄ:', !!inyeonInput, 'ÎπÑÏñ¥ÏûàÏùå:', inyeonInput ? !inyeonInput.value.trim() : 'N/A');
                
                if (metaData.name && inyeonInput && !inyeonInput.value.trim()) {
                    const storageKey = 'inyeon_' + metaData.name;
                    const savedInyeon = localStorage.getItem(storageKey);
                    console.log('[Ïù∏Ïó∞ÏÉÅ Î°úÎìú] localStorage ÌÇ§:', storageKey, 'Ï†ÄÏû•Îê®:', savedInyeon ? '‚úÖ (' + savedInyeon.length + 'Ïûê)' : '‚ùå ÏóÜÏùå');
                    
                    if (savedInyeon) {
                        document.getElementById('inyeonHtmlInput').value = savedInyeon;
                        const details = document.getElementById('inyeonHtmlInput').closest('details');
                        if (details) {
                            details.open = true;
                            details.querySelector('summary').innerHTML = 'üíú Ïù∏Ïó∞ÏÉÅ Ïù¥ÎØ∏ÏßÄ HTML (‚úÖ ' + metaData.name + ' ÏûêÎèô Î°úÎìúÎê®)';
                        }
                        console.log('‚úÖ Ïù∏Ïó∞ÏÉÅ ÏûêÎèô Î°úÎìú ÏôÑÎ£å:', storageKey);
                    }
                }
            }
            
            // ‚òÖ‚òÖ‚òÖ Ïù∏Ïó∞ÏÉÅ HTML ÏûêÎèô Ï∂îÏ∂ú (META Î∏îÎ°ù Ïú†Î¨¥ÏôÄ ÏÉÅÍ¥ÄÏóÜÏù¥ Ìï≠ÏÉÅ Ïã§Ìñâ) ‚òÖ‚òÖ‚òÖ
            // 1. style ÌÉúÍ∑∏ Ï∞æÍ∏∞ (.card ÌÅ¥ÎûòÏä§ Ìè¨Ìï®)
            const styleMatch = text.match(/<style>[\s\S]*?\.card[\s\S]*?<\/style>/i);
            console.log('[Ïù∏Ïó∞ÏÉÅ Ï∂îÏ∂ú] style ÌÉúÍ∑∏:', styleMatch ? '‚úÖ Î∞úÍ≤¨ (' + styleMatch[0].length + 'Ïûê)' : '‚ùå ÏóÜÏùå');
            
            // 2. result-box Ï†ÑÏ≤¥ Ï∞æÍ∏∞ (data-inyun-jsonÏúºÎ°ú ÎÅùÎÇòÎäî Í≤ÉÍπåÏßÄ)
            const resultBoxMatch = text.match(/<div class="result-box"[\s\S]*?data-inyun-json="[^"]*"><\/div>\s*<\/div>/i);
            console.log('[Ïù∏Ïó∞ÏÉÅ Ï∂îÏ∂ú] result-box:', resultBoxMatch ? '‚úÖ Î∞úÍ≤¨ (' + resultBoxMatch[0].length + 'Ïûê)' : '‚ùå ÏóÜÏùå');
            
            // Ïù∏Ïó∞ÏÉÅ HTMLÏù¥ ÌÖçÏä§Ìä∏Ïóê ÏûàÏúºÎ©¥ Ï∂îÏ∂úÌï¥ÏÑú ÏûÖÎ†•ÎûÄÏóê ÎÑ£Í∏∞
            if (styleMatch && resultBoxMatch) {
                const extractedInyeon = styleMatch[0] + '\n' + resultBoxMatch[0];
                const inyeonInput = document.getElementById('inyeonHtmlInput');
                if (inyeonInput && !inyeonInput.value.trim()) {  // Ïù¥ÎØ∏ Í∞íÏù¥ ÏûàÏúºÎ©¥ ÎçÆÏñ¥Ïì∞ÏßÄ ÏïäÏùå
                    inyeonInput.value = extractedInyeon;
                    const details = inyeonInput.closest('details');
                    if (details) {
                        details.open = true;
                        details.querySelector('summary').innerHTML = 'üíú Ïù∏Ïó∞ÏÉÅ Ïù¥ÎØ∏ÏßÄ HTML (‚úÖ ÏûêÎèô Ï∂îÏ∂úÎê®)';
                    }
                    console.log('‚úÖ Ïù∏Ïó∞ÏÉÅ HTML ÏûêÎèô Ï∂îÏ∂ú ÏôÑÎ£å, Í∏∏Ïù¥:', extractedInyeon.length);
                }
            }
            
            // ÌéòÏù¥ÏßÄ ÌååÏã±
            const pagePattern = /<!--\s*ÌéòÏù¥ÏßÄ\s*(\d+)[:\s]*([^>]*?)-->/gi;
            const matches = [...text.matchAll(pagePattern)];
            
            pageData = [];
            if (matches.length > 0) {
                // META ÎÅùÍ≥º Ï≤´ ÌéòÏù¥ÏßÄ ÏÇ¨Ïù¥ ÎÇ¥Ïö© Ï∂îÏ∂ú (ÌïµÏã¨ ÏöîÏïΩ Îì±)
                // Îã§ÏñëÌïú META Ï¢ÖÎ£å ÌòïÏãù ÏßÄÏõê
                const metaEndMatch = text.match(/<!--\s*\/?\s*META\s*(ÎÅù)?\s*-->/i);
                console.log('[DEBUG] META ÎÅù Îß§Ïπ≠:', metaEndMatch ? metaEndMatch[0] : 'ÏóÜÏùå');
                
                if (metaEndMatch) {
                    const metaEndIdx = metaEndMatch.index + metaEndMatch[0].length;
                    const firstPageIdx = matches[0].index;
                    const preContent = text.substring(metaEndIdx, firstPageIdx).trim();
                    
                    console.log('[DEBUG] preContent Í∏∏Ïù¥:', preContent.length);
                    console.log('[DEBUG] preContent ÎØ∏Î¶¨Î≥¥Í∏∞:', preContent.substring(0, 100));
                    
                    if (preContent && preContent.length > 10) {
                        metaData.preContent = preContent;
                    }
                }
                
                for (let i = 0; i < matches.length; i++) {
                    const startIdx = matches[i].index + matches[i][0].length;
                    const endIdx = matches[i + 1] ? matches[i + 1].index : text.length;
                    // Ï†úÎ™©ÏóêÏÑú ÏïûÏùò -Ïà´Ïûê: Ìå®ÌÑ¥ Ï†úÍ±∞
                    let title = matches[i][2].trim().replace(/^[-\d]+:\s*/, '');
                    pageData.push({ num: matches[i][1], title: title, content: text.substring(startIdx, endIdx).trim() });
                }
            }
            
            if (metaData.name || pageData.length > 0) {
                result.className = 'parse-result show success';
                result.innerHTML = `
                    <div style="color:#4ade80;margin-bottom:12px;">‚úÖ ÌååÏã± ÏôÑÎ£å!</div>
                    <div class="parsed-grid">
                        <div class="parsed-item"><span class="label">Ïù¥Î¶Ñ</span><span class="value">${metaData.name || '-'}</span></div>
                        <div class="parsed-item"><span class="label">Ìå®ÌÇ§ÏßÄ</span><span class="value">${metaData.package || '-'}</span></div>
                        <div class="parsed-item"><span class="label">ÏùºÍ∞Ñ</span><span class="value">${metaData.ilgan || '-'}</span></div>
                        <div class="parsed-item"><span class="label">ÏÇ¨Ï£º</span><span class="value">${metaData.saju || '-'}</span></div>
                    </div>
                    <div class="page-list">
                        <div class="page-list-title">üìÑ ${pageData.length}Í∞ú ÌéòÏù¥ÏßÄ Ïù∏Ïãù</div>
                        ${pageData.map(p => `<div class="page-item"><span class="num">${p.num}</span><span>${p.title || '(Ï†úÎ™© ÏóÜÏùå)'}</span></div>`).join('')}
                    </div>
                `;
                renderResult();
            } else {
                result.className = 'parse-result show error';
                result.innerHTML = '<div style="color:#ef4444;">‚ö†Ô∏è META Î∏îÎ°ùÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.</div>';
            }
        }
        
        function renderResult() {
            const preview = document.getElementById('previewContent');
            const ilgan = metaData.ilgan?.charAt(0) || 'Áî≤';
            
            const ilganInfo = {
                'Áî≤': { name: 'Í∞ëÎ™© (Áî≤Êú®)', desc: 'ÌïòÎäòÏùÑ Ìñ•Ìï¥ Í≥ßÍ≤å ÎªóÏñ¥Í∞ÄÎäî ÌÅ∞ ÎÇòÎ¨¥<br>Î¶¨ÎçîÏã≠, Ï†ïÏßÅÌï®, ÏÑ±Ïû•Ïóê ÎåÄÌïú Ïó¥Îßù', color: 'linear-gradient(145deg, #2d5016 0%, #3d6820 50%, #2d5016 100%)' },
                '‰πô': { name: 'ÏùÑÎ™© (‰πôÊú®)', desc: 'Î∞îÎûåÏóê Ïú†Ïó∞ÌïòÍ≤å ÌùîÎì§Î¶¨Îäî ÌíÄÍ≥º ÍΩÉ<br>Ï†ÅÏùëÎ†•, Ïú†Ïó∞Ìï®, ÏÑ¨ÏÑ∏Ìïú Í∞êÏàòÏÑ±', color: 'linear-gradient(145deg, #3d6820 0%, #5a8f35 50%, #3d6820 100%)' },
                '‰∏ô': { name: 'Î≥ëÌôî (‰∏ôÁÅ´)', desc: 'ÎßåÎ¨ºÏùÑ ÎπÑÏ∂îÎäî ÌÉúÏñëÏùò Îπõ<br>Ïó¥Ï†ï, ÌôúÎ†•, Îî∞ÎúªÌïú Î¶¨ÎçîÏã≠', color: 'linear-gradient(145deg, #c41e3a 0%, #e63946 50%, #c41e3a 100%)' },
                '‰∏Å': { name: 'Ï†ïÌôî (‰∏ÅÁÅ´)', desc: 'Ïñ¥Îë†ÏùÑ Î∞ùÌûàÎäî Ï¥õÎ∂àÍ≥º Îã¨Îπõ<br>ÏÑ¨ÏÑ∏Ìï®, ÌÜµÏ∞∞Î†•, ÏùÄÏùÄÌïú Îß§Î†•', color: 'linear-gradient(145deg, #8b2942 0%, #a83858 50%, #8b2942 100%)' },
                'Êàä': { name: 'Î¨¥ÌÜ† (ÊàäÂúü)', desc: 'Î™®Îì† Í≤ÉÏùÑ ÌíàÎäî ÏÇ∞Í≥º ÎåÄÏßÄ<br>Ïã†Î¢∞, Ìè¨Ïö©Î†•, Î¨µÏßÅÌïú Ï°¥Ïû¨Í∞ê', color: 'linear-gradient(145deg, #8b6914 0%, #a07d18 50%, #8b6914 100%)' },
                'Â∑±': { name: 'Í∏∞ÌÜ† (Â∑±Âúü)', desc: 'ÏÉùÎ™ÖÏùÑ ÌÇ§Ïö∞Îäî ÎπÑÏò•Ìïú ÎïÖ<br>Ïã§Ïö©ÏÑ±, Î∞∞Î†§Ïã¨, Îî∞ÎúªÌïú Î≥¥ÏÇ¥Ìïå', color: 'linear-gradient(145deg, #6b5344 0%, #8b7355 50%, #6b5344 100%)' },
                'Â∫ö': { name: 'Í≤ΩÍ∏à (Â∫öÈáë)', desc: 'ÏÑ∏ÏÉÅÏùÑ Î∞îÍæ∏Îäî Í∞ïÏ≤†Í≥º ÏπºÎÇ†<br>Í≤∞Îã®Î†•, Ï†ïÏùòÍ∞ê, Í∞ïÏù∏Ìïú ÏùòÏßÄ', color: 'linear-gradient(145deg, #4a5568 0%, #718096 50%, #4a5568 100%)' },
                'Ëæõ': { name: 'Ïã†Í∏à (ËæõÈáë)', desc: 'Ïñ¥Îë† ÏÜçÏóêÏÑú ÎπõÎÇòÎäî Î≥¥ÏÑù<br>ÏòàÎ¶¨Ìï®, ÏôÑÎ≤ΩÏ£ºÏùò, Í≥†Í∑ÄÌïú ÌíàÍ≤©', color: 'linear-gradient(145deg, #5a6672 0%, #7a8a96 50%, #5a6672 100%)' },
                'Â£¨': { name: 'ÏûÑÏàò (Â£¨Ê∞¥)', desc: 'Î™®Îì† Í≤ÉÏùÑ ÏÇºÌÇ§Îäî ÌÅ∞ Î∞îÎã§<br>ÏßÄÌòú, Ìè¨Ïö©Î†•, Î¨¥ÌïúÌïú Í∞ÄÎä•ÏÑ±', color: 'linear-gradient(145deg, #1a4d6e 0%, #2980b9 50%, #1a4d6e 100%)' },
                'Áô∏': { name: 'Í≥ÑÏàò (Áô∏Ê∞¥)', desc: 'ÏÉùÎ™ÖÏùÑ Ï†ÅÏãúÎäî Ïù¥Ïä¨Í≥º ÎπóÎ¨º<br>ÏßÅÍ¥ÄÎ†•, Í∞êÏàòÏÑ±, Ï°∞Ïö©Ìïú ÏòÅÌñ•Î†•', color: 'linear-gradient(145deg, #1e3a5f 0%, #2c5aa0 50%, #1e3a5f 100%)' }
            };
            
            const info = ilganInfo[ilgan] || ilganInfo['Áî≤'];
            const pkgLabels = { 'ÎùºÏù¥Ìä∏': '‚ú¶ LIGHT ‚ú¶', 'Ïä§ÌÉ†Îã§Îìú': '‚ú¶ STANDARD ‚ú¶', 'ÌîÑÎ¶¨ÎØ∏ÏóÑ': '‚ú¶ PREMIUM ‚ú¶' };
            const ohengValues = metaData.ohengValues || { wood: 0, fire: 0, earth: 0, metal: 0, water: 0 };
            const maxOheng = Math.max(...Object.values(ohengValues), 1);
            
            // Ïã≠ÏÑ± Î∂ÑÌè¨
            const sipsungValues = metaData.sipsungValues || { bigyeop: 0, siksang: 0, jaeseong: 0, gwanseong: 0, inseong: 0 };
            const maxSipsung = Math.max(...Object.values(sipsungValues), 1);
            
            const sipsung = {
                'Áî≤': { wood: 'ÎπÑÍ≤Å', fire: 'ÏãùÏÉÅ', earth: 'Ïû¨ÏÑ±', metal: 'Í¥ÄÏÑ±', water: 'Ïù∏ÏÑ±' },
                '‰πô': { wood: 'ÎπÑÍ≤Å', fire: 'ÏãùÏÉÅ', earth: 'Ïû¨ÏÑ±', metal: 'Í¥ÄÏÑ±', water: 'Ïù∏ÏÑ±' },
                '‰∏ô': { wood: 'Ïù∏ÏÑ±', fire: 'ÎπÑÍ≤Å', earth: 'ÏãùÏÉÅ', metal: 'Ïû¨ÏÑ±', water: 'Í¥ÄÏÑ±' },
                '‰∏Å': { wood: 'Ïù∏ÏÑ±', fire: 'ÎπÑÍ≤Å', earth: 'ÏãùÏÉÅ', metal: 'Ïû¨ÏÑ±', water: 'Í¥ÄÏÑ±' },
                'Êàä': { wood: 'Í¥ÄÏÑ±', fire: 'Ïù∏ÏÑ±', earth: 'ÎπÑÍ≤Å', metal: 'ÏãùÏÉÅ', water: 'Ïû¨ÏÑ±' },
                'Â∑±': { wood: 'Í¥ÄÏÑ±', fire: 'Ïù∏ÏÑ±', earth: 'ÎπÑÍ≤Å', metal: 'ÏãùÏÉÅ', water: 'Ïû¨ÏÑ±' },
                'Â∫ö': { wood: 'Ïû¨ÏÑ±', fire: 'Í¥ÄÏÑ±', earth: 'Ïù∏ÏÑ±', metal: 'ÎπÑÍ≤Å', water: 'ÏãùÏÉÅ' },
                'Ëæõ': { wood: 'Ïû¨ÏÑ±', fire: 'Í¥ÄÏÑ±', earth: 'Ïù∏ÏÑ±', metal: 'ÎπÑÍ≤Å', water: 'ÏãùÏÉÅ' },
                'Â£¨': { wood: 'ÏãùÏÉÅ', fire: 'Ïû¨ÏÑ±', earth: 'Í¥ÄÏÑ±', metal: 'Ïù∏ÏÑ±', water: 'ÎπÑÍ≤Å' },
                'Áô∏': { wood: 'ÏãùÏÉÅ', fire: 'Ïû¨ÏÑ±', earth: 'Í¥ÄÏÑ±', metal: 'Ïù∏ÏÑ±', water: 'ÎπÑÍ≤Å' }
            }[ilgan] || { wood: 'ÎπÑÍ≤Å', fire: 'ÏãùÏÉÅ', earth: 'Ïû¨ÏÑ±', metal: 'Í¥ÄÏÑ±', water: 'Ïù∏ÏÑ±' };
            
            const getClass = c => ({ 'Áî≤':'wood','‰πô':'wood','ÂØÖ':'wood','ÂçØ':'wood','‰∏ô':'fire','‰∏Å':'fire','Â∑≥':'fire','Âçà':'fire','Êàä':'earth','Â∑±':'earth','Ëæ∞':'earth','Êàå':'earth','‰∏ë':'earth','Êú™':'earth','Â∫ö':'metal','Ëæõ':'metal','Áî≥':'metal','ÈÖâ':'metal','Â£¨':'water','Áô∏':'water','‰∫•':'water','Â≠ê':'water' }[c] || '');
            
            // ÏÑπÏÖò Î≤àÌò∏ Îß§Ìïë (2025-12-16 ÏÉà Íµ¨Ï°∞)
            // ÏÑπÏÖò Îß§Ìïë (Ïö∞ÏÑ†ÏàúÏúÑ Í∏∞Î∞ò - Î∞∞Ïó¥ ÏàúÏÑúÎåÄÎ°ú Ï≤¥ÌÅ¨)
            const sectionPriority = [
                // Ïö∞ÏÑ†ÏàúÏúÑ ÎÜíÏùå (Ïó≠Ìïô ÌôïÏû• - Î®ºÏ†Ä Ï≤¥ÌÅ¨Ìï¥Ïïº Ïò¨Ìï¥/Ï¢ÖÌï© Îì±Í≥º Ï∂©Îèå Î∞©ÏßÄ)
                { keywords: ['Ïù¥Î¶Ñ', 'ÏÑ±Î™Ö', 'Ï£ºÏó≠'], section: '16' },
                { keywords: ['ÌÉùÏùº', 'ÌÉÄÏù¥Î∞ç', 'Í¥ÄÏÉÅ', 'Ïô∏Ìòï', 'ÌíçÏàò', 'Í≥µÍ∞Ñ'], section: '17' },
                { keywords: ['Í∏∞Ïö¥ÏÉÅ', 'Ïù∏Ïó∞ÏÉÅ'], section: '18' },
                // ÏùºÎ∞ò ÏÑπÏÖò
                { keywords: ['Î™ÖÏãù'], section: '01' },
                { keywords: ['ÏùºÍ∞Ñ'], section: '02' },
                { keywords: ['Ïò§Ìñâ'], section: '03' },
                { keywords: ['ÏñëÍ∏∞', 'ÏùåÍ∏∞', 'ÏñëÏùå'], section: '04' },
                { keywords: ['ÏÑ±Í≤©', 'Ïã¨Î¶¨'], section: '05' },
                { keywords: ['Ïã†ÏÇ¥'], section: '06' },
                { keywords: ['Ïò¨Ìï¥', '2026', '2025', 'ÎÖÑ Ïö¥ÏÑ∏', 'Ïö¥ÏÑ∏ ÌùêÎ¶Ñ'], section: '07' },
                { keywords: ['ÏõîÎ≥Ñ'], section: '08' },
                { keywords: ['Ïó∞Ïï†', 'Í≤∞Ìòº'], section: '09' },
                { keywords: ['ÏßÅÏóÖ', 'ÏßÑÎ°ú'], section: '10' },
                { keywords: ['Ïû¨Î¨º', 'ÏÇ¨ÏóÖ'], section: '11' },
                { keywords: ['Í±¥Í∞ï'], section: '12' },
                { keywords: ['ÎåÄÏö¥'], section: '13' },
                { keywords: ['Î≤àÏïÑÏõÉ', 'Í∑†Ìòï', 'Ïö©Ïã†Í≥º'], section: '19' },
                { keywords: ['Ïù∏Í∞Ñ', 'Í∑ÄÏù∏', 'ÌîºÌï†'], section: '14' },
                { keywords: ['ÎßûÏ∂§', 'ÏßàÎ¨∏'], section: '15' },
                { keywords: ['Ïö¥Î™Ö', 'ÏÉÅÎåÄ'], section: '18' },
                { keywords: ['Ï¢ÖÌï©', 'Ï°∞Ïñ∏', 'ÎßàÎ¨¥Î¶¨'], section: '20' },
            ];
            const getSectionNum = (title) => {
                for (const item of sectionPriority) {
                    if (item.keywords.some(k => title.includes(k))) {
                        return item.section;
                    }
                }
                return '';
            };
            const getShortTitle = (title) => {
                // ÏïûÏùò Ïà´Ïûê Ï†úÍ±∞
                title = title.replace(/^\d+[-.\s]*/,'').trim();
                // Ï†úÎ™©ÏóêÏÑú ÌïµÏã¨Îßå Ï∂îÏ∂ú (Ïö∞ÏÑ†ÏàúÏúÑ ÏàúÏÑú Ï§ëÏöî!)
                if (title.includes('Ïù¥Î¶Ñ') || title.includes('ÏÑ±Î™Ö') || title.includes('Ï£ºÏó≠')) return 'ÏÑ±Î™ÖÌïô + Ï£ºÏó≠';
                if (title.includes('ÌÉùÏùº') || title.includes('ÌÉÄÏù¥Î∞ç') || title.includes('Í¥ÄÏÉÅ') || title.includes('Ïô∏Ìòï') || title.includes('ÌíçÏàò') || title.includes('Í≥µÍ∞Ñ')) return 'ÌÉùÏùº¬∑Í¥ÄÏÉÅ¬∑ÌíçÏàò';
                if (title.includes('Í∏∞Ïö¥ÏÉÅ') || title.includes('Ïù∏Ïó∞ÏÉÅ')) return 'Ïö¥Î™ÖÏùò ÏÉÅÎåÄ Í∏∞Ïö¥ÏÉÅ';
                if (title.includes('Î™ÖÏãù')) return 'ÏÇ¨Ï£º Î™ÖÏãù Ìï¥ÏÑ§';
                if (title.includes('ÏùºÍ∞Ñ')) return 'ÏùºÍ∞Ñ ÏÑ±Ìñ• Î∂ÑÏÑù';
                if (title.includes('Ïò§Ìñâ')) return 'Ïò§Ìñâ ÏóêÎÑàÏßÄ Î∂ÑÏÑù';
                if (title.includes('ÏñëÍ∏∞') || title.includes('ÏùåÍ∏∞') || (title.includes('Î∞∏Îü∞Ïä§') && (title.includes('Ïñë') || title.includes('Ïùå'))) || title.includes('ÏñëÏùå')) return 'ÏñëÍ∏∞/ÏùåÍ∏∞ Î∞∏Îü∞Ïä§';
                if (title.includes('ÏÑ±Í≤©') || title.includes('Ïã¨Î¶¨')) return 'ÏÑ±Í≤© Î∞è Ïã¨Î¶¨ Ìå®ÌÑ¥';
                if (title.includes('Ïã†ÏÇ¥')) return 'Ïã†ÏÇ¥ Î∂ÑÏÑù';
                if (title.includes('Ïò¨Ìï¥') || title.includes('2026') || title.includes('2025') || title.includes('ÎÖÑ Ïö¥ÏÑ∏') || title.includes('Ïö¥ÏÑ∏ ÌùêÎ¶Ñ')) return 'Ïò¨Ìï¥ Ïö¥ÏÑ∏ ÌùêÎ¶Ñ';
                if (title.includes('ÏõîÎ≥Ñ')) return 'ÏõîÎ≥Ñ Ïö¥ÏÑ∏';
                if (title.includes('Ïó∞Ïï†') || title.includes('Í≤∞Ìòº')) return 'Ïó∞Ïï†Ïö¥';
                if (title.includes('ÏßÅÏóÖ') || title.includes('ÏßÑÎ°ú')) return 'ÏßÅÏóÖÏö¥';
                if (title.includes('Ïû¨Î¨º') || title.includes('ÏÇ¨ÏóÖ')) return 'Ïû¨Î¨ºÏö¥';
                if (title.includes('Í±¥Í∞ï')) return 'Í±¥Í∞ïÏö¥';
                if (title.includes('ÎåÄÏö¥')) return 'ÎåÄÏö¥ ÌùêÎ¶Ñ';
                if (title.includes('Î≤àÏïÑÏõÉ') || title.includes('Í∑†Ìòï') || title.includes('Ïö©Ïã†Í≥º')) return 'Ïö©Ïã†Í≥º Î≤àÏïÑÏõÉ';
                if (title.includes('Ïù∏Í∞Ñ') || title.includes('Í∑ÄÏù∏') || title.includes('ÌîºÌï†')) return 'Ïù∏Í∞Ñ Í¥ÄÍ≥Ñ Ïö¥';
                if (title.includes('ÎßûÏ∂§') || title.includes('ÏßàÎ¨∏')) return 'ÎßûÏ∂§ ÏßàÎ¨∏ Î∂ÑÏÑù';
                if (title.includes('Ïö¥Î™Ö') || title.includes('ÏÉÅÎåÄ')) return 'Ïö¥Î™ÖÏùò ÏÉÅÎåÄ Í∏∞Ïö¥ÏÉÅ';
                if (title.includes('Ï¢ÖÌï©') || title.includes('Ï°∞Ïñ∏') || title.includes('ÎßàÎ¨¥Î¶¨')) return 'Ï¢ÖÌï© Ï°∞Ïñ∏';
                return title.replace(/[^\w\sÍ∞Ä-Ìû£]/g, '').trim();
            };
            
            // V3 Ï∂îÍ∞Ä: Ïó≠Ìïô ÌÜµÌï© ÌéòÏù¥ÏßÄ ÌåêÎ≥Ñ
            const isYeokakPage = (title) => {
                const yeokakKeywords = ['Ïù¥Î¶Ñ', 'ÏÑ±Î™Ö', 'Ï£ºÏó≠', 'Î∞©Ìñ•', 'ÌÉùÏùº', 'ÌÉÄÏù¥Î∞ç', 'Í¥ÄÏÉÅ', 'Ïô∏Ìòï', 'ÌíçÏàò', 'Í≥µÍ∞Ñ'];
                return yeokakKeywords.some(k => title.includes(k));
            };
            
            // V3 Ï∂îÍ∞Ä: Ïó≠Ìïô ÌôïÏû•ÏöîÏÜå ÌÉúÍ∑∏
            const getYeokakTag = (title) => {
                if (title.includes('Ïù¥Î¶Ñ') || title.includes('ÏÑ±Î™Ö')) return '‚ë¢ ÏßÑÎèôÌï¥ÏÑù';
                if (title.includes('Ï£ºÏó≠') || title.includes('Î∞©Ìñ•')) return '‚ë° Ïã¨Î¶¨ + ‚ë£ Ï≤úÎ¨∏';
                if (title.includes('ÌÉùÏùº') || title.includes('ÌÉÄÏù¥Î∞ç')) return '‚ë£ Ï≤úÎ¨∏';
                if (title.includes('Í¥ÄÏÉÅ') || title.includes('Ïô∏Ìòï')) return '‚ë§ Í∞êÍ∞ÅÌôî';
                if (title.includes('ÌíçÏàò') || title.includes('Í≥µÍ∞Ñ')) return '‚ë§ Í∞êÍ∞ÅÌôî';
                return '';
            };
            
            // V3 Ï∂îÍ∞Ä: Ïó≠Ìïô Ïπ¥Îìú Î†åÎçîÎßÅ Ìï®Ïàò
            const renderYeokakCard = (title, content) => {
                const tag = getYeokakTag(title);
                return `<div class="yeokak-card">
                    <div class="card-header">
                        <span class="emoji">${getEmoji(title)}</span>
                        <h3>${title}</h3>
                        ${tag ? `<span class="yeokak-tag">${tag}</span>` : ''}
                    </div>
                    <div class="card-body">${convertHTML(content)}</div>
                </div>`;
            };
            
            // ÏñëÏùå Î∞∏Îü∞Ïä§ Î†åÎçîÎßÅ Ìï®Ïàò
            const renderYangumSection = (content) => {
                // ÌçºÏÑºÌä∏ ÌååÏã±: | **62.5%** | **37.5%** | ÌòïÏãù
                const percentMatch = content.match(/\|\s*\*?\*?(\d+\.?\d*)%?\*?\*?\s*\|\s*\*?\*?(\d+\.?\d*)%?\*?\*?\s*\|/);
                let yangPercent = 50, eumPercent = 50;
                if (percentMatch) {
                    yangPercent = parseFloat(percentMatch[1]);
                    eumPercent = parseFloat(percentMatch[2]);
                }
                
                // Î∞∏Îü∞Ïä§ Ïú†Ìòï ÌååÏã±
                const typeMatch = content.match(/Î∞∏Îü∞Ïä§\s*Ïú†Ìòï[:\s]*([^\n]+)/);
                let balanceType = typeMatch ? typeMatch[1].replace(/\*\*/g, '').replace(/[-‚Äî]/g, '‚Äî').trim() : 'Í∑†ÌòïÌòï';
                
                // ÎÇòÎ®∏ÏßÄ Ìï¥ÏÑù ÎÇ¥Ïö© ÌååÏã± (ÌÖåÏù¥Î∏î, Ïú†Ìòï, Î©îÏù∏ Ï†úÎ™© Ï†úÏô∏)
                let descContent = content
                    .replace(/^##[^#\n][^\n]*$/gm, '')  // ÎåÄÏ†úÎ™©(## ) Ï†úÍ±∞
                    .replace(/^###[^\n]*ÏñëÏùå[^\n]*$/gm, '')  // "ÏñëÏùå ÎπÑÏú®" ÏÜåÏ†úÎ™© Ï†úÍ±∞
                    .replace(/^###[^\n]*ÎãòÏùò[^\n]*ÎπÑÏú®[^\n]*$/gm, '')  // "OOOÎãòÏùò ÏñëÏùå ÎπÑÏú®" Ï†úÍ±∞
                    .replace(/^###[^\n]*Î∞∏Îü∞Ïä§\s*Ïú†Ìòï[^\n]*$/gm, '')  // "### Î∞∏Îü∞Ïä§ Ïú†Ìòï:" Ï†úÍ±∞
                    .replace(/(\|[^\n]+\|\n?)+/g, '')  // ÌÖåÏù¥Î∏î Ï†ÑÏ≤¥ Ï†úÍ±∞
                    .replace(/\*?\*?Î∞∏Îü∞Ïä§\s*Ïú†Ìòï[^\n]*/gi, '')  // Ïú†Ìòï ÎùºÏù∏ Ï†úÍ±∞
                    .replace(/^[-‚Äî]{3,}$/gm, '')  // Íµ¨Î∂ÑÏÑ†(---) Ï†úÍ±∞
                    .replace(/<!--(?!\s*\/?(ÏôúÍ∑∏Îü∞ÏßÄ|ÏÜåÎ¶Ñ|Í≥µÍ∞ê|Ï£ºÏùò|Ï°∞Ïñ∏|Ìù¨Îßù|Í∞ïÏ†ê)\s*-->)[^>]*-->/g, '')  // HTML Ï£ºÏÑù Ï†úÍ±∞ (Î∞ïÏä§ ÌÉúÍ∑∏ Ï†úÏô∏)
                    .replace(/\n{3,}/g, '\n\n')  // Ïó∞ÏÜç ÎπàÏ§Ñ Ï†ïÎ¶¨
                    .trim();
                
                return `<div class="yangum-card">
                    <div class="section-header"><div class="section-icon">‚öñ</div><h2>ÏñëÍ∏∞/ÏùåÍ∏∞ Î∞∏Îü∞Ïä§</h2></div>
                    <div class="section-def">
                        <div class="section-def-title"><span class="icon">‚òØÔ∏è</span> ÏñëÏùå Î∞∏Îü∞Ïä§ÎûÄ?</div>
                        <div class="section-def-content">
                            ÏÇ¨Ï£ºÏùò Í∏ÄÏûêÎì§Ïù¥ <strong>Ïñë(ÈôΩ)</strong>Í≥º <strong>Ïùå(Èô∞)</strong> Ï§ë Ïñ¥Îäê Ï™ΩÏóê Îçî Í∞ÄÍπåÏö¥ÏßÄ Î≥¥Ïó¨Ï§òÏöî. ÏÑ±Í≤©Ïùò Í∏∞Î≥∏ ÌÜ§Í≥º ÏóêÎÑàÏßÄ Î∞©Ìñ•ÏùÑ Ïïå Ïàò ÏûàÏñ¥Ïöî.
                            <div class="section-def-grid">
                                <div class="section-def-item"><strong>ÏñëÍ∏∞ ‚òÄÔ∏è</strong>ÌôúÎèôÏ†Å, Ïô∏Ìñ•Ï†Å</div>
                                <div class="section-def-item"><strong>ÏùåÍ∏∞ üåô</strong>Ïã†Ï§ëÌï®, ÎÇ¥Ìñ•Ï†Å</div>
                            </div>
                        </div>
                    </div>
                    <div class="yangum-labels">
                        <div class="label"><span class="dot yang"></span>ÏñëÍ∏∞(ÈôΩ) ${yangPercent}%</div>
                        <div class="label"><span class="dot eum"></span>ÏùåÍ∏∞(Èô∞) ${eumPercent}%</div>
                    </div>
                    <div class="yangum-gauge">
                        <div class="yang" style="width:${yangPercent}%">${yangPercent >= 20 ? yangPercent + '%' : ''}</div>
                        <div class="eum" style="width:${eumPercent}%">${eumPercent >= 20 ? eumPercent + '%' : ''}</div>
                    </div>
                    <div class="yangum-type">
                        <div class="type-label">ÎÇòÏùò Î∞∏Îü∞Ïä§ Ïú†Ìòï</div>
                        <div class="type-name">${balanceType}</div>
                    </div>
                    ${descContent ? `<div class="yangum-desc">${convertHTML(descContent)}</div>` : ''}
                </div>`;
            };
            
            // Ïã†ÏÇ¥ Î∂ÑÏÑù Î†åÎçîÎßÅ Ìï®Ïàò
            const renderSinsalSection = (content) => {
                // ‚òÖ ÌòïÏãù Í∞êÏßÄ: ### Í∏∏Ïã† or ### ÏñëÎ©¥Ïã† ÏûàÏúºÎ©¥ ÏÉà ÌòïÏãù
                const isNewFormat = /###[^\n]*(Í∏∏Ïã†|ÏñëÎ©¥Ïã†|ÌùâÏã†)/i.test(content);
                // ‚òÖ Ïã†ÏùÄÏßÄ ÌòïÏãù Í∞êÏßÄ: ### Ïù¥Î™®ÏßÄ Ïã†ÏÇ¥Î™Ö (ÌïúÏûê) Ìå®ÌÑ¥
                const isSineunji = /###\s*[üåü‚ö°üîÆüí´‚ú®üèÉüé®‚úçÔ∏èüòáüí∞‚öîÔ∏èüêÇ]\s*[Í∞Ä-Ìû£]+\s*\([^)]+\)/i.test(content);
                
                if (isNewFormat) {
                    // === ÏÉà ÌòïÏãù Î°úÏßÅ (ÏàòÏ†ïÎê® - ÏöîÏïΩ Î™©Î°ù, ÏñëÎ©¥Ïã†/Ï£ºÏùòÏã† Î∂ÑÎ¶¨, Ï¢ÖÌï© Ï°∞Ïñ∏ Í∞úÏÑ†) ===
                    
                    // 1. ÏÑúÎ°† ÌååÏã± (## Ïã†ÏÇ¥ ~ Ï≤´ ### Ï†ÑÍπåÏßÄ)
                    const introMatch = content.match(/##[^\n]*Ïã†ÏÇ¥[^\n]*\n([\s\S]*?)(?=\n###|$)/i);
                    let introText = introMatch ? introMatch[1].trim() : '';
                    
                    // 2. ‚òÖ‚òÖ‚òÖ ÏöîÏïΩ Î™©Î°ù ÌååÏã± (### OOOÎãòÏóêÍ≤å ÏûàÎäî Ïã†ÏÇ¥) ‚òÖ‚òÖ‚òÖ
                    // Ï¢ÖÎ£å Ï°∞Í±¥: --- ÎòêÎäî Îã§Ïùå ### ÎòêÎäî ÎÅù
                    const summaryListMatch = content.match(/###[^\n]*(?:ÏûàÎäî\s*Ïã†ÏÇ¥|Ïã†ÏÇ¥\s*ÏöîÏïΩ)[^\n]*\n([\s\S]*?)(?=\n---|\n###|$)/i);
                    let summaryListHTML = '';
                    
                    if (summaryListMatch) {
                        const summaryContent = summaryListMatch[1].trim();
                        
                        // ‚òÖ‚òÖ‚òÖ ÏôÑÏ†ÑÌûà ÌÇ§ÏõåÎìú Í∏∞Î∞ò! Ïù¥Î™®ÏßÄ ÏûàÎì† ÏóÜÎì† OK ‚òÖ‚òÖ‚òÖ
                        const groups = [];
                        // ** Îí§ Í≥µÎ∞±/Ï§ÑÎ∞îÍøà Î™®Îëê ÌóàÏö©, ÌÇ§ÏõåÎìúÎßåÏúºÎ°ú Îß§Ïπ≠
                        const groupPattern = /\*\*\s*[^\*]*(Í∏∏Ïã†|ÏñëÎ©¥Ïã†|Ï£ºÏùòÏã†|ÌùâÏã†)[^\*]*\*\*[\s\S]*?(?=\*\*\s*[^\*]*(?:Í∏∏Ïã†|ÏñëÎ©¥Ïã†|Ï£ºÏùòÏã†|ÌùâÏã†)|$)/gi;
                        let groupMatch;
                        
                        while ((groupMatch = groupPattern.exec(summaryContent)) !== null) {
                            const fullMatch = groupMatch[0];
                            const groupType = groupMatch[1]; // Í∏∏Ïã†/ÏñëÎ©¥Ïã†/Ï£ºÏùòÏã†/ÌùâÏã†
                            
                            // Ï†úÎ™© Ï∂îÏ∂ú (Ï≤´ Î≤àÏß∏ ** ... ** ÏÇ¨Ïù¥)
                            const titleMatch = fullMatch.match(/\*\*([^\*]+)\*\*/);
                            const groupTitle = titleMatch ? titleMatch[1].trim() : groupType;
                            
                            // ÏïÑÏù¥ÌÖú Ï∂îÏ∂ú (‚ú¶ Î°ú ÏãúÏûëÌïòÎäî Ï§ÑÎì§)
                            const items = fullMatch.split('\n')
                                .filter(line => line.includes('‚ú¶'))
                                .map(line => {
                                    // ÌòïÏãù1: ‚ú¶ Ïù¥Î¶Ñ(ÌïúÏûê) ‚Äî ÏÑ§Î™Ö
                                    // ÌòïÏãù2: ‚ú¶ Ïù¥Î¶Ñ(ÌïúÏûê)
                                    // ÌòïÏãù3: ‚ú¶ Ïù¥Î¶Ñ
                                    const itemMatch = line.match(/‚ú¶\s*([^(]+)\s*\(([^)]+)\)(?:\s*[‚Äî\-]\s*(.+))?/);
                                    if (itemMatch) {
                                        const name = itemMatch[1].trim();
                                        const hanja = itemMatch[2].trim();
                                        const desc = itemMatch[3] ? '<span class="item-desc">‚Äî ' + itemMatch[3].trim() + '</span>' : '';
                                        return '<div class="summary-item"><span class="item-marker">‚ú¶</span><span class="item-name">' + name + '</span><span class="item-hanja">(' + hanja + ')</span>' + desc + '</div>';
                                    }
                                    // ÌïúÏûê ÏóÜÏù¥ Ïù¥Î¶ÑÎßå
                                    const simpleMatch = line.match(/‚ú¶\s*(.+)/);
                                    if (simpleMatch) {
                                        return '<div class="summary-item"><span class="item-marker">‚ú¶</span><span class="item-name">' + simpleMatch[1].trim() + '</span></div>';
                                    }
                                    return '';
                                }).join('');
                            
                            if (items) {
                                // Í∑∏Î£π Ïú†ÌòïÏóê Îî∞Î•∏ Ïä§ÌÉÄÏùº ÌÅ¥ÎûòÏä§
                                let groupClass = 'gilsin-group';
                                if (groupType === 'ÏñëÎ©¥Ïã†') groupClass = 'yangmyeon-group';
                                if (groupType === 'Ï£ºÏùòÏã†' || groupType === 'ÌùâÏã†') groupClass = 'hyungsin-group';
                                
                                groups.push('<div class="summary-group ' + groupClass + '"><div class="group-title">' + groupTitle + '</div><div class="group-items">' + items + '</div></div>');
                            }
                        }
                        
                        if (groups.length > 0) {
                            summaryListHTML = '<div class="sinsal-summary-box"><div class="summary-title">üìã ÎÇòÏóêÍ≤å ÏûàÎäî Ïã†ÏÇ¥</div>' + groups.join('') + '</div>';
                        }
                    }
                    
                    // 3. Í∏∏Ïã† ÏÑπÏÖò ÌååÏã± (### Í∏∏Ïã† ~ Îã§Ïùå ### Ï†ÑÍπåÏßÄ) - Ïù¥Î™®ÏßÄ ÏÉÅÍ¥ÄÏóÜÏù¥!
                    const gilsinSectionMatch = content.match(/###[^\n]*Í∏∏Ïã†[^\n]*\n([\s\S]*?)(?=\n###|$)/i);
                    const gilsinSection = gilsinSectionMatch ? gilsinSectionMatch[1] : '';
                    
                    // 4. ÏñëÎ©¥Ïã† ÏÑπÏÖò ÌååÏã± (### ÏñëÎ©¥Ïã† ~ Îã§Ïùå ### Ï†ÑÍπåÏßÄ)
                    const yangmyeonSectionMatch = content.match(/###[^\n]*ÏñëÎ©¥Ïã†[^\n]*\n([\s\S]*?)(?=\n###|$)/i);
                    const yangmyeonSection = yangmyeonSectionMatch ? yangmyeonSectionMatch[1] : '';
                    
                    // 5. Ï£ºÏùòÏã†/ÌùâÏã† ÏÑπÏÖò ÌååÏã±
                    const hyungsinSectionMatch = content.match(/###[^\n]*(Ï£ºÏùòÏã†|ÌùâÏã†)[^\n]*\n([\s\S]*?)(?=\n###|$)/i);
                    const hyungsinSection = hyungsinSectionMatch ? hyungsinSectionMatch[2] : '';
                    
                    // 6. ‚òÖ‚òÖ‚òÖ Ïã†ÏÇ¥ Ï°∞Ìï© Ìï¥ÏÑù ÌååÏã± ‚òÖ‚òÖ‚òÖ
                    const comboSectionMatch = content.match(/###[^\n]*Ïã†ÏÇ¥\s*Ï°∞Ìï©[^\n]*\n([\s\S]*?)(?=\n###|$)/i);
                    let comboHTML = '';
                    if (comboSectionMatch) {
                        const comboContent = comboSectionMatch[1]
                            .replace(/\n-{3,}\n?/g, '')
                            .trim();
                        comboHTML = '<div class="sinsal-combo"><div class="combo-title">üîÆ Ïã†ÏÇ¥ Ï°∞Ìï© Ìï¥ÏÑù</div><div class="combo-content">' + convertHTML(comboContent) + '</div></div>';
                    }
                    
                    // 7. ‚òÖ‚òÖ‚òÖ Ï¢ÖÌï© Ï°∞Ïñ∏ ÌååÏã± (### üí° Ïã†ÏÇ¥ Ï¢ÖÌï© Ï°∞Ïñ∏) ‚òÖ‚òÖ‚òÖ
                    const summaryAdviceMatch = content.match(/###[^\n]*(üí°|Ï¢ÖÌï©\s*Ï°∞Ïñ∏)[^\n]*\n([\s\S]*?)(?=\n###|$)/i);
                    let summaryAdviceHTML = '';
                    
                    if (summaryAdviceMatch) {
                        const adviceContent = (summaryAdviceMatch[2] || summaryAdviceMatch[1])
                            .replace(/^-{3,}$/gm, '')  // Íµ¨Î∂ÑÏÑ† Ï†úÍ±∞
                            .trim();
                        
                        if (adviceContent.length > 10) {
                            summaryAdviceHTML = '<div class="sinsal-advice"><div class="advice-title">üí° Ïã†ÏÇ¥ Ï¢ÖÌï© Ï°∞Ïñ∏</div><div class="advice-content">' + convertHTML(adviceContent) + '</div></div>';
                        }
                    }
                    
                    // 7. Í∞úÎ≥Ñ Ïã†ÏÇ¥ ÌååÏã± Ìï®Ïàò (**Î≤àÌò∏. Ïù¥Î¶Ñ ‚Äî ÏÑ§Î™Ö** ÌòïÏãù)
                    const parseSinsalItems = (sectionContent, type) => {
                        let items = '';
                        // **1. Ïã†ÏÇ¥Î™Ö(ÌïúÏûê) ‚Äî ÏÑ§Î™Ö** ÎòêÎäî **1. Ïã†ÏÇ¥Î™Ö + Ïã†ÏÇ¥Î™Ö ‚Äî ÏÑ§Î™Ö** Ìå®ÌÑ¥
                        const pattern = /\*\*(\d+)\.\s*([^‚Äî\-*]+)[‚Äî\-]\s*([^*]+)\*\*/g;
                        let match;
                        const matches = [];
                        
                        while ((match = pattern.exec(sectionContent)) !== null) {
                            matches.push({
                                index: match.index,
                                num: match[1],
                                fullName: match[2].trim(),  // Ïòà: "Ï≤úÏùÑÍ∑ÄÏù∏(Â§©‰πôË≤¥‰∫∫)" ÎòêÎäî "Ï≤úÎçïÍ∑ÄÏù∏ + ÏõîÎçïÍ∑ÄÏù∏"
                                desc: match[3].trim()
                            });
                        }
                        
                        // Í∞Å Ïã†ÏÇ¥Ïùò Î≥∏Î¨∏ Ï∂îÏ∂ú (‚òÖ Îã§Ïùå Ïã†ÏÇ¥ ÎòêÎäî ### Ï¢ÖÌï© Ï°∞Ïñ∏ Ï†ÑÍπåÏßÄÎßå)
                        matches.forEach((m, idx) => {
                            const startIdx = sectionContent.indexOf('\n', m.index) + 1;
                            let endIdx;
                            
                            if (idx < matches.length - 1) {
                                endIdx = matches[idx + 1].index;
                            } else {
                                // ÎßàÏßÄÎßâ Ïã†ÏÇ¥Ïù∏ Í≤ΩÏö∞, ### ÎòêÎäî --- Ï†ÑÍπåÏßÄÎßå
                                const remainingContent = sectionContent.slice(startIdx);
                                const endMatch = remainingContent.match(/\n###|\n---\s*$/);
                                endIdx = endMatch ? startIdx + endMatch.index : sectionContent.length;
                            }
                            
                            let body = sectionContent.slice(startIdx, endIdx)
                                .replace(/\n-{3,}\n?/g, '')  // --- Íµ¨Î∂ÑÏÑ† Ï†úÍ±∞
                                .replace(/<!--(?!\s*\/?(ÏôúÍ∑∏Îü∞ÏßÄ|ÏÜåÎ¶Ñ|Í≥µÍ∞ê|Ï£ºÏùò|Ï°∞Ïñ∏|Ìù¨Îßù|Í∞ïÏ†ê)\s*-->)[^>]*-->/g, '')  // Ï£ºÏÑù Ï†úÍ±∞ (Î∞ïÏä§ ÌÉúÍ∑∏ Ï†úÏô∏)
                                .trim();
                            
                            // ÏïÑÏù¥ÏΩò Î∞è CSS ÌÅ¥ÎûòÏä§ Í≤∞Ï†ï
                            let icon, cssClass;
                            if (type === 'gilsin') {
                                icon = 'üåü';
                                cssClass = 'gilsin';
                            } else if (type === 'yangmyeon') {
                                icon = '‚ö°';
                                cssClass = 'yangmyeon';
                            } else {
                                icon = '‚ö†Ô∏è';
                                cssClass = 'hyungsin';
                            }
                            
                            if (body.length > 5) {
                                items += '<div class="sinsal-item ' + cssClass + '"><div class="item-header"><div class="item-icon">' + icon + '</div><div><div class="item-name">' + m.fullName + '</div><div class="item-type">' + m.desc + '</div></div></div><div class="item-body">' + convertHTML(body) + '</div></div>';
                            }
                        });
                        
                        return items;
                    };
                    
                    // 8. Í∞Å ÏÑπÏÖòÎ≥Ñ ÏïÑÏù¥ÌÖú ÏÉùÏÑ±
                    const gilsinItems = parseSinsalItems(gilsinSection, 'gilsin');
                    const yangmyeonItems = parseSinsalItems(yangmyeonSection, 'yangmyeon');
                    const hyungsinItems = parseSinsalItems(hyungsinSection, 'hyungsin');
                    
                    return `<div class="sinsal-card">
                        <div class="section-header"><div class="section-icon">ÁÖû</div><h2>Ïã†ÏÇ¥ Î∂ÑÏÑù</h2></div>
                        <div class="section-def">
                            <div class="section-def-title"><span class="icon">‚ö°</span> Ïã†ÏÇ¥Ïù¥ÎûÄ?</div>
                            <div class="section-def-content">
                                ÏÇ¨Ï£ºÏóê Îã¥Í∏¥ <strong>ÌäπÎ≥ÑÌïú Í∏∞Ïö¥</strong>Ïù¥ÏóêÏöî. "ÏÇ¥(ÊÆ∫)"Ïù¥ÎùºÍ≥† Ìï¥ÏÑú Î¨¥Ï°∞Í±¥ ÎÇòÏÅú Í≤å ÏïÑÎãàÏóêÏöî!
                                <div class="section-def-grid">
                                    <div class="section-def-item"><strong>Í∏∏Ïã† üåü</strong>Î≥µÏùÑ Ï£ºÎäî Í∏∞Ïö¥</div>
                                    <div class="section-def-item"><strong>ÏñëÎ©¥Ïã† ‚ö°</strong>ÌôúÏö©ÌïòÍ∏∞ ÎÇòÎ¶Ñ</div>
                                    <div class="section-def-item"><strong>Ï£ºÏùòÏã† ‚ö†Ô∏è</strong>Ï£ºÏùòÌï† Í∏∞Ïö¥</div>
                                </div>
                            </div>
                        </div>
                        ${introText ? `<div class="sinsal-intro" style="background:#f9f6ef;border-radius:12px;padding:20px;margin:20px 0;">${convertHTML(introText)}</div>` : ''}
                        ${summaryListHTML}
                        ${gilsinItems ? `<div class="sinsal-group"><div style="font-weight:700;color:#2e7d32;margin:25px 0 15px;font-size:16px;">‚ú® Í∏∏Ïã† (Ï¢ãÏùÄ Í∏∞Ïö¥)</div>${gilsinItems}</div>` : ''}
                        ${yangmyeonItems ? `<div class="sinsal-group"><div style="font-weight:700;color:#e65100;margin:25px 0 15px;font-size:16px;">‚ö° ÏñëÎ©¥Ïã† (ÏñëÎ©¥Ïùò Í∏∞Ïö¥)</div>${yangmyeonItems}</div>` : ''}
                        ${hyungsinItems ? `<div class="sinsal-group"><div style="font-weight:700;color:#c62828;margin:25px 0 15px;font-size:16px;">‚ö†Ô∏è Ï£ºÏùòÏã† (Ï£ºÏùòÌï† Í∏∞Ïö¥)</div>${hyungsinItems}</div>` : ''}
                        ${comboHTML}
                        ${summaryAdviceHTML}
                    </div>`;
                    
                } else if (isSineunji) {
                    // === Ïã†ÏùÄÏßÄ ÌòïÏãù Î°úÏßÅ (### Ïù¥Î™®ÏßÄ Ïã†ÏÇ¥Î™Ö (ÌïúÏûê) Ìå®ÌÑ¥) ===
                    
                    // 1. ÏÑúÎ°† ÌååÏã± (Ï≤´ ### Ïù¥Î™®ÏßÄ Ï†ÑÍπåÏßÄ)
                    const firstSinsalMatch = content.match(/\n###\s*[üåü‚ö°üîÆüí´‚ú®üèÉüé®‚úçÔ∏èüòáüí∞‚öîÔ∏èüêÇ]/);
                    let introText = '';
                    if (firstSinsalMatch) {
                        introText = content.slice(0, firstSinsalMatch.index)
                            .replace(/##[^\n]*Ïã†ÏÇ¥[^\n]*/gi, '')  // ÎåÄÏ†úÎ™© Ï†úÍ±∞
                            .replace(/###[^\n]*ÏûàÎäî Ïã†ÏÇ¥[^\n]*/gi, '')  // Î∂ÄÏ†úÎ™© Ï†úÍ±∞
                            .replace(/\*\*üåü[^*]*\*\*/g, '')  // Í∏∏Ïã† Î™©Î°ù Ï†úÍ±∞
                            .replace(/\*\*‚ö°[^*]*\*\*/g, '')  // ÏñëÎ©¥Ïã† Î™©Î°ù Ï†úÍ±∞
                            .replace(/‚ú¶[^\n]*/g, '')  // Ïã†ÏÇ¥ Î™©Î°ù Ìï≠Î™© Ï†úÍ±∞
                            .replace(/^-{3,}$/gm, '')  // Íµ¨Î∂ÑÏÑ† Ï†úÍ±∞
                            .replace(/\n{3,}/g, '\n\n')
                            .trim();
                    }
                    
                    // 2. ### Ïù¥Î™®ÏßÄ Ïã†ÏÇ¥Î™Ö (ÌïúÏûê) Ìå®ÌÑ¥ÏúºÎ°ú Í∞Å Ïã†ÏÇ¥ Ï∞æÍ∏∞
                    const sinsalPattern = /###\s*([üåü‚ö°üîÆüí´‚ú®üèÉüé®‚úçÔ∏èüòáüí∞‚öîÔ∏èüêÇüåô‚òÄÔ∏èüî•üíßüåø‚õ∞Ô∏èüó°Ô∏èüëëüé≠üíùüå∏ü¶ã‚öñÔ∏èüéØüíéüåàüé™üéÅ]+)\s*([Í∞Ä-Ìû£]+(?:ÏÇ¥|Í∑ÄÏù∏|Î°ù|ÏÑ±)?)\s*\(([^)]+)\)/g;
                    
                    let matches = [];
                    let match;
                    while ((match = sinsalPattern.exec(content)) !== null) {
                        matches.push({
                            index: match.index,
                            fullMatch: match[0],
                            emoji: match[1],
                            name: match[2].trim(),
                            hanja: match[3].trim()
                        });
                    }
                    
                    // 3. Í∞Å Ïã†ÏÇ¥ Î≥∏Î¨∏ Ï∂îÏ∂ú Î∞è HTML ÏÉùÏÑ±
                    let items = '';
                    
                    matches.forEach((m, idx) => {
                        const startIdx = m.index + m.fullMatch.length;
                        const endIdx = idx < matches.length - 1 
                            ? matches[idx + 1].index 
                            : content.length;
                        
                        let body = content.slice(startIdx, endIdx).trim();
                        
                        // **Ïú†Ìòï:** ÎùºÏù∏ÏóêÏÑú ÏÑ§Î™Ö Ï∂îÏ∂ú
                        const typeMatch = body.match(/\*\*Ïú†Ìòï:\*\*\s*([^\n]+)/);
                        let typeDesc = '';
                        if (typeMatch) {
                            typeDesc = typeMatch[1].replace(/^(Í∏∏Ïã†|ÌùâÏã†|ÏñëÎ©¥Ïã†)\s*[‚Äî\-]\s*/, '').trim();
                            body = body.replace(typeMatch[0], '').trim();  // Ïú†Ìòï ÎùºÏù∏ Ï†úÍ±∞
                        }
                        
                        // Í∏∏Ïã†/ÌùâÏã† ÌåêÎã®
                        const isGilsin = m.emoji.includes('üåü') || (typeMatch && typeMatch[1].includes('Í∏∏Ïã†'));
                        const cssClass = isGilsin ? 'gilsin' : 'hyungsin';
                        
                        if (body.length > 5) {
                            items += `
                                <div class="sinsal-item ${cssClass}">
                                    <div class="item-header">
                                        <div class="item-icon">${m.emoji}</div>
                                        <div>
                                            <div class="item-name">${m.name}(${m.hanja})</div>
                                            <div class="item-type">${typeDesc || ''}</div>
                                        </div>
                                    </div>
                                    <div class="item-body">${convertHTML(body)}</div>
                                </div>`;
                        }
                    });
                    
                    // 4. Í≤∞Í≥º Î∞òÌôò
                    return `<div class="sinsal-card">
                        <div class="section-header"><div class="section-icon">ÁÖû</div><h2>Ïã†ÏÇ¥ Î∂ÑÏÑù</h2></div>
                        <div class="section-def">
                            <div class="section-def-title"><span class="icon">‚ö°</span> Ïã†ÏÇ¥Ïù¥ÎûÄ?</div>
                            <div class="section-def-content">
                                ÏÇ¨Ï£ºÏóê Îã¥Í∏¥ <strong>ÌäπÎ≥ÑÌïú Í∏∞Ïö¥</strong>Ïù¥ÏóêÏöî. "ÏÇ¥(ÊÆ∫)"Ïù¥ÎùºÍ≥† Ìï¥ÏÑú Î¨¥Ï°∞Í±¥ ÎÇòÏÅú Í≤å ÏïÑÎãàÏóêÏöî!
                                <div class="section-def-grid">
                                    <div class="section-def-item"><strong>Í∏∏Ïã† üåü</strong>Î≥µÏùÑ Ï£ºÎäî Í∏∞Ïö¥</div>
                                    <div class="section-def-item"><strong>ÏñëÎ©¥Ïã† ‚ö°</strong>ÌôúÏö©ÌïòÍ∏∞ ÎÇòÎ¶Ñ</div>
                                </div>
                            </div>
                        </div>
                        ${introText ? `<div class="sinsal-intro" style="background:#f9f6ef;border-radius:12px;padding:20px;margin:20px 0;font-size:14px;line-height:1.8;color:#5a4a38;">${introText}</div>` : ''}
                        <div class="sinsal-items">${items}</div>
                    </div>`;
                    
                } else {
                    // === ÏòõÎÇ† ÌòïÏãù Î°úÏßÅ (Ïù¥Î™®ÏßÄ+Ïã†ÏÇ¥Î™Ö ‚Äî ÏÑ§Î™Ö Ìå®ÌÑ¥) ===
                    
                    // 1. ÏÑúÎ°† ÌååÏã± (Ï≤´ Ïù¥Î™®ÏßÄ Ïã†ÏÇ¥ Ï†ÑÍπåÏßÄ, ÌÖåÏù¥Î∏î Ï†úÏô∏)
                    const firstSinsalMatch = content.match(/\n[üèÉüé®‚úçÔ∏èüòáüí∞‚öîÔ∏èüêÇüåü‚ö°üîÆüí´‚ú®üåô‚òÄÔ∏èüî•üíßüåø‚õ∞Ô∏èüó°Ô∏èüëëüé≠üíùüå∏ü¶ã‚öñÔ∏èüéØüíéüåàüé™üéÅ]/);
                    let introText = '';
                    if (firstSinsalMatch) {
                        introText = content.slice(0, firstSinsalMatch.index)
                            .replace(/##[^\n]*Ïã†ÏÇ¥[^\n]*/gi, '')  // Ï†úÎ™© Ï†úÍ±∞
                            .replace(/\|[\s\S]*?\|\n?/g, '')  // ÌÖåÏù¥Î∏î Ï†úÍ±∞ (Í∞ÑÎã®Ìûà)
                            .replace(/Ïã†ÏÇ¥ÏúÑÏπòÏùòÎØ∏Ï†ÅÏö©[\s\S]*?(?=\n\n|\n[üèÉüé®])/gi, '')  // ÌÖåÏù¥Î∏î ÌÖçÏä§Ìä∏ Ï†úÍ±∞
                            .trim();
                    }
                    
                    // 2. Ïù¥Î™®ÏßÄ+Ïã†ÏÇ¥Î™Ö Ìå®ÌÑ¥ÏúºÎ°ú Í∞Å Ïã†ÏÇ¥ Ï∞æÍ∏∞
                    const sinsalPattern = /\n([üèÉüé®‚úçÔ∏èüòáüí∞‚öîÔ∏èüêÇüåü‚ö°üîÆüí´‚ú®üåô‚òÄÔ∏èüî•üíßüåø‚õ∞Ô∏èüó°Ô∏èüëëüé≠üíùüå∏ü¶ã‚öñÔ∏èüéØüíéüåàüé™üéÅ]+)\s*([Í∞Ä-Ìû£]+(?:ÏÇ¥|Í∑ÄÏù∏|Î°ù|ÏÑ±)?)\s*[‚Äî\-]\s*([^\n]+)/g;
                    
                    let matches = [];
                    let match;
                    while ((match = sinsalPattern.exec(content)) !== null) {
                        matches.push({
                            index: match.index,
                            fullMatch: match[0],
                            emoji: match[1],
                            name: match[2].trim(),
                            desc: match[3].trim()
                        });
                    }
                    
                    // 3. Í∞Å Ïã†ÏÇ¥Ïùò Î≥∏Î¨∏ Ï∂îÏ∂ú Î∞è HTML ÏÉùÏÑ±
                    let items = '';
                    const gilsinKeywords = ['Í∑ÄÏù∏', 'Î¨∏Ï∞Ω', 'Ï≤úÏùÑ', 'Í∏àÏó¨Î°ù', 'Ï≤úÎçï', 'ÏõîÎçï', 'Î≥µÏÑ±', 'ÌôîÍ∞ú'];
                    
                    matches.forEach((m, idx) => {
                        const startIdx = m.index + m.fullMatch.length;
                        const endIdx = idx < matches.length - 1 
                            ? matches[idx + 1].index 
                            : content.length;
                        
                        let body = content.slice(startIdx, endIdx).trim();
                        
                        // Í∏∏Ïã†/ÌùâÏã† ÌåêÎã® (Ïã†ÏÇ¥ Ïù¥Î¶Ñ Í∏∞Î∞ò)
                        const isGilsin = gilsinKeywords.some(k => m.name.includes(k));
                        const cssClass = isGilsin ? 'gilsin' : 'hyungsin';
                        
                        if (body.length > 5) {
                            items += `
                                <div class="sinsal-item ${cssClass}">
                                    <div class="item-header">
                                        <div class="item-icon">${m.emoji}</div>
                                        <div>
                                            <div class="item-name">${m.name}</div>
                                            <div class="item-type">${m.desc}</div>
                                        </div>
                                    </div>
                                    <div class="item-body">${convertHTML(body)}</div>
                                </div>`;
                        }
                    });
                    
                    // 4. Í≤∞Í≥º Î∞òÌôò
                    return `<div class="sinsal-card">
                        <div class="section-header"><div class="section-icon">ÁÖû</div><h2>Ïã†ÏÇ¥ Î∂ÑÏÑù</h2></div>
                        <div class="section-def">
                            <div class="section-def-title"><span class="icon">‚ö°</span> Ïã†ÏÇ¥Ïù¥ÎûÄ?</div>
                            <div class="section-def-content">
                                ÏÇ¨Ï£ºÏóê Îã¥Í∏¥ <strong>ÌäπÎ≥ÑÌïú Í∏∞Ïö¥</strong>Ïù¥ÏóêÏöî. "ÏÇ¥(ÊÆ∫)"Ïù¥ÎùºÍ≥† Ìï¥ÏÑú Î¨¥Ï°∞Í±¥ ÎÇòÏÅú Í≤å ÏïÑÎãàÏóêÏöî!
                                <div class="section-def-grid">
                                    <div class="section-def-item"><strong>Í∏∏Ïã† üåü</strong>Î≥µÏùÑ Ï£ºÎäî Í∏∞Ïö¥</div>
                                    <div class="section-def-item"><strong>ÌùâÏã† ‚ö°</strong>Ï£ºÏùòÌï† Í∏∞Ïö¥</div>
                                </div>
                            </div>
                        </div>
                        ${introText ? `<div class="sinsal-intro" style="background:#f9f6ef;border-radius:12px;padding:20px;margin:20px 0;font-size:14px;line-height:1.8;color:#5a4a38;">${introText}</div>` : ''}
                        <div class="sinsal-items">${items}</div>
                    </div>`;
                }
            };
            
            // ÌéòÏù¥ÏßÄÎ≥Ñ Î†åÎçîÎßÅ
            let cards = '';
            let lastSection = '';
            
            // ‚òÖ‚òÖ‚òÖ ÌïµÏã¨ ÏöîÏïΩ (METAÏôÄ Ï≤´ ÌéòÏù¥ÏßÄ ÏÇ¨Ïù¥) Î†åÎçîÎßÅ ‚òÖ‚òÖ‚òÖ
            if (metaData.preContent) {
                const preContent = metaData.preContent;
                
                // 1. <!-- Ïò¨Ìï¥ÌïµÏã¨ --> ÌÉúÍ∑∏ Ï≤òÎ¶¨
                const olhaeMatch = preContent.match(/<!--\s*Ïò¨Ìï¥ÌïµÏã¨\s*-->([\s\S]*?)<!--\s*\/Ïò¨Ìï¥ÌïµÏã¨\s*-->/i);
                if (olhaeMatch) {
                    // ‚òÖ Ïó∞ÎèÑ Ï∂îÏ∂ú (### üìã 2026ÎÖÑ ÌïµÏã¨ ÏöîÏïΩ ÌòïÏãùÏóêÏÑú)
                    const yearMatch = preContent.match(/###?\s*üìã?\s*(\d{4})ÎÖÑ\s*ÌïµÏã¨/);
                    const summaryYear = yearMatch ? yearMatch[1] : new Date().getFullYear();
                    
                    const olhaeContent = olhaeMatch[1].trim()
                        .replace(/^>\s*(.+)$/gm, '<div style="margin:12px 0;padding:12px 16px;background:rgba(212,175,130,0.1);border-left:3px solid #d4af82;border-radius:0 8px 8px 0;font-style:italic;">$1</div>')
                        .replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
                        .replace(/\*([^*\n]+)\*/g, '<em style="color:#5d4e37;">$1</em>')
                        .replace(/\n/g, '<br>')
                        .replace(/‚ú¶/g, '<span style="color:#d4af82;">‚ú¶</span>');
                    cards += `<div class="year-summary-card" style="background:linear-gradient(135deg,#f9f6ef,#f0ebe0);border:2px solid #d4af82;border-radius:16px;padding:25px 30px;margin:20px 0;box-shadow:0 4px 15px rgba(212,175,130,0.2);">
                        <div style="text-align:center;color:#d4af82;font-size:18px;font-weight:700;margin-bottom:20px;">‚ú® ${summaryYear}ÎÖÑ ÌïµÏã¨ ÏöîÏïΩ</div>
                        <div style="color:#4a3d30;font-size:15px;line-height:1.8;">${olhaeContent}</div>
                    </div>`;
                }
                
                // 2. ## üí° ÎãπÏã†Ïùò ÏÇ¨Ï£º, ÌïúÎààÏóê Î≥¥Í∏∞ Ï≤òÎ¶¨
                const sajuSummaryMatch = preContent.match(/##\s*üí°[^\n]*ÌïúÎààÏóê[^\n]*\n([\s\S]*?)(?=\n---\s*$|\n##|$)/im);
                if (sajuSummaryMatch) {
                    const sajuContent = sajuSummaryMatch[1].trim()
                        .replace(/‚Ä¢\s*/g, '<span style="color:#d4af82;margin-right:8px;">‚Ä¢</span>')
                        .replace(/\*\*([^*]+)\*\*/g, '<strong style="color:#3d4a6b;">$1</strong>')
                        .replace(/‚Üí\s*/g, '<span style="color:#d4af82;margin:0 5px;">‚Üí</span>')
                        .replace(/‚ú®\s*\*\*([^*]+)\*\*:\s*"([^"]+)"/g, '<div style="margin-top:15px;padding:15px;background:rgba(212,175,130,0.1);border-radius:10px;text-align:center;"><span style="color:#d4af82;">‚ú®</span> <strong>$1:</strong> <em>"$2"</em></div>')
                        .replace(/\n/g, '<br>');
                    cards += `<div class="saju-overview-card" style="background:linear-gradient(135deg,#fdfbf7,#f5f0e6);border:1px solid #e5dccb;border-radius:16px;padding:25px;margin:20px 0;box-shadow:0 4px 15px rgba(139,115,85,0.08);">
                        <div style="display:flex;align-items:center;gap:10px;margin-bottom:18px;padding-bottom:12px;border-bottom:1px solid #e5dccb;">
                            <span style="font-size:24px;">üí°</span>
                            <span style="font-size:17px;font-weight:700;color:#3d4a6b;">ÎãπÏã†Ïùò ÏÇ¨Ï£º, ÌïúÎààÏóê Î≥¥Í∏∞</span>
                        </div>
                        <div style="color:#4a3d30;font-size:14px;line-height:2.0;">${sajuContent}</div>
                    </div>`;
                }
            }
            
            pageData.forEach(p => {
                // ÌëúÏßÄ ÌéòÏù¥ÏßÄ Ï≤òÎ¶¨
                if (p.title.includes('ÌëúÏßÄ')) {
                    // 1. Ïò¨Ìï¥ÌïµÏã¨ ÌÉúÍ∑∏ Ï≤òÎ¶¨ (preContentÏóêÏÑú Ïù¥ÎØ∏ Ï≤òÎ¶¨ÌñàÏúºÎ©¥ Ïä§ÌÇµ)
                    if (!metaData.preContent) {
                        const olhaeMatch = p.content.match(/<!--\s*Ïò¨Ìï¥ÌïµÏã¨\s*-->([\s\S]*?)<!--\s*\/Ïò¨Ìï¥ÌïµÏã¨\s*-->/i);
                        if (olhaeMatch) {
                            // ‚òÖ Ïó∞ÎèÑ Ï∂îÏ∂ú
                            const yearMatch = p.content.match(/###?\s*üìã?\s*(\d{4})ÎÖÑ\s*ÌïµÏã¨/);
                            const summaryYear = yearMatch ? yearMatch[1] : new Date().getFullYear();
                            
                            const content = olhaeMatch[1].trim()
                                .replace(/^>\s*(.+)$/gm, '<div style="margin:12px 0;padding:12px 16px;background:rgba(212,175,130,0.1);border-left:3px solid #d4af82;border-radius:0 8px 8px 0;font-style:italic;">$1</div>')
                                .replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
                                .replace(/\*([^*\n]+)\*/g, '<em style="color:#5d4e37;">$1</em>')
                                .replace(/\n/g, '<br>')
                                .replace(/‚ú¶/g, '<span style="color:#d4af82;">‚ú¶</span>');
                            cards += `<div class="year-summary-card" style="background:linear-gradient(135deg,#f9f6ef,#f0ebe0);border:2px solid #d4af82;border-radius:16px;padding:25px 30px;margin:20px 0;box-shadow:0 4px 15px rgba(212,175,130,0.2);">
                                <div style="text-align:center;color:#d4af82;font-size:18px;font-weight:700;margin-bottom:20px;">‚ú® ${summaryYear}ÎÖÑ ÌïµÏã¨ ÏöîÏïΩ</div>
                                <div style="color:#4a3d30;font-size:15px;line-height:1.8;">${content}</div>
                            </div>`;
                        }
                    }
                    
                    // 2. ‚òÖ‚òÖ‚òÖ ÌëúÏßÄ Ï†úÎ™© Ïπ¥Îìú Î†åÎçîÎßÅ (# Ïù¥Î¶ÑÎãòÏùò ÏÇ¨Ï£º Ïù¥ÏïºÍ∏∞) ‚òÖ‚òÖ‚òÖ
                    const titleMatch = p.content.match(/^#\s*([^\n]+)\n\*\*([^*]+)\*\*/m);
                    if (titleMatch) {
                        const mainTitle = titleMatch[1].trim();
                        const subTitle = titleMatch[2].trim();
                        cards += `<div class="cover-intro-card" style="background:linear-gradient(135deg,#2a2115,#3d3225);border-radius:16px;padding:35px 25px;margin:20px 0;text-align:center;border:1px solid rgba(212,175,130,0.3);">
                            <div style="font-size:11px;letter-spacing:4px;color:#a89068;margin-bottom:15px;">‚ú¶ SAJU STORY ‚ú¶</div>
                            <div style="font-size:22px;font-weight:700;color:#f5efe3;margin-bottom:12px;letter-spacing:1px;">${mainTitle}</div>
                            <div style="font-size:14px;color:#d4af82;line-height:1.8;">${subTitle}</div>
                        </div>`;
                    }
                    
                    return; // ÌëúÏßÄ ÌéòÏù¥ÏßÄ Ï≤òÎ¶¨ ÏôÑÎ£å
                }
                
                // ÏÑπÏÖò Íµ¨Î∂ÑÏÑ† Ï∂îÍ∞Ä (ÏÉà ÏÑπÏÖòÏùº ÎïåÎßå)
                const secNum = getSectionNum(p.title);
                if (secNum && secNum !== lastSection) {
                    cards += `<div class="section-divider" id="section-${secNum}" data-num="${secNum}"><span class="num">${secNum}</span><span class="title">${getShortTitle(p.title)}</span></div>`;
                    lastSection = secNum;
                }
                
                // ÌäπÏàò ÌéòÏù¥ÏßÄ Ï≤òÎ¶¨
                console.log('[DEBUG] ÌéòÏù¥ÏßÄ:', p.title, '‚Üí', 
                    p.title.includes('2026') ? 'Fortune' :
                    p.title.includes('Ïã†ÏÇ¥') ? 'Sinsal' :
                    p.title.includes('ÏñëÍ∏∞') ? 'Yangum' : 'General');
                
                if (p.title.includes('2026') || p.title.includes('Ïö¥ÏÑ∏') && p.title.includes('ÎÖÑ')) {
                    cards += renderFortuneCard(p.content);
                } else if (p.title.includes('ÏõîÎ≥Ñ')) {
                    cards += renderMonthlySection(p.content);
                } else if (p.title.includes('ÎåÄÏö¥')) {
                    cards += renderDaeunSection(p.content);
                } else if (p.title.includes('ÏñëÍ∏∞') || p.title.includes('ÏùåÍ∏∞') || (p.title.includes('Î∞∏Îü∞Ïä§') && (p.title.includes('Ïñë') || p.title.includes('Ïùå')))) {
                    // ÏñëÏùå Î∞∏Îü∞Ïä§ Ïπ¥Îìú
                    cards += renderYangumSection(p.content);
                } else if (p.title.includes('Ïã†ÏÇ¥')) {
                    // Ïã†ÏÇ¥ Î∂ÑÏÑù Ïπ¥Îìú
                    cards += renderSinsalSection(p.content);
                } else if (p.title.includes('Í∑ÄÏù∏') || p.title.includes('Ïù∏Ïó∞')) {
                    cards += renderGwiinSection(p.content);
                } else if (isYeokakPage(p.title)) {
                    // V3 Ï∂îÍ∞Ä: Ïó≠Ìïô ÌÜµÌï© Ïπ¥Îìú
                    cards += renderYeokakCard(p.title, p.content);
                } else {
                    // ÏùºÎ∞ò Ìï¥ÏÑù Ïπ¥Îìú
                    cards += `<div class="interpret-card"><div class="card-header"><span class="emoji">${getEmoji(p.title)}</span><h3>${p.title}</h3></div><div class="card-body">${convertHTML(p.content)}</div></div>`;
                }
            });
            
            const y = metaData.Ïó∞Ï£º?.chars || '', m = metaData.ÏõîÏ£º?.chars || '', d = metaData.ÏùºÏ£º?.chars || '', h = metaData.ÏãúÏ£º?.chars || '';
            
            // Ìå®ÌÇ§ÏßÄÎ≥Ñ Î™©Ï∞® ÏÑ§Ï†ï (2025-12-16 ÏÉà Íµ¨Ï°∞)
            const pkg = metaData.package || 'premium';
            const tocItems = [
                { num: '01', title: 'ÏÇ¨Ï£º Î™ÖÏãù Ìï¥ÏÑ§', light: true, standard: true, premium: true },
                { num: '02', title: 'ÏùºÍ∞Ñ ÏÑ±Ìñ• Î∂ÑÏÑù', light: true, standard: true, premium: true },
                { num: '03', title: 'Ïò§Ìñâ ÏóêÎÑàÏßÄ Î∂ÑÏÑù', light: true, standard: true, premium: true },
                { num: '04', title: 'ÏñëÍ∏∞/ÏùåÍ∏∞ Î∞∏Îü∞Ïä§', light: true, standard: true, premium: true },
                { num: '05', title: 'ÏÑ±Í≤© Î∞è Ïã¨Î¶¨ Ìå®ÌÑ¥', light: false, standard: true, premium: true },
                { num: '06', title: 'Ïã†ÏÇ¥ Î∂ÑÏÑù', light: false, standard: true, premium: true },
                { num: '07', title: 'Ïò¨Ìï¥ Ïö¥ÏÑ∏ ÌùêÎ¶Ñ', light: true, standard: true, premium: true },
                { num: '08', title: 'ÏõîÎ≥Ñ Ïö¥ÏÑ∏', light: true, standard: true, premium: true },
                { num: '09', title: 'Ïó∞Ïï†Ïö¥', light: true, standard: true, premium: true },
                { num: '10', title: 'ÏßÅÏóÖÏö¥', light: true, standard: true, premium: true },
                { num: '11', title: 'Ïû¨Î¨ºÏö¥', light: true, standard: true, premium: true },
                { num: '12', title: 'Í±¥Í∞ïÏö¥', light: false, standard: false, premium: true },
                { num: '13', title: 'ÎåÄÏö¥ ÌùêÎ¶Ñ', light: false, standard: true, premium: true },
                { num: '14', title: 'Ïù∏Í∞Ñ Í¥ÄÍ≥Ñ Ïö¥', light: false, standard: false, premium: true },
                { num: '15', title: 'ÎßûÏ∂§ ÏßàÎ¨∏ Î∂ÑÏÑù', light: false, standard: false, premium: true },
                { num: '16', title: 'ÏÑ±Î™ÖÌïô + Ï£ºÏó≠', light: false, standard: false, premium: true },
                { num: '17', title: 'ÌÉùÏùº¬∑Í¥ÄÏÉÅ¬∑ÌíçÏàò', light: false, standard: false, premium: true },
                { num: '18', title: 'Ïö¥Î™ÖÏùò ÏÉÅÎåÄ Í∏∞Ïö¥ÏÉÅ', light: false, standard: false, premium: true },
                { num: '19', title: 'Ï¢ÖÌï© Ï°∞Ïñ∏', light: true, standard: true, premium: true }
            ];
            const pkgKey = pkg.includes('ÎùºÏù¥Ìä∏') ? 'light' : pkg.includes('Ïä§ÌÉ†Îã§Îìú') ? 'standard' : 'premium';
            const tocHTML = tocItems
                .filter(item => {
                    const val = item[pkgKey];
                    const included = val === true || val === 'hint';
                    if (!included) return false; // Ìå®ÌÇ§ÏßÄÏóê Ìè¨Ìï® Ïïà ÎêòÎ©¥ Ï†úÏô∏
                    
                    // pageDataÍ∞Ä ÏûàÏúºÎ©¥ Ïã§Ï†ú Ï°¥Ïû¨ Ïó¨Î∂ÄÎèÑ Ï≤¥ÌÅ¨
                    if (pageData.length > 0) {
                        const hasPage = pageData.some(p => getSectionNum(p.title) === item.num);
                        return hasPage;
                    }
                    return true;
                })
                .map(item => {
                    const isHint = item[pkgKey] === 'hint';
                    return `<li class="toc-item clickable" onclick="document.getElementById('section-${item.num}').scrollIntoView({behavior:'smooth'})">
                        <span class="check included"></span>
                        <span class="title">${item.title}${isHint ? '<span class="hint-badge">ÌûåÌä∏</span>' : ''}</span>
                        <span class="num">${item.num}</span>
                    </li>`;
                }).join('');
            
            preview.innerHTML = `
                <div class="result-container">
                    <div class="cover">
                        <div class="cover-line"></div>
                        <div class="cover-symbol">ÂëΩ</div>
                        <div class="cover-brand">LISTEN TO DESTINY</div>
                        <h1>Ïö¥Î™ÖÏùÑ Îì£Îã§</h1>
                        <p class="subtitle">ÏÇ¨Ï£ºÎ™ÖÎ¶¨ Í∞êÏ†ïÏÑú</p>
                        <div class="cover-divider"></div>
                        <div class="cover-user">
                            <div class="pkg-label">${pkgLabels[metaData.package] || '‚ú¶ SAJU REPORT ‚ú¶'}</div>
                            <div class="name">${metaData.name || 'Í≥†Í∞ù'}</div>
                            <div class="birth">${metaData.birthDate || ''}</div>
                            <div class="saju">${metaData.saju || ''}</div>
                        </div>
                        <div class="cover-line" style="margin-top:30px"></div>
                    </div>
                    
                    <!-- Î™©Ï∞® ÌéòÏù¥ÏßÄ -->
                    <div class="toc-page">
                        <div class="page-title">
                            <h2>üìú Î™©Ï∞®</h2>
                            <div class="pkg-name">${pkgLabels[metaData.package]?.replace(/[‚ú¶‚òÖ‚óÜ]/g, '').trim() || 'SAJU REPORT'}</div>
                        </div>
                        <ul class="toc-list">${tocHTML}</ul>
                        <p style="text-align:center;font-size:11px;color:#8b7355;margin-top:12px;">‚Äª Ìï≠Î™©ÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥ Ìï¥Îãπ ÏÑπÏÖòÏúºÎ°ú Ïù¥ÎèôÌï¥Ïöî<br><span style="color:#aaa;">(Îã§Ïö¥Î°úÎìú ÌõÑÏóêÎäî ÏûëÎèôÌïòÏßÄ ÏïäÏïÑÏöî)</span></p>
                    </div>
                    
                    <div class="divider">‚ú¶</div>
                    
                    <!-- Ï†ïÏùò ÌéòÏù¥ÏßÄ -->
                    <div class="def-page">
                        <div class="page-title">üìñ ÏÇ¨Ï£º Ïö©Ïñ¥ Í∞ÄÏù¥Îìú</div>
                        <div class="def-item">
                            <div class="term"><span class="icon">üåå</span> ÏÇ¨Ï£º(ÂõõÊü±)ÎûÄ?</div>
                            <div class="desc">ÌÉúÏñ¥ÎÇú <b>ÎÖÑ, Ïõî, Ïùº, Ïãú</b>Î°ú ÎßåÎì† ÎÑ§ Í∞úÏùò Í∏∞Îë•Ïù¥ÏóêÏöî.<br>Ï¥ù 8Í∏ÄÏûêÎ°ú Ïù¥Î£®Ïñ¥Ï†∏ ÏûàÍ≥†, Ïù¥ ÏïàÏóê ÎÇ¥ ÌÉÄÍ≥†ÎÇú ÏÑ±Í≤©Í≥º Ïö¥Ïù¥ Îã¥Í≤® ÏûàÏñ¥Ïöî.</div>
                        </div>
                        <div class="def-item">
                            <div class="term"><span class="icon">‚òÄÔ∏è</span> ÏùºÍ∞Ñ(Êó•Âπ≤)Ïù¥ÎûÄ?</div>
                            <div class="desc"><b>'ÎÇò'Î•º ÎåÄÌëúÌïòÎäî Ìïú Í∏ÄÏûê</b>ÏòàÏöî.<br>ÏÇ¨Ï£ºÏóêÏÑú Í∞ÄÏû• Ï§ëÏöîÌïú Í∏ÄÏûêÎ°ú, ÎÇ¥ ÏÑ±Í≤©Ïùò ÌïµÏã¨ÏùÑ Î≥¥Ïó¨Ï§òÏöî.</div>
                        </div>
                        <div class="def-item">
                            <div class="term"><span class="icon">üîÆ</span> Ïã≠ÏÑ±(ÂçÅÊòü)Ïù¥ÎûÄ?</div>
                            <div class="desc">ÎÇòÏôÄ Îã§Î•∏ Í∏ÄÏûêÎì§Ïùò <b>Í¥ÄÍ≥Ñ</b>Î•º Î≥¥Ïó¨Ï§òÏöî.<br>Îèà, ÏßÅÏû•, Ïó∞Ïï†, Í∞ÄÏ°± Îì± ÏÇ∂Ïùò Í∞Å ÏòÅÏó≠Ïù¥ Ïñ¥ÎñªÍ≤å ÌùòÎü¨Í∞ÄÎäîÏßÄ Ïïå Ïàò ÏûàÏñ¥Ïöî.</div>
                        </div>
                        <div class="def-item">
                            <div class="term"><span class="icon">üåø</span> Ïò§Ìñâ(‰∫îË°å)Ïù¥ÎûÄ?</div>
                            <div class="desc"><b>ÎÇòÎ¨¥, Î∂à, Ìùô, Ïá†, Î¨º</b> ‚Äî Îã§ÏÑØ Í∞ÄÏßÄ ÏóêÎÑàÏßÄÏòàÏöî.<br>Ïù¥ ÏóêÎÑàÏßÄÍ∞Ä ÏñºÎßàÎÇò ÏûàÎäîÏßÄÏóê Îî∞Îùº ÏÑ±Í≤©Í≥º Ïö¥Ïù¥ Îã¨ÎùºÏ†∏Ïöî.</div>
                        </div>
                        <div class="def-item">
                            <div class="term"><span class="icon">üåä</span> ÎåÄÏö¥(Â§ßÈÅã)Ïù¥ÎûÄ?</div>
                            <div class="desc"><b>10ÎÖÑÎßàÎã§ Î∞îÎÄåÎäî Ïù∏ÏÉùÏùò ÌÅ∞ ÌùêÎ¶Ñ</b>Ïù¥ÏóêÏöî.<br>ÏÇ¨Ï£ºÍ∞Ä 'ÎÇ¥ ÏÑ±Í≤©'Ïù¥ÎùºÎ©¥, ÎåÄÏö¥ÏùÄ 'Ïñ∏Ï†ú Î¨¥Ïä® ÏùºÏù¥ Ïò¨ÏßÄ' ÏïåÎ†§Ï£ºÎäî ÏãúÍ∞ÑÌëúÏòàÏöî.</div>
                        </div>
                    </div>
                    
                    <div class="divider">‚ú¶</div>
                    
                    <!-- Ïù∏Ìä∏Î°ú ÌéòÏù¥ÏßÄ -->
                    <div class="intro-page">
                        <div class="intro-header">
                            <div class="icon">üîÆ</div>
                            <h2>Î™ÖÎ¶¨¬∑Ï£ºÏó≠ ÌÜµÌï© Ïö¥Î™Ö ÏÑ§Í≥Ñ Î¶¨Ìè¨Ìä∏</h2>
                            <p>Î™ÖÎ¶¨Ìïô¬∑Ï£ºÏó≠¬∑ÏÑ±Î™ÖÌïôÏùÑ Í∏∞Î∞òÏúºÎ°ú Ìïú<br>ÎßûÏ∂§ Ïö¥Î™Ö ÏÑ§Í≥Ñ Î¶¨Ìè¨Ìä∏ÏûÖÎãàÎã§.</p>
                            <p style="margin-top:12px;">ÏÇ¨Ï£ºÏùò Í∏∞Ïö¥, Ï£ºÏó≠Ïùò ÏãúÏö¥, ÏÑ±Î™ÖÌïôÏùò Î≥¥ÏôÑÍπåÏßÄ<br>'Ïö¥Ïùò Î∞©Ìñ• + Ïã§Ìñâ ÌÉÄÏù¥Î∞ç'ÏùÑ Ìï®Íªò Ï†úÏãúÌï©ÎãàÎã§.</p>
                            <p style="margin-top:12px;">ÎãπÏã†ÏóêÍ≤å ÎßûÎäî ÏãúÍ∏∞, Í≥µÍ∞Ñ, Ïù¥Î¶ÑÏùò ÏßÑÎèôÏùÑ<br>Ï†ÑÎ¨∏Í∞ÄÍ∞Ä Ï¢ÖÌï© Î∂ÑÏÑùÌñàÏñ¥Ïöî.</p>
                        </div>
                        <div class="intro-body">
                            <div class="moon-section">
                                <div class="moon-title">üåô Ïù¥ Î¶¨Ìè¨Ìä∏Î•º ÏùΩÍ∏∞ Ï†ÑÏóê</div>
                                <p class="moon-text">ÏÇ¨Ï£ºÎäî ÎãπÏã†Ïù¥ ÌÉúÏñ¥ÎÇ† Îïå ÌíàÏùÄ ÏóêÎÑàÏßÄÏùò ÏÉâÍπîÏù¥ÏóêÏöî.<br>ÌïòÏßÄÎßå Í∑∏ ÏÉâÏù¥ Ïñ¥ÎñªÍ≤å ÏÑûÏù¥Í≥†, ÏñºÎßàÎÇò ÎπõÎÇòÎäîÏßÄÎäî<br>ÎãπÏã†Ïù¥ ÎßåÎì§Ïñ¥Í∞ÄÎäî Ïù¥ÏïºÍ∏∞Î°ú ÏôÑÏÑ±ÎèºÏöî.</p>
                                <p class="moon-text" style="margin-top:15px;">Í∑∏ÎûòÏÑú Ïù¥ Í∏Ä ÏÜçÏóêÎäî<br>'ÏßÄÍ∏àÏùò ÎÇò'ÏôÄ Íº≠ ÎßûÎäî Î∂ÄÎ∂ÑÎèÑ ÏûàÍ≥†,<br>'ÏïÑÏßÅÏùÄ ÎÇØÏÑ† ÎØ∏ÎûòÏùò ÎÇò'Í∞Ä Îã¥Í∏¥ Î∂ÄÎ∂ÑÎèÑ ÏûàÏùÑ Í±∞ÏòàÏöî.</p>
                                <p class="moon-text" style="margin-top:15px;">ÏÇ¨Ï£ºÎäî ÏòàÏñ∏Ïù¥ ÏïÑÎãàÎùº,<br>ÎÇòÎ•º Îçî Ïûò Ïù¥Ìï¥ÌïòÍ∏∞ ÏúÑÌïú Ïñ∏Ïñ¥ÏûÖÎãàÎã§.</p>
                            </div>
                            <div class="leaf-note">üåø Î™ÖÎ¶¨ÌïôÏ†ÅÏúºÎ°ú ÏÇ¨Ï£ºÎäî "Í∏∞ÏßàÏùò ÏÑ§Í≥ÑÎèÑ"Î•º Î≥¥Ïó¨Ï£ºÏßÄÎßå,<br>ÌôòÍ≤ΩÍ≥º Í≤ΩÌóò, ÎÖ∏Î†•Ïóê Îî∞Îùº Í∞ôÏùÄ ÏÇ¨Ï£ºÎùºÎèÑ Ï†ÑÌòÄ Îã§Î•∏ ÏÇ∂ÏùÑ ÏÇ¥ Ïàò ÏûàÏäµÎãàÎã§.<br>Í∑∏Îü¨Îãà Ïù¥ Î¶¨Ìè¨Ìä∏Î•º ÎÇòÏùò Í∞ÄÎä•ÏÑ±ÏùÑ ÎπÑÏ∂∞Î≥¥Îäî Í±∞Ïö∏Î°ú ÏùΩÏñ¥Ï£ºÏÑ∏Ïöî.</div>
                        </div>
                        <div class="intro-notice">‚Äª Î≥∏ Î¶¨Ìè¨Ìä∏Îäî Ï†ÑÌÜµ Î™ÖÎ¶¨ÌïôÍ≥º ÌòÑÎåÄ Ï£ºÏó≠ Ïù¥Î°†ÏùÑ Î∞îÌÉïÏúºÎ°ú ÏûëÏÑ±ÎêòÏóàÏúºÎ©∞,<br>Í∞úÏù∏Ïùò Ìï¥ÏÑùÍ≥º ÏÑ†ÌÉùÏóê Îî∞Îùº ÌòÑÏã§Ïùò Í≤∞Í≥ºÎäî Îã¨ÎùºÏßà Ïàò ÏûàÏäµÎãàÎã§.</div>
                    </div>
                    
                    <div class="hero-card" style="background:${info.color}">
                        <div class="label">ÎÇòÏùò Î≥∏Ïßà ¬∑ Êó•Âπ≤</div>
                        <div class="ilgan-char">${ilgan}</div>
                        <div class="ilgan-name">${info.name}</div>
                        <div class="ilgan-desc">${info.desc}</div>
                    </div>
                    
                    <div class="section-divider" id="section-overview"><span class="num">‚ú¶</span><span class="title">Í∞ú Ïöî</span></div>
                    
                    <div class="section">
                        <div class="section-header"><div class="section-icon">ÂëΩ</div><h2>ÏÇ¨Ï£º Î™ÖÏãù</h2></div>
                        <div class="section-def">
                            <div class="section-def-title"><span class="icon">üìñ</span> ÏÇ¨Ï£º Î™ÖÏãùÏù¥ÎûÄ?</div>
                            <div class="section-def-content">
                                ÌÉúÏñ¥ÎÇú <strong>ÎÖÑ¬∑Ïõî¬∑Ïùº¬∑Ïãú</strong>Î•º Ï≤úÍ∞Ñ(ÌïòÎäò)Í≥º ÏßÄÏßÄ(ÎïÖ)Ïùò ÌïúÏûêÎ°ú ÌëúÌòÑÌïú Í≤ÉÏù¥ÏóêÏöî. Ï¥ù 8Í∏ÄÏûêÎùºÏÑú <strong>'ÏÇ¨Ï£ºÌåîÏûê'</strong>ÎùºÍ≥† Î∂àÎü¨Ïöî.
                                <div class="section-def-grid">
                                    <div class="section-def-item"><strong>Ïó∞Ï£º(Âπ¥Êü±)</strong>ÌÉúÏñ¥ÎÇú Ìï¥ ¬∑ Ï°∞ÏÉÅ/ÏÇ¨ÌöåÏö¥</div>
                                    <div class="section-def-item"><strong>ÏõîÏ£º(ÊúàÊü±)</strong>ÌÉúÏñ¥ÎÇú Îã¨ ¬∑ Î∂ÄÎ™®/ÏÑ±Ïû•ÌôòÍ≤Ω</div>
                                    <div class="section-def-item"><strong>ÏùºÏ£º(Êó•Êü±)</strong>ÌÉúÏñ¥ÎÇú ÎÇ† ¬∑ ÎÇò ÏûêÏã†/Î∞∞Ïö∞Ïûê</div>
                                    <div class="section-def-item"><strong>ÏãúÏ£º(ÊôÇÊü±)</strong>ÌÉúÏñ¥ÎÇú ÏãúÍ∞Ñ ¬∑ ÏûêÎÖÄ/ÎßêÎÖÑÏö¥</div>
                                </div>
                            </div>
                        </div>
                        <div class="saju-grid">
                            <div class="saju-pillar"><div class="pillar-label">ÏãúÏ£º</div><div class="heavenly ${getClass(h[0])}">${h[0]||''}</div><div class="earthly ${getClass(h[1])}">${h[1]||''}</div><div class="meaning">${metaData.ÏãúÏ£º?.sipsung||''}</div></div>
                            <div class="saju-pillar"><div class="pillar-label">ÏùºÏ£º</div><div class="heavenly ${getClass(d[0])}">${d[0]||''}</div><div class="earthly ${getClass(d[1])}">${d[1]||''}</div><div class="meaning">${metaData.ÏùºÏ£º?.sipsung||''}</div></div>
                            <div class="saju-pillar"><div class="pillar-label">ÏõîÏ£º</div><div class="heavenly ${getClass(m[0])}">${m[0]||''}</div><div class="earthly ${getClass(m[1])}">${m[1]||''}</div><div class="meaning">${metaData.ÏõîÏ£º?.sipsung||''}</div></div>
                            <div class="saju-pillar"><div class="pillar-label">Ïó∞Ï£º</div><div class="heavenly ${getClass(y[0])}">${y[0]||''}</div><div class="earthly ${getClass(y[1])}">${y[1]||''}</div><div class="meaning">${metaData.Ïó∞Ï£º?.sipsung||''}</div></div>
                        </div>
                    </div>
                    
                    <div class="oheng-card">
                        <div class="section-header"><div class="section-icon">Ë°å</div><h2>Ïò§Ìñâ Î∂ÑÌè¨</h2></div>
                        <div class="section-def">
                            <div class="section-def-title"><span class="icon">üåø</span> Ïò§ÌñâÏù¥ÎûÄ?</div>
                            <div class="section-def-content">
                                ÏÑ∏ÏÉÅ ÎßåÎ¨ºÏùÑ Ïù¥Î£®Îäî <strong>5Í∞ÄÏßÄ Í∏∞Ïö¥</strong>Ïù¥ÏóêÏöî. ÎÇ¥ ÏÇ¨Ï£ºÏóê Ïñ¥Îñ§ Ïò§ÌñâÏù¥ ÎßéÍ≥† Ï†ÅÏùÄÏßÄÎ°ú ÏÑ±Í≤©Í≥º Ï†ÅÏÑ±ÏùÑ Ïïå Ïàò ÏûàÏñ¥Ïöî.
                                <div class="section-def-grid col-5">
                                    <div class="section-def-item"><strong>Êú® Î™©</strong>ÏÑ±Ïû•</div>
                                    <div class="section-def-item"><strong>ÁÅ´ Ìôî</strong>Ïó¥Ï†ï</div>
                                    <div class="section-def-item"><strong>Âúü ÌÜ†</strong>ÏïàÏ†ï</div>
                                    <div class="section-def-item"><strong>Èáë Í∏à</strong>Í≤∞Îã®</div>
                                    <div class="section-def-item"><strong>Ê∞¥ Ïàò</strong>ÏßÄÌòú</div>
                                </div>
                            </div>
                        </div>
                        <div class="oheng-bar-list">
                            ${ohengBar('Î™©','Êú®','wood',ohengValues.wood,maxOheng,sipsung.wood)}
                            ${ohengBar('Ìôî','ÁÅ´','fire',ohengValues.fire,maxOheng,sipsung.fire)}
                            ${ohengBar('ÌÜ†','Âúü','earth',ohengValues.earth,maxOheng,sipsung.earth)}
                            ${ohengBar('Í∏à','Èáë','metal',ohengValues.metal,maxOheng,sipsung.metal)}
                            ${ohengBar('Ïàò','Ê∞¥','water',ohengValues.water,maxOheng,sipsung.water)}
                        </div>
                        ${ohengWarning(ohengValues, sipsung)}
                        <div class="section-def" style="margin-top: 20px;">
                            <div class="section-def-title"><span class="icon">‚≠ê</span> Ïã≠ÏÑ±Ïù¥ÎûÄ?</div>
                            <div class="section-def-content">
                                ÏùºÍ∞Ñ(ÎÇò)ÏùÑ Í∏∞Ï§ÄÏúºÎ°ú Îã§Î•∏ Í∏ÄÏûêÎì§Í≥ºÏùò <strong>Í¥ÄÍ≥Ñ</strong>Î•º ÎÇòÌÉÄÎÇ∏ Í≤ÉÏù¥ÏóêÏöî. Ïñ¥Îñ§ Ïã≠ÏÑ±Ïù¥ ÎßéÏùÄÏßÄÎ°ú ÏÑ±Í≤©Í≥º ÏÇ∂Ïùò Ìå®ÌÑ¥ÏùÑ Ïïå Ïàò ÏûàÏñ¥Ïöî.
                                <div class="section-def-grid col-5">
                                    <div class="section-def-item"><strong>ÎπÑÍ≤Å</strong>ÏûêÏ°¥Ïã¨</div>
                                    <div class="section-def-item"><strong>ÏãùÏÉÅ</strong>Ï∞ΩÏùòÎ†•</div>
                                    <div class="section-def-item"><strong>Ïû¨ÏÑ±</strong>ÌòÑÏã§Í∞ê</div>
                                    <div class="section-def-item"><strong>Í¥ÄÏÑ±</strong>Ï±ÖÏûÑÍ∞ê</div>
                                    <div class="section-def-item"><strong>Ïù∏ÏÑ±</strong>ÌïôÏäµÎ†•</div>
                                </div>
                            </div>
                        </div>
                        <div class="oheng-bar-list" style="margin-top: 15px;">
                            ${sipsungBar('ÎπÑÍ≤Å','ÊØî','bigyeop',sipsungValues.bigyeop,maxSipsung)}
                            ${sipsungBar('ÏãùÏÉÅ','È£ü','siksang',sipsungValues.siksang,maxSipsung)}
                            ${sipsungBar('Ïû¨ÏÑ±','Ë≤°','jaeseong',sipsungValues.jaeseong,maxSipsung)}
                            ${sipsungBar('Í¥ÄÏÑ±','ÂÆò','gwanseong',sipsungValues.gwanseong,maxSipsung)}
                            ${sipsungBar('Ïù∏ÏÑ±','Âç∞','inseong',sipsungValues.inseong,maxSipsung)}
                        </div>
                    </div>
                    
                    ${metaData.gyeokguk ? `
                    <div class="gyeokguk-card">
                        <div class="section-header"><div class="section-icon">Ê†º</div><h2>Í≤©Íµ≠ & Ïö©Ïã†</h2></div>
                        <div class="section-def">
                            <div class="section-def-title"><span class="icon">‚öñÔ∏è</span> Í≤©Íµ≠Í≥º Ïö©Ïã†, Ïôú Î¥êÏïº Ìï†ÍπåÏöî?</div>
                            <div class="section-def-content">
                                <strong>Í≤©Íµ≠</strong>ÏùÄ ÎÇ¥ ÏÇ¨Ï£ºÏùò ÌÅ∞ ÌãÄ(Ïú†Ìòï)Ïù¥Í≥†, <strong>Ïö©Ïã†</strong>ÏùÄ ÎÇ¥ ÏÇ¨Ï£ºÏóêÏÑú Î∂ÄÏ°±ÌïòÍ±∞ÎÇò ÌïÑÏöîÌïú Í∏∞Ïö¥Ïù¥ÏóêÏöî. Ïù¥Í±∏ ÏïåÎ©¥ <strong>Ïñ¥Îñ§ ÌôòÍ≤Ω¬∑ÏÉâÏÉÅ¬∑Î∞©Ìñ•Ïù¥ ÎÇòÏóêÍ≤å Ïú†Î¶¨ÌïúÏßÄ</strong> Ïïå Ïàò ÏûàÏñ¥Ïöî.
                                <div class="section-def-grid">
                                    <div class="section-def-item"><strong>Í≤©Íµ≠</strong>ÏÇ¨Ï£ºÏùò Ïú†Ìòï¬∑ÏÑ±Ìñ• ÌãÄ</div>
                                    <div class="section-def-item"><strong>ÏùºÍ∞Ñ Í∞ïÏïΩ</strong>ÎÇ¥ Í∏∞Ïö¥Ïù¥ Í∞ïÌïúÏßÄ ÏïΩÌïúÏßÄ</div>
                                    <div class="section-def-item"><strong>Ïö©Ïã† ‚ú®</strong>Í∞ÄÏû• ÌïÑÏöîÌïú Í∏∞Ïö¥</div>
                                    <div class="section-def-item"><strong>Ìù¨Ïã† üëç</strong>Ïö©Ïã†ÏùÑ ÎèïÎäî Í∏∞Ïö¥</div>
                                    <div class="section-def-item"><strong>Í∏∞Ïã† ‚ö†Ô∏è</strong>ÌîºÌïòÎ©¥ Ï¢ãÏùÄ Í∏∞Ïö¥</div>
                                    <div class="section-def-item"><strong>Íµ¨Ïã† üö´</strong>Í∞ÄÏû• ÌîºÌï¥Ïïº Ìï† Í∏∞Ïö¥</div>
                                </div>
                            </div>
                        </div>
                        <div class="gyeokguk-main">
                            <div class="gyeokguk-label">Í≤©Íµ≠ ¬∑ Ïù∏ÏÉùÏùò ÌÅ∞ ÌãÄ</div>
                            <div class="gyeokguk-name">${metaData.gyeokguk}</div>
                            <div class="gyeokguk-strength">${metaData.strength || ''}</div>
                        </div>
                        <div class="yongsin-grid">
                            <div class="yongsin-item highlight">
                                <div class="yongsin-type">Ïö©Ïã† ‚ú®</div>
                                <div class="yongsin-value">${metaData.yongsin?.split(' - ')[0] || ''}</div>
                                <div class="yongsin-desc">${metaData.yongsin?.split(' - ')[1] || 'ÌïÑÏöîÌïú Í∏∞Ïö¥'}</div>
                            </div>
                            <div class="yongsin-item">
                                <div class="yongsin-type">Ìù¨Ïã† üëç</div>
                                <div class="yongsin-value">${metaData.huisin?.split(' - ')[0] || ''}</div>
                                <div class="yongsin-desc">${metaData.huisin?.split(' - ')[1] || 'ÎèÑÏõÄÎêòÎäî Í∏∞Ïö¥'}</div>
                            </div>
                            <div class="yongsin-item caution">
                                <div class="yongsin-type">Í∏∞Ïã† ‚ö†Ô∏è</div>
                                <div class="yongsin-value">${metaData.gisin?.split(' - ')[0] || ''}</div>
                                <div class="yongsin-desc">${metaData.gisin?.split(' - ')[1] || 'ÌîºÌï¥Ïïº Ìï† Í∏∞Ïö¥'}</div>
                            </div>
                            <div class="yongsin-item caution">
                                <div class="yongsin-type">Íµ¨Ïã† üö´</div>
                                <div class="yongsin-value">${metaData.gusin?.split(' - ')[0] || ''}</div>
                                <div class="yongsin-desc">${metaData.gusin?.split(' - ')[1] || 'Îçî ÌîºÌï¥Ïïº Ìï† Í∏∞Ïö¥'}</div>
                            </div>
                        </div>
                    </div>
                    ` : ''}
                    
                    <div class="divider">‚ú¶</div>
                    ${cards || '<div class="interpret-card"><div class="card-body"><p>Ìï¥ÏÑù ÎÇ¥Ïö©Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§.</p></div></div>'}
                    <div class="divider">‚ú¶</div>
                    
                    ${(() => {
                        // <!-- ÎßàÎ¨¥Î¶¨Î©òÌä∏ --> ÌÉúÍ∑∏ÏóêÏÑú Ï∂îÏ∂ú
                        const allText = pageData.map(p => p.content).join(' ');
                        const finalMatch = allText.match(/<!--\s*ÎßàÎ¨¥Î¶¨Î©òÌä∏\s*-->([\s\S]*?)<!--\s*\/ÎßàÎ¨¥Î¶¨Î©òÌä∏\s*-->/i);
                        let finalMsg = finalMatch ? finalMatch[1].trim() : '';
                        if (finalMsg) {
                            // ** Î≥ºÎìú Î≥ÄÌôò + Ï§ÑÎ∞îÍøà
                            finalMsg = finalMsg.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>').replace(/\n/g, '<br>');
                            return `<div class="final-card">
                                <div class="card-label">‚Äî Message for You ‚Äî</div>
                                <p class="text">${finalMsg}</p>
                                <div class="footer-text">‚Äî Ïö¥Î™ÖÏùÑ Îì£Îã§ ‚Äî</div>
                            </div>`;
                        } else {
                            return `<div class="final-card">
                                <div class="card-label">‚Äî Message for You ‚Äî</div>
                                <p class="text">${info.name} ÏùºÍ∞ÑÏúºÎ°ú ÌÉúÏñ¥ÎÇòÏã† Î∂ÑÏùÄ<br>ÏÑ∏ÏÉÅÏóê Íº≠ ÌïÑÏöîÌïú ÏóêÎÑàÏßÄÎ•º Í∞ÄÏßÄÍ≥† ÏûàÏäµÎãàÎã§.<br>ÎãπÏã†ÎßåÏùò ÎπõÏúºÎ°ú ÏÑ∏ÏÉÅÏùÑ Î∞ùÌòÄÏ£ºÏÑ∏Ïöî.</p>
                                <div class="divider-line"></div>
                                <p class="quote">"ÏßÄÍ∏à Ïù¥ ÏàúÍ∞ÑÎèÑ<br>ÎãπÏã†Ïùò Ïö¥Î™Ö ÏúÑÏóê ÏûàÏäµÎãàÎã§."</p>
                                <div class="footer-text">‚Äî Ïö¥Î™ÖÏùÑ Îì£Îã§ ‚Äî</div>
                            </div>`;
                        }
                    })()}
                    
                    <!-- Í≥†Ï†ï Î¨∏Íµ¨: ÌÜµÌï© ÎîîÏûêÏù∏ -->
                    <div class="closing-section">
                        <h4>ÏÇ¨Ï£º Í≤∞Í≥º, Ïñ¥Îñ†ÏÖ®ÎÇòÏöî?</h4>
                        <p>'Ïñ¥... Ïù¥Í±∞ ÎÇòÏù∏Îç∞?' Ïã∂ÏùÄ Î∂ÄÎ∂ÑÏù¥ ÏûàÎã§Î©¥<br>Ï∫°Ï≤òÌï¥ÏÑú ÌõÑÍ∏∞Î°ú ÎÇ®Í≤®Ï£ºÏÑ∏Ïöî</p>
                        <div class="divider"></div>
                        <p><strong>ÌõÑÍ∏∞ Ïù¥Î≤§Ìä∏</strong> ‚Äî ÎãπÍ∑º ÌõÑÍ∏∞ + Ïπ¥ÌÜ° Ï∫°Ï≤ò ‚Üí 30% Ìï†Ïù∏</p>
                        <p><strong>ÏπúÍµ¨ Ï∂îÏ≤ú</strong> ‚Äî "OOÎãò Ï∂îÏ≤ú" Î©òÏÖò ‚Üí Îëò Îã§ 5,000Ïõê Ìï†Ïù∏</p>
                        <div class="divider"></div>
                        <h4 style="margin-top:5px;">üíå Îçî Í∂ÅÍ∏àÌïú Ïù¥ÏïºÍ∏∞Í∞Ä ÏûàÏúºÏã†Í∞ÄÏöî?</h4>
                        <p>"Ïù¥Í±¥ Ï¢Ä Îçî ÏûêÏÑ∏Ìûà ÏïåÍ≥† Ïã∂Îã§"<br>"ÎÇ¥ ÏÉÅÌô©Ïóê ÎßûÍ≤å Î¨ºÏñ¥Î≥¥Í≥† Ïã∂Îã§" ÌïòÎäî Î∂ÄÎ∂ÑÏù¥ ÏûàÏúºÏÖ®Îã§Î©¥,<br>Ï∂îÍ∞Ä ÏßàÎ¨∏ÏùÑ Î≥¥ÎÇ¥Ï£ºÏÑ∏Ïöî.</p>
                        <p style="font-size:13px;color:#8b7355;">Î™ÖÎ¶¨¬∑Ï£ºÏó≠¬∑ÌÉùÏùºÏùò Í¥ÄÏ†êÏóêÏÑú Ï†ïÏÑ±Íªè ÎãµÎ≥ÄÎìúÎ¶¥Í≤åÏöî.</p>
                        <p><strong>‚ú¶ Ï∂îÍ∞Ä ÏßàÎ¨∏ ${pkgKey === 'light' ? '2' : pkgKey === 'standard' ? '5' : '10'}Í∞ú Ìè¨Ìï®</strong> (ÏÑúÎπÑÏä§ ÎÇ¥ ÌïúÏ†ï Î¨¥Î£å)<br>‚Üí Ïπ¥Ïπ¥Ïò§Ï±ÑÎÑêÎ°ú ÏßàÎ¨∏Ìï¥Ï£ºÏÑ∏Ïöî</p>
                        <div class="divider"></div>
                        <p>Ïó∞Ïï†Ïö¥¬∑Ïû¨Î¨ºÏö¥ ÌÖåÎßàÎ≥Ñ Ïã¨Ï∏µ Î¶¨Ìè¨Ìä∏ Ï§ÄÎπÑ Ï§ë!<br>Ï±ÑÎÑê Ï∂îÍ∞ÄÌïòÏãúÎ©¥ Ï∂úÏãú ÏïåÎ¶º Î≥¥ÎÇ¥ÎìúÎ¶¥Í≤åÏöî</p>
                        <div class="channel-box">
                            <span class="channel-badge">@unmyeong</span>
                        </div>
                        <p style="margin-top:20px;font-size:12px;color:#8b7355;">2027ÎÖÑ 2Ïõî, ÏÉàÌï¥ Ïö¥ÏÑ∏ÎèÑ Îã§Ïãú ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî</p>
                    </div>
                    
                    <div class="report-credit">Î≥∏ Î∂ÑÏÑùÏùÄ Î™ÖÎ¶¨¬∑Ï£ºÏó≠¬∑ÏÑ±Î™ÖÌïôÏùò ÌÜµÌï© Ìï¥ÏÑùÏùÑ Í∏∞Î∞òÏúºÎ°ú ÏûëÏÑ±ÎêòÏóàÏäµÎãàÎã§.</div>
                    
                    <div class="disclaimer">Î≥∏ Í∞êÏ†ïÏÑúÎäî Ï†ÑÌÜµ Î™ÖÎ¶¨Ìïô Ïù¥Î°†ÏùÑ Î∞îÌÉïÏúºÎ°ú Ìïú Ï∞∏Í≥† ÏûêÎ£åÏù¥Î©∞,<br>ÏùòÌïôÏ†Å ÏßÑÎã®Ïù¥ÎÇò Î≤ïÎ•†Ï†Å Ï°∞Ïñ∏ÏùÑ ÎåÄÏ≤¥ÌïòÏßÄ ÏïäÏäµÎãàÎã§.</div>
                    <div class="screenshot-guide">üì± Ïù¥ Í≤∞Í≥ºÍ∞Ä ÎßàÏùåÏóê ÎìúÏÖ®Îã§Î©¥ Ïä§ÌÅ¨Î¶∞ÏÉ∑ÏúºÎ°ú Ï†ÄÏû•Ìï¥Ï£ºÏÑ∏Ïöî</div>
                    
                    <div class="footer">
                        <div class="brand">Ïö¥Î™ÖÏùÑ Îì£Îã§</div>
                        <div class="divider-line"></div>
                        <p class="trust-text">Î≥∏ Í∞êÏ†ïÏÑúÎäî Ï†ÑÌÜµ Î™ÖÎ¶¨ Ïù¥Î°†ÏùÑ Î∞îÌÉïÏúºÎ°ú<br>Í∞úÏù∏ ÎßûÏ∂§ Î∂ÑÏÑùÎêòÏóàÏäµÎãàÎã§</p>
                        <p style="margin-top:12px;font-size:11px;opacity:0.6">¬© 2026 Ïö¥Î™ÖÏùÑ Îì£Îã§</p>
                    </div>
                </div>
            `;
        }
        
        // Ïö¥ÏÑ∏ Ïπ¥Îìú Î†åÎçîÎßÅ (2026ÎÖÑ)
        function renderFortuneCard(content) {
            // [ÏÉÅÎ∞òÍ∏∞] ‚≠ê‚≠ê‚≠ê | ÏÑ§Î™Ö ÌòïÏãù ÌååÏã±
            const firstMatch = content.match(/\[ÏÉÅÎ∞òÍ∏∞\]\s*([‚≠êüå±üå∏]+)\s*[|\-]?\s*(.+)/);
            const secondMatch = content.match(/\[ÌïòÎ∞òÍ∏∞\]\s*([‚≠êüå±üå∏]+)\s*[|\-]?\s*(.+)/);
            
            const firstRating = firstMatch ? firstMatch[1] : 'üå±üå±üå±';
            const firstDesc = firstMatch ? firstMatch[2].trim() : 'Ï§ÄÎπÑÏùò ÏãúÍ∞Ñ';
            const secondRating = secondMatch ? secondMatch[1] : 'üå∏üå∏üå∏üå∏';
            const secondDesc = secondMatch ? secondMatch[2].trim() : 'Í≤∞Ïã§Ïùò Í∏∞Ïö¥';
            
            // Î≥∏Î¨∏ ÌÖçÏä§Ìä∏ (ÏÉÅÎ∞òÍ∏∞/ÌïòÎ∞òÍ∏∞ Ï§Ñ Ï†úÏô∏)
            const bodyText = content.replace(/\[ÏÉÅÎ∞òÍ∏∞\].+/g, '').replace(/\[ÌïòÎ∞òÍ∏∞\].+/g, '').trim();
            
            return `
                <div class="fortune-card">
                    <div class="card-title">üêç <span class="year">‰∏ôÂçàÂπ¥</span> 2026ÎÖÑ Ïö¥ÏÑ∏</div>
                    <div class="fortune-flow">
                        <div class="fortune-half">
                            <div class="period">ÏÉÅÎ∞òÍ∏∞</div>
                            <div class="rating">${firstRating}</div>
                            <div class="desc">${firstDesc}</div>
                        </div>
                        <div class="fortune-half">
                            <div class="period">ÌïòÎ∞òÍ∏∞</div>
                            <div class="rating">${secondRating}</div>
                            <div class="desc">${secondDesc}</div>
                        </div>
                    </div>
                    <p class="fortune-text">${convertHTML(bodyText)}</p>
                </div>
            `;
        }
        
        // ÏõîÎ≥Ñ Ïö¥ÏÑ∏ Î†åÎçîÎßÅ
        function renderMonthlySection(content) {
            // [1Ïõî] ÌÇ§ÏõåÎìú | ‚≠ê‚≠ê‚≠ê | ÏÑ§Î™Ö ÌòïÏãù ÌååÏã±
            const monthPattern = /\[(\d+)Ïõî\]\s*([^|‚≠ê]+)\s*[|\s]*([‚≠ê]+)?\s*[|\s]*(.+)?/g;
            let items = '';
            let match;
            
            while ((match = monthPattern.exec(content)) !== null) {
                const month = match[1];
                const keyword = match[2].trim();
                const rating = match[3] || '‚≠ê‚≠ê‚≠ê';
                const text = match[4] ? match[4].trim() : '';
                
                items += `
                    <div class="monthly-item">
                        <div class="month-header">
                            <span class="month-num">${month}Ïõî</span>
                            <span class="month-keyword">${keyword}</span>
                            <span class="month-rating">${rating}</span>
                        </div>
                        ${text ? `<p class="month-text">${text}</p>` : ''}
                    </div>
                `;
            }
            
            if (!items) {
                // ÌòïÏãù Î™ª Ï∞æÏúºÎ©¥ ÏùºÎ∞ò Ïπ¥ÎìúÎ°ú
                return `<div class="interpret-card"><div class="card-header"><span class="emoji">üìÖ</span><h3>ÏõîÎ≥Ñ Ïö¥ÏÑ∏</h3></div><div class="card-body">${convertHTML(content)}</div></div>`;
            }
            
            return `
                <div class="section monthly-section">
                    <div class="section-header"><div class="section-icon">üìÖ</div><h2>ÏõîÎ≥Ñ Ïö¥ÏÑ∏</h2></div>
                    <div class="monthly-grid">${items}</div>
                </div>
            `;
        }
        
        // ÎåÄÏö¥ ÌÉÄÏûÑÎùºÏù∏ Î†åÎçîÎßÅ
        function renderDaeunSection(content) {
            // [2023~2032] ÊàäËæ∞ ÎåÄÏö¥ ‚Äî Ïû¨ÏÑ±Ïùò ÏãúÍ∏∞ | ÏÑ§Î™Ö ÌòïÏãù ÌååÏã±
            const daeunPattern = /\[(\d{4})[~\-](\d{4})\]\s*(.+?)\s*[|\n](.+?)(?=\[|$)/gs;
            let items = '';
            let match;
            let isFirst = true;
            
            while ((match = daeunPattern.exec(content)) !== null) {
                const period = `${match[1]}~${match[2]}`;
                const title = match[3].trim();
                const text = match[4].trim();
                
                items += `
                    <div class="daeun-item ${isFirst ? 'current' : ''}">
                        <div class="daeun-period">${period}</div>
                        <div class="daeun-content">
                            <div class="daeun-title">${title}</div>
                            <p class="daeun-text">${text}</p>
                        </div>
                    </div>
                `;
                isFirst = false;
            }
            
            if (!items) {
                return `<div class="interpret-card"><div class="card-header"><span class="emoji">üìà</span><h3>ÎåÄÏö¥ ÌùêÎ¶Ñ</h3></div><div class="card-body">${convertHTML(content)}</div></div>`;
            }
            
            return `
                <div class="section daeun-section">
                    <div class="section-header"><div class="section-icon">üìà</div><h2>ÎåÄÏö¥ ÌùêÎ¶Ñ</h2></div>
                    <div class="section-def">
                        <div class="section-def-title"><span class="icon">üåä</span> ÎåÄÏö¥Ïù¥ÎûÄ?</div>
                        <div class="section-def-content">
                            <strong>10ÎÖÑÎßàÎã§ Î∞îÎÄåÎäî Ïù∏ÏÉùÏùò ÌÅ∞ ÌùêÎ¶Ñ</strong>Ïù¥ÏóêÏöî. ÏÇ¨Ï£ºÍ∞Ä 'ÌÉÄÍ≥†ÎÇú ÏÑ±Í≤©'Ïù¥ÎùºÎ©¥, ÎåÄÏö¥ÏùÄ '<strong>Ïñ∏Ï†ú Ïñ¥Îñ§ ÏãúÍ∏∞Í∞Ä Ïò§ÎäîÏßÄ</strong>' ÏïåÎ†§Ï£ºÎäî ÏãúÍ∞ÑÌëúÏòàÏöî. ÌòÑÏû¨ ÎåÄÏö¥Ïù¥ Ïñ¥Îñ§ Í∏∞Ïö¥Ïù∏ÏßÄ Î≥¥Î©¥ ÏßÄÍ∏à ÏãúÍ∏∞Ïùò ÌäπÏßïÏùÑ Ïïå Ïàò ÏûàÏñ¥Ïöî.
                        </div>
                    </div>
                    <div class="daeun-timeline">${items}</div>
                </div>
            `;
        }
        
        // Í∑ÄÏù∏/Ïù∏Ïó∞ ÏÑπÏÖò Î†åÎçîÎßÅ
        function renderGwiinSection(content) {
            const goodMatch = content.match(/\[ÎÇòÎ•º\s*ÎèïÎäî\s*ÏÇ¨Îûå\](.+?)(?=\[Ï£ºÏùò|$)/s);
            const badMatch = content.match(/\[Ï£ºÏùòÌï†\s*Ïù∏Ïó∞\](.+?)(?=\[|$)/s);
            
            let cards = '';
            
            if (goodMatch) {
                cards += `
                    <div class="gwiin-card good">
                        <div class="gwiin-header"><span class="emoji">üòá</span><h4>ÎÇòÎ•º ÎèïÎäî ÏÇ¨Îûå</h4></div>
                        <p>${goodMatch[1].trim()}</p>
                    </div>
                `;
            }
            
            if (badMatch) {
                cards += `
                    <div class="gwiin-card bad">
                        <div class="gwiin-header"><span class="emoji">üòà</span><h4>Ï£ºÏùòÌï† Ïù∏Ïó∞</h4></div>
                        <p>${badMatch[1].trim()}</p>
                    </div>
                `;
            }
            
            if (!cards) {
                return `<div class="interpret-card"><div class="card-header"><span class="emoji">ü§ù</span><h3>Ïù∏Ïó∞Ïùò ÌùêÎ¶Ñ</h3></div><div class="card-body">${convertHTML(content)}</div></div>`;
            }
            
            return `
                <div class="section gwiin-section">
                    <div class="section-header"><div class="section-icon">ü§ù</div><h2>Ïù∏Ïó∞Ïùò ÌùêÎ¶Ñ</h2></div>
                    <div class="gwiin-grid">${cards}</div>
                </div>
            `;
        }
        
        function ohengBar(name, hanja, type, val, max, sip) {
            const pct = max > 0 ? Math.max((val / max) * 100, 8) : 0; // ÏµúÏÜå 8%
            const empty = val === 0;
            return `<div class="oheng-bar-item"><div class="oheng-bar-label"><div class="oheng-bar-icon ${type}-bg ${empty?'empty':''}">${hanja}</div><span class="oheng-bar-name">${name}</span></div><div class="oheng-bar-track">${empty ? '<span class="oheng-bar-empty-text">ÏóÜÏùå</span>' : `<div class="oheng-bar-fill ${type}-fill" style="width:${pct}%"></div>`}</div><div class="oheng-bar-right"><span class="oheng-bar-value">${empty ? '-' : val}</span><span class="oheng-bar-info">${sip}</span></div></div>`;
        }
        
        function ohengWarning(v, s) {
            const n = { wood:'Î™©(Êú®)', fire:'Ìôî(ÁÅ´)', earth:'ÌÜ†(Âúü)', metal:'Í∏à(Èáë)', water:'Ïàò(Ê∞¥)' };
            const w = Object.entries(v).filter(([k,val])=>val===0).map(([k])=>`<strong>${n[k]} ${s[k]}Ïù¥ ÏóÜÏäµÎãàÎã§.</strong>`);
            return w.length ? `<div class="oheng-warning"><div class="icon">‚ö†Ô∏è</div><div class="text">${w.join('<br>')}</div></div>` : '';
        }
        
        function sipsungBar(name, hanja, type, val, max) {
            const pct = max > 0 ? Math.max((val / max) * 100, 8) : 0;
            const empty = val === 0;
            const colors = { bigyeop: '#6B8E23', siksang: '#CD853F', jaeseong: '#DAA520', gwanseong: '#4682B4', inseong: '#9370DB' };
            const descs = { bigyeop: 'ÏûêÏ°¥Ïã¨¬∑ÎèôÎ£å', siksang: 'ÌëúÌòÑ¬∑Ïû¨Îä•', jaeseong: 'Ïû¨Î¨º¬∑ÌòÑÏã§', gwanseong: 'Î™ÖÏòà¬∑Ï±ÖÏûÑ', inseong: 'ÌïôÏäµ¬∑Î≥¥Ìò∏' };
            return `<div class="oheng-bar-item"><div class="oheng-bar-label"><div class="oheng-bar-icon" style="background:${colors[type]};${empty?'opacity:0.4;':''}">${hanja}</div><span class="oheng-bar-name">${name}</span></div><div class="oheng-bar-track">${empty ? '<span class="oheng-bar-empty-text">ÏóÜÏùå</span>' : `<div class="oheng-bar-fill" style="width:${pct}%;background:${colors[type]}"></div>`}</div><div class="oheng-bar-right"><span class="oheng-bar-value">${empty ? '-' : val}</span><span class="oheng-bar-info">${descs[type]}</span></div></div>`;
        }
        
        function getEmoji(t) {
            const m = { 'ÏùºÍ∞Ñ':'üå≥','Ïò§Ìñâ':'‚òØÔ∏è','ÏÑ±Í≤©':'üé≠','Ïó∞Ïï†':'üíï','ÏßÅÏóÖ':'üíº','Ïû¨Î¨º':'üí∞','Í±¥Í∞ï':'üè•','2026':'üêç','Ïö¥ÏÑ∏':'üåü','ÏõîÎ≥Ñ':'üìÖ','ÎåÄÏö¥':'üåä','Î≤àÏïÑÏõÉ':'üî•','Í∑†Ìòï':'üî•','Í∑ÄÏù∏':'ü§ù','Ï°∞Ïñ∏':'‚ú®','ÎßàÎ¨¥Î¶¨':'üôè','ÏßàÎ¨∏':'üí¨','Ï†ÅÏÑ±':'üíº','Ïã¨Î¶¨':'üß†',
                // V3 Ï∂îÍ∞Ä
                'Ïù¥Î¶Ñ':'üí´','ÏÑ±Î™Ö':'üí´','Ï£ºÏó≠':'üîÆ','Î∞©Ìñ•':'üîÆ','ÌÉùÏùº':'üìÖ','ÌÉÄÏù¥Î∞ç':'üìÖ','Í¥ÄÏÉÅ':'üé®','Ïô∏Ìòï':'üé®','ÌíçÏàò':'üè†','Í≥µÍ∞Ñ':'üè†'
            };
            for (const [k,e] of Object.entries(m)) if (t.includes(k)) return e;
            return 'üìå';
        }
        
        // ‚òÖ Î∞ïÏä§ ÎÇ¥Î∂Ä ÎßàÌÅ¨Îã§Ïö¥ ÌååÏã± Ìó¨Ìçº Ìï®Ïàò
        function parseBoxContent(c) {
            return c.trim()
                .replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
                .replace(/\*([^*\n]+)\*/g, '<em>$1</em>')
                .replace(/^‚ú¶\s*(.+)$/gm, '<span style="color:#d4af82;">‚ú¶</span> $1')
                .replace(/^(\d+)\.\s+(.+)$/gm, '<span style="color:#d4af82;font-weight:600;">$1.</span> $2')
                .replace(/^>\s*(.+)$/gm, '<span style="font-style:italic;color:#6b5744;">"$1"</span>')
                .replace(/^-{3,}$/gm, '<hr style="border:none;border-top:1px dashed #d4c5a9;margin:15px 0;">')
                .replace(/\n/g, '<br>')
                // ‚òÖ Ïù¥Ïä§ÏºÄÏù¥ÌîÑ Îî∞Ïò¥Ìëú Ï†úÍ±∞ (\" ‚Üí ")
                .replace(/\\"/g, '"');
        }
        
        // Part 2 ÌòïÏãù ‚Üí HTML
        function convertHTML(text) {
            if (!text) return '';
            return text
                // ÌïµÏã¨ ÏöîÏïΩ Î∞ïÏä§Îäî ÌëúÏßÄÏóêÏÑú Ï≤òÎ¶¨ÎêòÎØÄÎ°ú Î≥∏Î¨∏ÏóêÏÑ† Ï†úÍ±∞
                .replace(/‚ú®\s*(\d{4})ÎÖÑ\s*ÌïµÏã¨\s*ÏöîÏïΩ[^\n]*\n([\s\S]*?)(?=\n-{3,}|\n#|$)/gi, '')
                // ÌÇ§ÏõåÎìú ÌÉúÍ∑∏
                .replace(/\[ÌÇ§ÏõåÎìú\]\s*(.+)/gi, (_, keywords) => {
                    const tags = keywords.split(/[,Ôºå„ÄÅ]/).map(k => `<span class="keyword-tag">${k.trim()}</span>`).join('');
                    return `<div class="keywords">${tags}</div>`;
                })
                // Part 2 Î∞ïÏä§Îì§ - ÏÉà ÌÉúÍ∑∏ ÌòïÏãù (ÌÖåÏù¥Î∏î Î≥ÄÌôòÏùÑ Î®ºÏ†Ä Ïã§ÌñâÌï¥Ïïº Ìï®)
                // ÌÖåÏù¥Î∏î Î≥ÄÌôò (Î∞ïÏä§ Î≥ÄÌôòÎ≥¥Îã§ Î®ºÏ†Ä!)
                .replace(/(\|[^\n]+\|\n?)+/g, function(table) {
                    const rows = table.trim().split('\n');
                    let html = '<div style="overflow-x:auto;"><table style="width:100%;min-width:300px;border-collapse:collapse;margin:15px 0;font-size:14px;">';
                    let isFirst = true;
                    const hexToColor = (text) => text.replace(/(#[A-Fa-f0-9]{6})/g, '<span style="display:inline-flex;align-items:center;gap:5px;"><span style="width:14px;height:14px;border-radius:50%;background:$1;border:1px solid #d4c5a9;"></span>$1</span>');
                    rows.forEach((row) => {
                        if (row.match(/^\|[\s\-:|]+\|$/)) return;
                        const cells = row.split('|').filter(c => c.trim() !== '');
                        if (cells.length === 0) return;
                        const tag = isFirst ? 'th' : 'td';
                        const style = isFirst 
                            ? 'style="padding:12px 10px;border-bottom:2px solid #d4af82;color:#4a3d30;font-weight:700;text-align:center;"'
                            : 'style="padding:10px;border-bottom:1px solid #e5dccb;color:#6b5744;text-align:center;"';
                        html += '<tr>' + cells.map(c => `<${tag} ${style}>${hexToColor(c.trim())}</${tag}>`).join('') + '</tr>';
                        isFirst = false;
                    });
                    return html + '</table></div>';
                })
                // Part 2 Î∞ïÏä§Îì§ - ‚òÖ ÎÇ¥Î∂Ä ÎßàÌÅ¨Îã§Ïö¥ÎèÑ ÌååÏã±!
                .replace(/<!--\s*ÏÜåÎ¶Ñ\s*-->([\s\S]*?)<!--\s*\/ÏÜåÎ¶Ñ\s*-->/gi, (_,c) => `<div class="goosebump-box"><div class="label">ÏÜåÎ¶Ñ Ìè¨Ïù∏Ìä∏</div><div class="quote">${parseBoxContent(c)}</div></div>`)
                .replace(/<!--\s*ÏôúÍ∑∏Îü∞ÏßÄ\s*-->([\s\S]*?)<!--\s*\/ÏôúÍ∑∏Îü∞ÏßÄ\s*-->/gi, (_,c) => `<div class="saju-box"><div class="label">ÏÇ¨Ï£º Ìï¥ÏÑù</div><p>${parseBoxContent(c)}</p></div>`)
                .replace(/<!--\s*Ï£ºÏùò\s*-->([\s\S]*?)<!--\s*\/Ï£ºÏùò\s*-->/gi, (_,c) => `<div class="caution-box"><div class="label">Ï£ºÏùò</div><p>${parseBoxContent(c)}</p></div>`)
                .replace(/<!--\s*Ï°∞Ïñ∏\s*-->([\s\S]*?)<!--\s*\/Ï°∞Ïñ∏\s*-->/gi, (_,c) => `<div class="advice-box"><div class="label">Ï°∞Ïñ∏</div><p>${parseBoxContent(c)}</p></div>`)
                .replace(/<!--\s*Ìù¨Îßù\s*-->([\s\S]*?)<!--\s*\/Ìù¨Îßù\s*-->/gi, (_,c) => `<div class="hope-box"><div class="label">ÎßàÎ¨¥Î¶¨</div><p>${parseBoxContent(c)}</p></div>`)
                .replace(/<!--\s*Í∞ïÏ†ê\s*-->([\s\S]*?)<!--\s*\/Í∞ïÏ†ê\s*-->/gi, (_,c) => `<div class="strength-box"><div class="label">Í∞ïÏ†ê</div><p>${parseBoxContent(c)}</p></div>`)
                // Í≥µÍ∞ê ÌÉúÍ∑∏
                .replace(/<!--\s*Í≥µÍ∞ê\s*-->([\s\S]*?)<!--\s*\/Í≥µÍ∞ê\s*-->/gi, (_,c) => `<div class="empathy-box"><div class="label">üíö Í≥µÍ∞ê Ìè¨Ïù∏Ìä∏</div><p>${parseBoxContent(c)}</p></div>`)
                // Ïò¨Ìï¥ÌïµÏã¨ ÌÉúÍ∑∏Îäî ÌëúÏßÄÏóêÏÑú Ï≤òÎ¶¨ÎêòÎØÄÎ°ú Î≥∏Î¨∏ÏóêÏÑ† Ï†úÍ±∞
                .replace(/<!--\s*Ïò¨Ìï¥ÌïµÏã¨\s*-->([\s\S]*?)<!--\s*\/Ïò¨Ìï¥ÌïµÏã¨\s*-->/gi, '')
                // ÎßàÎ¨¥Î¶¨Î©òÌä∏ ÌÉúÍ∑∏Îäî final-cardÏóêÏÑú ÏÇ¨Ïö©ÌïòÎØÄÎ°ú Î≥∏Î¨∏ÏóêÏÑú Ï†úÍ±∞
                .replace(/<!--\s*ÎßàÎ¨¥Î¶¨Î©òÌä∏\s*-->([\s\S]*?)<!--\s*\/ÎßàÎ¨¥Î¶¨Î©òÌä∏\s*-->/gi, '')
                // ‚òÖ [Ïù∏Ïó∞ÏÉÅ_Ïù¥ÎØ∏ÏßÄ_ÏÇΩÏûÖ] Ìå®ÌÑ¥ ‚Üí Ïù∏Ïó∞ÏÉÅ HTMLÏùÑ iframeÏúºÎ°ú ÏÇΩÏûÖ (CSS Ï∂©Îèå Î∞©ÏßÄ)
                .replace(/\[Ïù∏Ïó∞ÏÉÅ_Ïù¥ÎØ∏ÏßÄ_ÏÇΩÏûÖ\]/gi, () => {
                    let inyeonHtml = document.getElementById('inyeonHtmlInput')?.value?.trim();
                    if (inyeonHtml) {
                        console.log('[Ïù∏Ïó∞ÏÉÅ] ÏõêÎ≥∏ HTML Í∏∏Ïù¥:', inyeonHtml.length);
                        
                        // ‚òÖ 1. ÏõêÎ≥∏ style ÌÉúÍ∑∏ ÏôÑÏ†Ñ Ï†úÍ±∞!
                        inyeonHtml = inyeonHtml.replace(/<style[^>]*>[\s\S]*?<\/style>/gi, '');
                        
                        // ‚òÖ 2. Ïù∏ÎùºÏù∏ Ïä§ÌÉÄÏùº ÍµêÏ≤¥! (ÌïµÏã¨!)
                        inyeonHtml = inyeonHtml
                            .replace(/flex-wrap:\s*nowrap/gi, 'flex-wrap:wrap')
                            .replace(/gap:\s*20px/gi, 'gap:12px')
                            .replace(/padding:\s*30px/gi, 'padding:24px')
                            .replace(/max-width:\s*700px/gi, 'max-width:100%');
                        
                        // ‚òÖ 3. Î™®Î∞îÏùºÏö© CSS (Í≥†Ï†ï ÌÅ¨Í∏∞)
                        const mobileCSS = `<style>
html,body{margin:0;padding:0;background:transparent;}
.result-box{width:100%;max-width:100%;margin:0;padding:28px;background:rgba(255,255,255,0.03);border-radius:20px;border:1px solid rgba(255,255,255,0.05);font-family:'Noto Sans KR',sans-serif;box-sizing:border-box;box-shadow:none!important;}
.user-info{text-align:center;margin-bottom:15px;padding-bottom:12px;border-bottom:1px solid rgba(255,255,255,0.1);}
.user-info h2{font-size:16px;margin:0 0 6px 0;color:#e8e0d8;font-weight:400;}
.user-info p{font-size:11px;margin:0;color:rgba(255,255,255,0.6);}
.gender-group{display:block!important;width:100%!important;margin-bottom:25px!important;}.gender-label{text-align:center;margin-bottom:12px;color:#e8e0d8;font-size:14px;letter-spacing:2px;}.inyun-cards-container,.cards-row{display:flex!important;gap:12px!important;justify-content:center!important;flex-wrap:nowrap!important;padding:10px 5px!important;}
.card-wrapper{text-align:center;flex:0 0 auto!important;}
.card-label{color:#e8e0d8;font-size:12px;margin-bottom:8px;letter-spacing:1px;}
.card-label span{font-size:16px;margin-right:5px;}
.card{width:150px!important;height:240px!important;border-radius:16px;position:relative;overflow:hidden;box-shadow:none!important;}
.bg-glow{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100px;height:100px;border-radius:50%;filter:blur(35px);opacity:0.4;}
.stars{position:absolute;top:0;left:0;right:0;bottom:0;pointer-events:none;}
.star{position:absolute;width:2px;height:2px;background:#fff;border-radius:50%;opacity:0.6;}
.content{position:relative;z-index:10;height:100%;display:flex;flex-direction:column;align-items:center;padding:10px 8px;box-sizing:border-box;}
.element-label{font-size:9px;letter-spacing:2px;color:rgba(255,255,255,0.7)!important;opacity:1!important;margin-bottom:4px;}
.character-area{flex:1;display:flex;align-items:center;justify-content:center;position:relative;width:100%;}
.character-area svg{width:95px!important;height:auto!important;max-height:105px!important;}
.char-glow{position:absolute;width:70px;height:70px;border-radius:50%;filter:blur(25px);opacity:0.5;}
.info{text-align:center;margin-top:auto;}
.element-badge{width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 6px;font-size:13px;backdrop-filter:blur(10px);}
.element-name{font-size:11px;font-weight:500;margin-bottom:2px;color:#fff;}
.element-desc{font-size:8px;opacity:0.7;color:#fff;}
.napeum-info{margin-top:4px;font-size:7px;opacity:0.5;color:#fff;}
.card-Í∏à{background:linear-gradient(180deg,#2a2a3e 0%,#1e1e30 100%);}
.card-Í∏à .bg-glow{background:rgba(210,210,240,0.5);}
.card-Í∏à .char-glow{background:rgba(200,200,230,0.4);}
.card-Í∏à .element-badge{background:rgba(200,200,230,0.15);border:1px solid rgba(200,200,230,0.3);color:#e8e8f8;}
.card-Î™©{background:linear-gradient(180deg,#1a2e1a 0%,#152015 100%);}
.card-Î™© .bg-glow{background:rgba(120,200,120,0.5);}
.card-Î™© .char-glow{background:rgba(100,180,100,0.4);}
.card-Î™© .element-badge{background:rgba(100,180,100,0.15);border:1px solid rgba(100,180,100,0.3);color:#d0f0d0;}
.card-Ïàò{background:linear-gradient(180deg,#1a1a3e 0%,#151528 100%);}
.card-Ïàò .bg-glow{background:rgba(120,170,255,0.5);}
.card-Ïàò .char-glow{background:rgba(100,150,255,0.4);}
.card-Ïàò .element-badge{background:rgba(100,150,255,0.15);border:1px solid rgba(100,150,255,0.3);color:#d0e0ff;}
.card-Ìôî{background:linear-gradient(180deg,#2e1a1a 0%,#281515 100%);}
.card-Ìôî .bg-glow{background:rgba(255,140,120,0.5);}
.card-Ìôî .char-glow{background:rgba(255,120,100,0.4);}
.card-Ìôî .element-badge{background:rgba(255,120,100,0.15);border:1px solid rgba(255,120,100,0.3);color:#ffe0d8;}
.card-ÌÜ†{background:linear-gradient(180deg,#2a2518 0%,#1a1508 100%);}
.card-ÌÜ† .bg-glow{background:rgba(210,170,120,0.5);}
.card-ÌÜ† .char-glow{background:rgba(200,160,100,0.4);}
.card-ÌÜ† .element-badge{background:rgba(200,160,100,0.15);border:1px solid rgba(200,160,100,0.3);color:#f0e0c8;}
</style>`;
                        
                        const fullInyeonHtml = `<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">${mobileCSS}</head><body>${inyeonHtml}</body></html>`;
                        const encodedHtml = btoa(unescape(encodeURIComponent(fullInyeonHtml)));
                        
                        // ‚òÖ ÎëòÎã§ vs Îã®Ïùº ÏÑ±Î≥Ñ ÎÜíÏù¥ ÎèôÏ†Å ÏÑ§Ï†ï
                        const isBothGender = inyeonHtml.includes('gender-group');
                        const iframeHeight = isBothGender ? '900px' : '550px';
                        
                        return `<div class="inyeon-html-block" style="margin:30px 0;">
                            <iframe src="data:text/html;base64,${encodedHtml}" style="width:calc(100% + 30px);margin-left:-15px;height:${iframeHeight};border:none;border-radius:20px;overflow:hidden;" scrolling="no"></iframe>
                        </div>`;
                    } else {
                        console.log('[Ïù∏Ïó∞ÏÉÅ] HTML ÏóÜÏùå, placeholder ÌëúÏãú');
                        return `<div id="inyeon-image-placeholder" class="inyeon-html-block" style="margin:30px 0; text-align:center; padding:40px; background:#f9f6ef; border-radius:12px; border:2px dashed #d4af82;">
                            <p style="color:#8b7355; font-size:14px;">üì∏ Ïù∏Ïó∞ÏÉÅ Ïù¥ÎØ∏ÏßÄ ÏúÑÏπò</p>
                            <p style="color:#aaa; font-size:12px; margin-top:8px;">Step 4 Ïù∏Ïó∞ÏÉÅÏÉùÏÑ±Í∏∞ÏóêÏÑú HTMLÏùÑ Î≥µÏÇ¨Ìï¥ Î∂ôÏó¨ÎÑ£ÏúºÏÑ∏Ïöî</p>
                        </div>`;
                    }
                })
                // ‚òÖ Ïù∏Ïó∞ÏÉÅ HTML Î∏îÎ°ù (4_Ïù∏Ïó∞ÏÉÅÏÉùÏÑ±Í∏∞ÏóêÏÑú ÏûêÎèô ÏÇΩÏûÖÎêú Í≤É) iframeÏúºÎ°ú Ï≤òÎ¶¨
                .replace(/<!--\s*Ïù∏Ïó∞ÏÉÅ Ïù¥ÎØ∏ÏßÄ\s*\(ÏûêÎèô ÏÇΩÏûÖÎê®\)\s*-->\s*([\s\S]*?)(?=\n\n<!-- ÌéòÏù¥ÏßÄ|\n\n##|\n\n#|$)/gi, (_, block) => {
                    console.log('[Ïù∏Ïó∞ÏÉÅ] HTML Î∏îÎ°ù Î∞úÍ≤¨ (ÏûêÎèô ÏÇΩÏûÖ)');
                    
                    // ‚òÖ 1. ÏõêÎ≥∏ style ÌÉúÍ∑∏ ÏôÑÏ†Ñ Ï†úÍ±∞!
                    let cleanBlock = block.trim().replace(/<style[^>]*>[\s\S]*?<\/style>/gi, '');
                    
                    // ‚òÖ 2. Ïù∏ÎùºÏù∏ Ïä§ÌÉÄÏùº ÍµêÏ≤¥! (ÌïµÏã¨!)
                    cleanBlock = cleanBlock
                        .replace(/flex-wrap:\s*nowrap/gi, 'flex-wrap:wrap')
                        .replace(/gap:\s*20px/gi, 'gap:12px')
                        .replace(/padding:\s*30px/gi, 'padding:24px')
                        .replace(/max-width:\s*700px/gi, 'max-width:100%');
                    
                    // ‚òÖ 3. Î™®Î∞îÏùºÏö© CSS (Í≥†Ï†ï ÌÅ¨Í∏∞)
                    const mobileCSS = `<style>
html,body{margin:0;padding:0;background:transparent;}
.result-box{width:100%;max-width:100%;margin:0;padding:28px;background:rgba(255,255,255,0.03);border-radius:20px;border:1px solid rgba(255,255,255,0.05);font-family:'Noto Sans KR',sans-serif;box-sizing:border-box;box-shadow:none!important;}
.user-info{text-align:center;margin-bottom:15px;padding-bottom:12px;border-bottom:1px solid rgba(255,255,255,0.1);}
.user-info h2{font-size:16px;margin:0 0 6px 0;color:#e8e0d8;font-weight:400;}
.user-info p{font-size:11px;margin:0;color:rgba(255,255,255,0.6);}
.gender-group{display:block!important;width:100%!important;margin-bottom:25px!important;}.gender-label{text-align:center;margin-bottom:12px;color:#e8e0d8;font-size:14px;letter-spacing:2px;}.inyun-cards-container,.cards-row{display:flex!important;gap:12px!important;justify-content:center!important;flex-wrap:nowrap!important;padding:10px 5px!important;}
.card-wrapper{text-align:center;flex:0 0 auto!important;}
.card-label{color:#e8e0d8;font-size:12px;margin-bottom:8px;letter-spacing:1px;}
.card-label span{font-size:16px;margin-right:5px;}
.card{width:150px!important;height:240px!important;border-radius:16px;position:relative;overflow:hidden;box-shadow:none!important;}
.bg-glow{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100px;height:100px;border-radius:50%;filter:blur(35px);opacity:0.4;}
.stars{position:absolute;top:0;left:0;right:0;bottom:0;pointer-events:none;}
.star{position:absolute;width:2px;height:2px;background:#fff;border-radius:50%;opacity:0.6;}
.content{position:relative;z-index:10;height:100%;display:flex;flex-direction:column;align-items:center;padding:10px 8px;box-sizing:border-box;}
.element-label{font-size:9px;letter-spacing:2px;color:rgba(255,255,255,0.7)!important;opacity:1!important;margin-bottom:4px;}
.character-area{flex:1;display:flex;align-items:center;justify-content:center;position:relative;width:100%;}
.character-area svg{width:95px!important;height:auto!important;max-height:105px!important;}
.char-glow{position:absolute;width:70px;height:70px;border-radius:50%;filter:blur(25px);opacity:0.5;}
.info{text-align:center;margin-top:auto;}
.element-badge{width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 6px;font-size:13px;backdrop-filter:blur(10px);}
.element-name{font-size:11px;font-weight:500;margin-bottom:2px;color:#fff;}
.element-desc{font-size:8px;opacity:0.7;color:#fff;}
.napeum-info{margin-top:4px;font-size:7px;opacity:0.5;color:#fff;}
.card-Í∏à{background:linear-gradient(180deg,#2a2a3e 0%,#1e1e30 100%);}
.card-Í∏à .bg-glow{background:rgba(210,210,240,0.5);}
.card-Í∏à .char-glow{background:rgba(200,200,230,0.4);}
.card-Í∏à .element-badge{background:rgba(200,200,230,0.15);border:1px solid rgba(200,200,230,0.3);color:#e8e8f8;}
.card-Î™©{background:linear-gradient(180deg,#1a2e1a 0%,#152015 100%);}
.card-Î™© .bg-glow{background:rgba(120,200,120,0.5);}
.card-Î™© .char-glow{background:rgba(100,180,100,0.4);}
.card-Î™© .element-badge{background:rgba(100,180,100,0.15);border:1px solid rgba(100,180,100,0.3);color:#d0f0d0;}
.card-Ïàò{background:linear-gradient(180deg,#1a1a3e 0%,#151528 100%);}
.card-Ïàò .bg-glow{background:rgba(120,170,255,0.5);}
.card-Ïàò .char-glow{background:rgba(100,150,255,0.4);}
.card-Ïàò .element-badge{background:rgba(100,150,255,0.15);border:1px solid rgba(100,150,255,0.3);color:#d0e0ff;}
.card-Ìôî{background:linear-gradient(180deg,#2e1a1a 0%,#281515 100%);}
.card-Ìôî .bg-glow{background:rgba(255,140,120,0.5);}
.card-Ìôî .char-glow{background:rgba(255,120,100,0.4);}
.card-Ìôî .element-badge{background:rgba(255,120,100,0.15);border:1px solid rgba(255,120,100,0.3);color:#ffe0d8;}
.card-ÌÜ†{background:linear-gradient(180deg,#2a2518 0%,#1a1508 100%);}
.card-ÌÜ† .bg-glow{background:rgba(210,170,120,0.5);}
.card-ÌÜ† .char-glow{background:rgba(200,160,100,0.4);}
.card-ÌÜ† .element-badge{background:rgba(200,160,100,0.15);border:1px solid rgba(200,160,100,0.3);color:#f0e0c8;}
</style>`;
                    const fullInyeonHtml = `<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">${mobileCSS}</head><body>${cleanBlock}</body></html>`;
                    const encodedHtml = btoa(unescape(encodeURIComponent(fullInyeonHtml)));
                    
                    // ‚òÖ ÎëòÎã§ vs Îã®Ïùº ÏÑ±Î≥Ñ ÎÜíÏù¥ ÎèôÏ†Å ÏÑ§Ï†ï
                    const isBothGender = cleanBlock.includes('gender-group');
                    const iframeHeight = isBothGender ? '900px' : '550px';
                    
                    return `<div class="inyeon-html-block" style="margin:30px 0;">
                        <iframe src="data:text/html;base64,${encodedHtml}" style="width:calc(100% + 30px);margin-left:-15px;height:${iframeHeight};border:none;border-radius:20px;overflow:hidden;" scrolling="no"></iframe>
                    </div>`;
                })
                // Ïù∏Ïó∞ÏÉÅ SVG Ïù¥ÎØ∏ÏßÄ ÏÇΩÏûÖ (Í∏∞Ï°¥ ÌååÏùºÎ™Ö Î∞©Ïãù)
                .replace(/<!--\s*Ïù∏Ïó∞ÏÉÅ\s*SVG:\s*(\S+\.svg)\s*-->/gi, (_, filename) => {
                    return `<div class="inyeon-image-container" style="text-align:center;margin:30px 0;">
                        <img src="assets/svg/${filename}" alt="Ïù∏Ïó∞ÏÉÅ Ïù¥ÎØ∏ÏßÄ" style="max-width:280px;width:100%;height:auto;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.1);" onerror="this.style.display='none';this.nextElementSibling.style.display='block';">
                        <div style="display:none;padding:40px;background:#f9f6ef;border-radius:12px;color:#8b7355;font-size:14px;">
                            <p>üé® Ïù∏Ïó∞ÏÉÅ Ïù¥ÎØ∏ÏßÄ</p>
                            <p style="font-size:12px;margin-top:8px;">ÌååÏùº: ${filename}</p>
                            <p style="font-size:11px;color:#aaa;margin-top:5px;">assets/svg/ Ìè¥ÎçîÏóê Ïù¥ÎØ∏ÏßÄÎ•º ÎÑ£Ïñ¥Ï£ºÏÑ∏Ïöî</p>
                        </div>
                    </div>`;
                })
                // Ïù∏Ïó∞ÏÉÅ ÏßÄÏßÄ+ÏÑ±Î≥Ñ Ìå®ÌÑ¥: <!-- Ïù∏Ïó∞ÏÉÅ: Ïûê Ïó¨ÏÑ± --> ÎòêÎäî <!-- Ïù∏Ïó∞ÏÉÅ: Â≠ê ÎÇ® -->
                .replace(/<!--\s*Ïù∏Ïó∞ÏÉÅ:\s*([Â≠ê‰∏ëÂØÖÂçØËæ∞Â∑≥ÂçàÊú™Áî≥ÈÖâÊàå‰∫•ÏûêÏ∂ïÏù∏Î¨òÏßÑÏÇ¨Ïò§ÎØ∏Ïã†Ïú†Ïà†Ìï¥])\s*(ÎÇ®|Ïó¨|ÎÇ®ÏÑ±|Ïó¨ÏÑ±|male|female|m|f)\s*-->/gi, (_, jiji, gender) => {
                    console.log('[Ïù∏Ïó∞ÏÉÅ] ÌÉúÍ∑∏ Î∞úÍ≤¨:', jiji, gender);
                    return renderYeonsangImage(jiji, gender);
                })
                // ÎßàÌÅ¨Îã§Ïö¥ Ïù¥ÎØ∏ÏßÄ ![alt](src) ‚Üí <img>
                .replace(/!\[([^\]]*)\]\(([^)]+)\)/g, (_, alt, src) => {
                    console.log('[DEBUG] Ïù¥ÎØ∏ÏßÄ Î∞úÍ≤¨:', alt, src);
                    
                    // Í≤ΩÎ°ú Î≥ÄÌôò: images/Ïù∏Ïó∞ÏÉÅ/ ‚Üí assets/svg/
                    let fixedSrc = src
                        .replace(/^images\/Ïù∏Ïó∞ÏÉÅ\//i, 'assets/svg/')
                        .replace(/^images\//i, 'assets/');
                    
                    console.log('[DEBUG] Î≥ÄÌôòÎêú Í≤ΩÎ°ú:', fixedSrc);
                    
                    // Ïù∏Ïó∞ÏÉÅ Ïù¥ÎØ∏ÏßÄÏù∏ Í≤ΩÏö∞ ÌäπÎ≥Ñ Ïä§ÌÉÄÏùºÎßÅ
                    if (src.includes('Ïù∏Ïó∞ÏÉÅ') || alt.includes('Ïù∏Ïó∞')) {
                        return `<div class="inyeon-image-container" style="text-align:center;margin:30px 0;">
                            <img src="${fixedSrc}" alt="${alt}" style="max-width:280px;width:100%;height:auto;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.1);" onerror="this.parentElement.innerHTML='<div style=\\'padding:40px;background:#f9f6ef;border-radius:12px;color:#8b7355;font-size:14px;\\'><p>üé® ${alt || 'Ïù∏Ïó∞ÏÉÅ Ïù¥ÎØ∏ÏßÄ'}</p><p style=\\'font-size:11px;color:#aaa;margin-top:5px;\\'>Ïù¥ÎØ∏ÏßÄ Í≤ΩÎ°ú: ${fixedSrc}</p></div>';">
                            <p style="margin-top:10px;font-size:14px;color:#6b5744;font-weight:500;">${alt}</p>
                        </div>`;
                    }
                    // ÏùºÎ∞ò Ïù¥ÎØ∏ÏßÄ
                    return `<img src="${fixedSrc}" alt="${alt}" style="max-width:100%;height:auto;border-radius:8px;margin:15px 0;">`;
                })
                // Ìó§Îî© (Ïïû Í≥µÎ∞± ÌóàÏö©)
                .replace(/^\s*#### (.+)$/gm, '<h5 style="color:#4a3d30;margin:20px 0 10px;font-size:15px;font-weight:600;">$1</h5>')
                .replace(/^\s*### (.+)$/gm, '<h4 style="color:#2d2418;margin:25px 0 12px;font-size:16px;font-weight:700;">$1</h4>')
                .replace(/^\s*## (.+)$/gm, '<h3 style="color:#2d2418;margin:35px 0 18px;font-size:19px;font-weight:700;padding:12px 15px;background:linear-gradient(135deg,#f9f6ef,#f0ebe0);border-left:4px solid #d4af82;border-radius:0 8px 8px 0;">$1</h3>')
                .replace(/^\s*# (.+)$/gm, '<h2 style="color:#2d2418;margin:40px 0 20px;font-size:22px;font-weight:700;text-align:center;padding-bottom:15px;border-bottom:2px solid #d4af82;">$1</h2>')
                // ‚òÖ Ïù∏Ïö©Î¨∏ (Î¶¨Ïä§Ìä∏/Î≥ºÎìúÎ≥¥Îã§ Î®ºÏ†Ä!) - Ïó∞ÏÜçÎêú > Ï§ÑÎì§ÏùÑ Ìïú Î≤àÏóê Ï≤òÎ¶¨
                .replace(/(^>.*$\n?)+/gm, function(block) {
                    let lines = block.split('\n')
                        .filter(l => l.trim().startsWith('>'))
                        .map(l => {
                            let content = l.replace(/^>\s*/, '').trim();
                            if (!content) return '<br>';
                            // Ïù∏Ïö©Î¨∏ ÎÇ¥Î∂Ä ÎßàÌÅ¨Îã§Ïö¥ Ï≤òÎ¶¨
                            content = content
                                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                                .replace(/^-\s+(.+)$/, '‚Ä¢ $1');
                            return content;
                        });
                    // Îπà Ï§Ñ Ï†ïÎ¶¨ (Ïó∞ÏÜç <br> Ï†úÍ±∞, Îß® ÏïûÎí§ <br> Ï†úÍ±∞)
                    lines = lines.filter((l, i, arr) => !(l === '<br>' && (i === 0 || i === arr.length - 1 || arr[i-1] === '<br>')));
                    return `<div style="margin:15px 0;padding:18px 20px;background:linear-gradient(135deg,#f9f6ef 0%,#f5f0e6 100%);border-radius:12px;border-left:4px solid #d4af82;color:#5d4e37;font-size:14px;line-height:1.9;">${lines.join('<br>')}</div>`;
                })
                // Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ (Î¶¨Ïä§Ìä∏Î≥¥Îã§ Î®ºÏ†Ä!)
                .replace(/-\s*\[\s*\]\s*([^<\n]+)/g, '<div class="checklist-item"><span class="checkbox empty"></span><span class="text">$1</span></div>')
                .replace(/-\s*\[x\]\s*([^<\n]+)/gi, '<div class="checklist-item"><span class="checkbox checked">‚úì</span><span class="text">$1</span></div>')
                // ‚òÖ Ïà´Ïûê Î¶¨Ïä§Ìä∏ (1. 2. 3.) - ÏõêÎûò Î≤àÌò∏ Ïú†ÏßÄ!
                .replace(/^(\d+)\.\s+(.+)$/gm, '<li class="ol-item" style="margin:8px 0;list-style:none;"><span style="color:#d4af82;font-weight:600;">$1.</span> $2</li>')
                .replace(/(<li class="ol-item"[^>]*>.*<\/li>\n?)+/g, '<ul style="margin:15px 0 15px 10px;padding-left:5px;">$&</ul>')
                // ÏùºÎ∞ò Î¶¨Ïä§Ìä∏
                .replace(/^-\s+(.+)$/gm, '<li style="margin:8px 0;">$1</li>')
                .replace(/^‚ú¶\s*(.+)$/gm, '<li style="margin:8px 0;"><span style="color:#d4af82;">‚ú¶</span> $1</li>')
                .replace(/(<li[^>]*>.*<\/li>\n?)+/g, '<ul style="margin:15px 0 15px 10px;list-style:none;">$&</ul>')
                // Î≥ºÎìú
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                // Ïù¥ÌÉ§Î¶≠ (Î≥ºÎìú Ï≤òÎ¶¨ ÌõÑ!)
                .replace(/\*([^*\n]+)\*/g, '<em style="color:#6b5744;">$1</em>')
                // HEX ÏÉâÏÉÅ ÏΩîÎìú ‚Üí ÏÉâÏÉÅ Î∞ïÏä§
                .replace(/`(#[A-Fa-f0-9]{6})`/g, '<span style="display:inline-flex;align-items:center;gap:6px;margin:3px;padding:4px 10px;background:#f5f0e6;border-radius:15px;font-size:13px;"><span style="width:18px;height:18px;border-radius:50%;background:$1;border:1px solid #d4c5a9;"></span>$1</span>')
                // ÌÖçÏä§Ìä∏ ÎÇ¥ ÏÉâÏÉÅÏΩîÎìú (Ïòà: "ÎÑ§Ïù¥ÎπÑ Î∏îÎ£® #1a5276")
                .replace(/([Í∞Ä-Ìû£a-zA-Z]+)\s+(#[A-Fa-f0-9]{6})(?=\s|$|<|,|\.)/g, '$1 <span style="display:inline-flex;align-items:center;gap:4px;padding:2px 8px;background:#f5f0e6;border-radius:10px;font-size:12px;vertical-align:middle;"><span style="width:12px;height:12px;border-radius:50%;background:$2;border:1px solid #d4c5a9;"></span>$2</span>')
                // Íµ¨Î∂ÑÏÑ† (Í≥µÎ∞± Ìè¨Ìï®)
                .replace(/^\s*-{3,}\s*$/gm, '<div class="divider">‚ú¶</div>')
                // """ Ï†úÍ±∞
                .replace(/^"""$/gm, '')
                // ‚òÖ ÌÖåÎßà ÏÉâÏÉÅ ÏΩîÎìúÎ∏îÎ°ù ÏãúÍ∞ÅÌôî (Ïò§ÌñâÎ≥¥Îã§ Î®ºÏ†Ä Ï≤òÎ¶¨)
                .replace(/```[\s\S]*?ÌÖåÎßà\s*ÏÉâÏÉÅ[\s\S]*?```/gi, function(block) {
                    // ÏÉâÏÉÅ ÏΩîÎìú Ï∂îÏ∂ú
                    const colorMatch = block.match(/#([A-Fa-f0-9]{6})/);
                    const colorCode = colorMatch ? '#' + colorMatch[1] : '#d4af82';
                    // ÏÉâÏÉÅ Ïù¥Î¶Ñ Ï∂îÏ∂ú (‚ñà Îí§ ÎòêÎäî ÏÉâÏÉÅÎ™Ö Ìå®ÌÑ¥)
                    const nameMatch = block.match(/‚ñà+\s*([^\n(]+)/) || block.match(/([Í∞Ä-Ìû£]+)\s*\([A-Za-z\s]+\)/);
                    const colorName = nameMatch ? nameMatch[1].trim() : 'ÌÖåÎßà ÏÉâÏÉÅ';
                    // ÏòÅÎ¨∏Î™Ö Ï∂îÏ∂ú
                    const engMatch = block.match(/\(([A-Za-z\s]+)\)/);
                    const engName = engMatch ? engMatch[1].trim() : '';
                    // Î≥¥ÏôÑ Ïª¨Îü¨ ÏÑ§Î™Ö Ï∂îÏ∂ú
                    const descMatch = block.match(/([Î™©ÌôîÌÜ†Í∏àÏàò])\s*\(?\s*[Êú®ÁÅ´ÂúüÈáëÊ∞¥]?\s*\)?\s*Î≥¥ÏôÑ/i);
                    const elementName = descMatch ? descMatch[1] : '';
                    const elementHanja = {'Î™©':'Êú®','Ìôî':'ÁÅ´','ÌÜ†':'Âúü','Í∏à':'Èáë','Ïàò':'Ê∞¥'}[elementName] || '';
                    // ÏùòÎØ∏ Ï∂îÏ∂ú
                    const meaningMatch = block.match(/(ÏÑ±Ïû•|ÏûêÍ∑π|ÏïàÏ†ï|Í≤∞Îã®|ÏàòÏö©|Ï∞ΩÏùò|Ïó¥Ï†ï|Ï∞®Î∂Ñ|Í∑†Ìòï|ÌíçÏöî)[Í≥ºÏôÄÏùòÏùÑÎ•ºÏóê]?\s*[^\n]{0,15}(ÏóêÎÑàÏßÄ|Í∏∞Ïö¥|ÏÉâ|ÏùòÎØ∏)/);
                    const meaning = meaningMatch ? meaningMatch[0] : '';
                    
                    return `<div style="margin:30px auto;max-width:320px;background:linear-gradient(145deg,#2d2418 0%,#3d3225 100%);border-radius:20px;padding:30px 25px;text-align:center;box-shadow:0 8px 30px rgba(0,0,0,0.2);">
                        <div style="font-size:11px;letter-spacing:3px;color:#a89068;margin-bottom:20px;">2026 THEME COLOR</div>
                        <div style="width:80px;height:80px;border-radius:50%;background:${colorCode};margin:0 auto 20px;box-shadow:0 0 30px ${colorCode}60,inset 0 -3px 10px rgba(0,0,0,0.2);border:3px solid rgba(255,255,255,0.1);"></div>
                        <div style="font-size:22px;font-weight:700;color:#f5efe3;margin-bottom:5px;">${colorName}</div>
                        ${engName ? `<div style="font-size:12px;color:#a89068;letter-spacing:1px;margin-bottom:12px;">${engName}</div>` : ''}
                        <div style="font-size:13px;color:#8b7355;font-family:monospace;background:rgba(255,255,255,0.05);padding:6px 14px;border-radius:20px;display:inline-block;margin-bottom:15px;">${colorCode}</div>
                        ${elementName ? `<div style="margin-top:15px;padding-top:15px;border-top:1px solid rgba(168,144,104,0.2);"><span style="display:inline-block;padding:5px 12px;background:rgba(212,175,130,0.15);border-radius:15px;font-size:12px;color:#d4af82;">${elementName}(${elementHanja}) Î≥¥ÏôÑ Ïª¨Îü¨</span></div>` : ''}
                        ${meaning ? `<div style="font-size:12px;color:#8b7355;margin-top:10px;line-height:1.6;">${meaning}</div>` : ''}
                    </div>`;
                })
                // Ïò§Ìñâ ÏΩîÎìúÎ∏îÎ°ù ÏãúÍ∞ÅÌôî
                .replace(/```[\s\S]*?```/g, function(block) {
                    if (!block.includes('(Êú®)') && !block.includes('(ÁÅ´)') && !block.includes('(Âúü)') && !block.includes('(Èáë)') && !block.includes('(Ê∞¥)')) {
                        // Ïò§Ìñâ ÏïÑÎãå ÏΩîÎìúÎ∏îÎ°ù: ÏïÑÏä§ÌÇ§ Î∞ïÏä§ Î¨∏Ïûê Ï†úÍ±∞ ÌõÑ ÍπîÎÅîÌïòÍ≤å ÌëúÏãú
                        const content = block.replace(/```/g,'')
                            .replace(/[‚îå‚îê‚îî‚îò‚îÄ]+/g, '')  // Î™®ÏÑúÎ¶¨, Í∞ÄÎ°úÏÑ† Ï†úÍ±∞
                            .replace(/‚îÇ/g, '')  // ÏÑ∏Î°úÏÑ† Ï†úÍ±∞
                            .split('\n')
                            .map(l => l.trim())
                            .filter(l => l)
                            .join('<br>');
                        return '<div style="background:#f9f6ef;border:1px solid #e5dccb;border-radius:12px;padding:15px 20px;margin:15px 0;font-size:14px;line-height:1.8;color:#5a4a38;text-align:center;">' + content + '</div>';
                    }
                    const colorMap = {'Î™©':'#3d6b1e','Ìôî':'#c41e3a','ÌÜ†':'#b8860b','Í∏à':'#5a6370','Ïàò':'#1e5a8a'};
                    const lines = block.replace(/```/g,'').trim().split('\n').filter(l => l.trim());
                    let data = [];
                    let max = 0;
                    for (let line of lines) {
                        const m = line.match(/(Î™©|Ìôî|ÌÜ†|Í∏à|Ïàò)\((.)\)[^0-9]*([\d.]+)/);
                        if (m) {
                            const v = parseFloat(m[3]);
                            if (v > max) max = v;
                            data.push({name: m[1], hanja: m[2], val: v});
                        }
                    }
                    if (data.length === 0) return '';
                    let out = '<table style="width:100%;border-collapse:collapse;margin:10px 0;">';
                    for (let d of data) {
                        const w = max > 0 ? Math.round((d.val / max) * 100) : 0;
                        out += '<tr>';
                        out += '<td style="width:55px;font-size:13px;color:#4a3d30;padding:4px 0;">' + d.name + '(' + d.hanja + ')</td>';
                        out += '<td style="padding:4px 8px;"><div style="width:100%;height:16px;background:#e5dccb;border-radius:8px;overflow:hidden;"><div style="width:' + Math.max(w, 3) + '%;height:100%;background:' + colorMap[d.name] + ';border-radius:8px;"></div></div></td>';
                        out += '<td style="width:35px;font-size:13px;color:#4a3d30;text-align:right;padding:4px 0;">' + d.val + '</td>';
                        out += '</tr>';
                    }
                    out += '</table>';
                    return out;
                })
                // Ï§ÑÎ∞îÍøà
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>')
                // ‚òÖ Ïù¥Ïä§ÏºÄÏù¥ÌîÑ Îî∞Ïò¥Ìëú Ï†úÍ±∞ (\" ‚Üí ")
                .replace(/\\"/g, '"');
        }
        
        // Google Drive ÏóÖÎ°úÎìú Ìï®Ïàò
        async function uploadToNetlify() {
            const content = document.getElementById('previewContent').innerHTML;
            if (content.includes('empty-state')) { alert('Î®ºÏ†Ä Í≤∞Í≥ºÏßÄÎ•º ÏÉùÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî.'); return; }
            
            if (!metaData.orderCode) {
                alert('Ï£ºÎ¨∏ÏΩîÎìúÍ∞Ä ÏóÜÏäµÎãàÎã§. Í≥†Í∞ù Ï†ïÎ≥¥Î•º Î®ºÏ†Ä Î∂àÎü¨ÏôÄÏ£ºÏÑ∏Ïöî.');
                return;
            }
            
            const statusEl = document.getElementById('upload-status');
            statusEl.textContent = '‚è≥ Google Drive ÏóÖÎ°úÎìú Ï§ë...';
            
            try {
                // Í≤∞Í≥ºÎ¨º HTML ÏÉùÏÑ±
                const baseStyles = document.getElementById('resultStyles').textContent;
                
                // ‚òÖ content ÏïàÏùò style ÌÉúÍ∑∏Î•º Ï∂îÏ∂úÌï¥ÏÑú headÎ°ú Ïù¥Îèô (Ïù∏Ïó∞ÏÉÅ CSS Îì±)
                let embeddedStyles = '';
                let cleanContent = content.replace(/<style[^>]*>([\s\S]*?)<\/style>/gi, (match, css) => {
                    embeddedStyles += css;
                    return ''; // contentÏóêÏÑúÎäî Ï†úÍ±∞
                });
                const styles = baseStyles + embeddedStyles;
                
                // ÌîåÎ°úÌåÖ Îã§Ïö¥Î°úÎìú Î≤ÑÌäº (data URI Î∞©Ïãù - Î™®Î∞îÏùº/Google Drive Ìò∏Ìôò)
                const downloadBtn = `
                    <button onclick="(function(){
                        var html = document.documentElement.outerHTML;
                        var dataUri = 'data:text/html;charset=utf-8,' + encodeURIComponent('<!DOCTYPE html>'+html);
                        var a = document.createElement('a');
                        a.href = dataUri;
                        a.download = 'ÏÇ¨Ï£ºÍ≤∞Í≥ºÏßÄ.html';
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                    })()" style="position:fixed;bottom:20px;right:20px;z-index:9999;width:50px;height:50px;background:linear-gradient(135deg,#d4af82,#b8956a);border-radius:50%;display:flex;align-items:center;justify-content:center;border:none;font-size:22px;box-shadow:0 4px 15px rgba(0,0,0,0.3);cursor:pointer;" title="Í≤∞Í≥ºÏßÄ Îã§Ïö¥Î°úÎìú">üì•</button>`;
                
                // Î™©Ï∞® Î≤ÑÌäº + Ïò§Î≤ÑÎ†àÏù¥ + Ïä§ÌÅ¨Î¶ΩÌä∏
                const tocElements = `
                    <button id="tocToggle" onclick="toggleToc()" style="position:fixed;bottom:80px;right:20px;z-index:9998;width:50px;height:50px;border-radius:50%;background:linear-gradient(135deg,#d4af82,#b8956a);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:22px;box-shadow:0 4px 15px rgba(0,0,0,0.3);" title="Î™©Ï∞®">üìë</button>
                    <div id="tocOverlay" style="position:fixed;bottom:140px;right:20px;z-index:9997;max-height:50vh;max-width:280px;overflow-y:auto;background:#fff;border-radius:16px;box-shadow:0 8px 30px rgba(0,0,0,0.25);display:none;">
                        <div style="padding:15px 20px;background:linear-gradient(135deg,#d4af82,#b8956a);color:#fff;font-weight:700;font-size:14px;border-radius:16px 16px 0 0;">üìö Î™©Ï∞®</div>
                        <div id="tocItems" style="padding:10px 0;"></div>
                    </div>
                    \x3cscript\x3e
                    function toggleToc(){var o=document.getElementById('tocOverlay');o.style.display=o.style.display==='block'?'none':'block';}
                    function scrollToSection(id){document.getElementById(id)?.scrollIntoView({behavior:'smooth'});document.getElementById('tocOverlay').style.display='none';}
                    document.addEventListener('click',function(e){var o=document.getElementById('tocOverlay'),t=document.getElementById('tocToggle');if(o&&t&&!o.contains(e.target)&&!t.contains(e.target))o.style.display='none';});
                    (function buildToc(){var items=document.getElementById('tocItems'),secs=document.querySelectorAll('.section-divider');if(!items||!secs.length)return;items.innerHTML='';secs.forEach(function(s){var n=s.dataset.num||'',title=s.querySelector('.title')?.textContent||'ÏÑπÏÖò',id=s.id;var a=document.createElement('a');a.href='javascript:void(0)';a.onclick=function(){scrollToSection(id);};a.style='display:block;padding:12px 20px;color:#4a3d30;text-decoration:none;font-size:13px;border-bottom:1px solid #f0ebe0;';a.innerHTML='<span style="display:inline-block;width:24px;height:24px;background:#f0ebe0;border-radius:50%;text-align:center;line-height:24px;font-size:11px;margin-right:10px;color:#8b7355;">'+n+'</span>'+title;items.appendChild(a);});})();
                    \x3c/script\x3e`;
                
                // ‚òÖ Ïù∏Ïó∞ÏÉÅ Î≥ÑÎèÑ ÌååÏùº Ï≤òÎ¶¨
                const inyeonHtml = document.getElementById('inyeonHtmlInput')?.value?.trim();
                let inyeonFileName = null;
                let inyeonBase64 = null;
                
                if (inyeonHtml) {
                    inyeonFileName = `${metaData.orderCode}_Ïù∏Ïó∞ÏÉÅ.html`;
                    const githubInyeonUrl = `https://eunjilab.github.io/saju-results/${inyeonFileName}`;
                    
                    // base64 iframeÏùÑ GitHub URLÎ°ú ÍµêÏ≤¥
                    cleanContent = cleanContent.replace(
                        /<iframe\s+src="data:text\/html;base64,[^"]*"/gi,
                        `<iframe src="${githubInyeonUrl}"`
                    );
                    
                    // Ïù∏Ïó∞ÏÉÅ ÌååÏùºÏö© CSS
                    const inyeonCSS = `<style>
html,body{margin:0;padding:0;background:transparent;}
.result-box{width:100%;max-width:100%;margin:0;padding:28px;background:rgba(255,255,255,0.03);border-radius:20px;border:1px solid rgba(255,255,255,0.05);font-family:'Noto Sans KR',sans-serif;box-sizing:border-box;box-shadow:none!important;}
.user-info{text-align:center;margin-bottom:15px;padding-bottom:12px;border-bottom:1px solid rgba(255,255,255,0.1);}
.user-info h2{font-size:16px;margin:0 0 6px 0;color:#e8e0d8;font-weight:400;}
.user-info p{font-size:11px;margin:0;color:rgba(255,255,255,0.6);}
.gender-group{display:block!important;width:100%!important;margin-bottom:25px!important;}.gender-label{text-align:center;margin-bottom:12px;color:#e8e0d8;font-size:14px;letter-spacing:2px;}.inyun-cards-container,.cards-row{display:flex!important;gap:12px!important;justify-content:center!important;flex-wrap:nowrap!important;padding:10px 5px!important;}
.card-wrapper{text-align:center;flex:0 0 auto!important;}
.card-label{color:#e8e0d8;font-size:12px;margin-bottom:8px;letter-spacing:1px;}
.card-label span{font-size:16px;margin-right:5px;}
.card{width:150px!important;height:240px!important;border-radius:16px;position:relative;overflow:hidden;box-shadow:none!important;}
.bg-glow{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100px;height:100px;border-radius:50%;filter:blur(35px);opacity:0.4;}
.stars{position:absolute;top:0;left:0;right:0;bottom:0;pointer-events:none;}
.star{position:absolute;width:2px;height:2px;background:#fff;border-radius:50%;opacity:0.6;}
.content{position:relative;z-index:10;height:100%;display:flex;flex-direction:column;align-items:center;padding:10px 8px;box-sizing:border-box;}
.element-label{font-size:9px;letter-spacing:2px;color:rgba(255,255,255,0.7)!important;opacity:1!important;margin-bottom:4px;}
.character-area{flex:1;display:flex;align-items:center;justify-content:center;position:relative;width:100%;}
.character-area svg{width:95px!important;height:auto!important;max-height:105px!important;}
.char-glow{position:absolute;width:70px;height:70px;border-radius:50%;filter:blur(25px);opacity:0.5;}
.info{text-align:center;margin-top:auto;}
.element-badge{width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 6px;font-size:13px;backdrop-filter:blur(10px);}
.element-name{font-size:11px;font-weight:500;margin-bottom:2px;color:#fff;}
.element-desc{font-size:8px;opacity:0.7;color:#fff;}
.napeum-info{margin-top:4px;font-size:7px;opacity:0.5;color:#fff;}
.card-Í∏à{background:linear-gradient(180deg,#2a2a3e 0%,#1e1e30 100%);}
.card-Í∏à .bg-glow{background:rgba(210,210,240,0.5);}
.card-Í∏à .char-glow{background:rgba(200,200,230,0.4);}
.card-Í∏à .element-badge{background:rgba(200,200,230,0.15);border:1px solid rgba(200,200,230,0.3);color:#e8e8f8;}
.card-Î™©{background:linear-gradient(180deg,#1a2e1a 0%,#152015 100%);}
.card-Î™© .bg-glow{background:rgba(120,200,120,0.5);}
.card-Î™© .char-glow{background:rgba(100,180,100,0.4);}
.card-Î™© .element-badge{background:rgba(100,180,100,0.15);border:1px solid rgba(100,180,100,0.3);color:#d0f0d0;}
.card-Ïàò{background:linear-gradient(180deg,#1a1a3e 0%,#151528 100%);}
.card-Ïàò .bg-glow{background:rgba(120,170,255,0.5);}
.card-Ïàò .char-glow{background:rgba(100,150,255,0.4);}
.card-Ïàò .element-badge{background:rgba(100,150,255,0.15);border:1px solid rgba(100,150,255,0.3);color:#d0e0ff;}
.card-Ìôî{background:linear-gradient(180deg,#2e1a1a 0%,#281515 100%);}
.card-Ìôî .bg-glow{background:rgba(255,140,120,0.5);}
.card-Ìôî .char-glow{background:rgba(255,120,100,0.4);}
.card-Ìôî .element-badge{background:rgba(255,120,100,0.15);border:1px solid rgba(255,120,100,0.3);color:#ffe0d8;}
.card-ÌÜ†{background:linear-gradient(180deg,#2a2518 0%,#1a1508 100%);}
.card-ÌÜ† .bg-glow{background:rgba(210,170,120,0.5);}
.card-ÌÜ† .char-glow{background:rgba(200,160,100,0.4);}
.card-ÌÜ† .element-badge{background:rgba(200,160,100,0.15);border:1px solid rgba(200,160,100,0.3);color:#f0e0c8;}
</style>`;
                    
                    // style ÌÉúÍ∑∏ Ï†úÍ±∞Ìïú Ïù∏Ïó∞ÏÉÅ HTML
                    const cleanInyeonHtml = inyeonHtml.replace(/<style[^>]*>[\s\S]*?<\/style>/gi, '');
                    const inyeonFullHtml = `<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">${inyeonCSS}</head><body style="margin:0;padding:0;">${cleanInyeonHtml}</body></html>`;
                    inyeonBase64 = btoa(unescape(encodeURIComponent(inyeonFullHtml)));
                    console.log('[Ïù∏Ïó∞ÏÉÅ] Î≥ÑÎèÑ ÌååÏùº Ï§ÄÎπÑ ÏôÑÎ£å:', inyeonFileName);
                }
                
                const fullHTML = `<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>${metaData.name||'ÏÇ¨Ï£º'}ÎãòÏùò ÏÇ¨Ï£ºÎ™ÖÎ¶¨ Í∞êÏ†ïÏÑú</title><link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700;800&display=swap" rel="stylesheet"><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Nanum Myeongjo',serif;background:#f8f6f1}${styles}</style></head><body>${cleanContent}${downloadBtn}${tocElements}</body></html>`;
                
                // Base64 Ïù∏ÏΩîÎî©
                const base64Data = btoa(unescape(encodeURIComponent(fullHTML)));
                const fileName = `${metaData.orderCode}_Í≤∞Í≥ºÏßÄ.html`;
                
                // ‚òÖ URL ÎØ∏Î¶¨ Í≥ÑÏÇ∞ (GitHub Pages Ìå®ÌÑ¥ Í≥†Ï†ï)
                const fileUrl = `https://eunjilab.github.io/saju-results/${fileName}`;
                
                // ‚òÖ ÎßÅÌÅ¨ Î®ºÏ†Ä ÌëúÏãú + Î≥µÏÇ¨ (Î™®Î∞îÏùº Ìò∏Ìôò)
                let copied = false;
                try {
                    await navigator.clipboard.writeText(fileUrl);
                    copied = true;
                } catch (clipErr) {
                    // Î™®Î∞îÏùº fallback: execCommand Î∞©Ïãù
                    try {
                        const tempInput = document.createElement('input');
                        tempInput.value = fileUrl;
                        tempInput.style.position = 'fixed';
                        tempInput.style.opacity = '0';
                        document.body.appendChild(tempInput);
                        tempInput.focus();
                        tempInput.select();
                        copied = document.execCommand('copy');
                        document.body.removeChild(tempInput);
                    } catch (e) {
                        console.log('ÌÅ¥Î¶ΩÎ≥¥Îìú Î≥µÏÇ¨ Ïã§Ìå®:', e);
                    }
                }
                
                statusEl.innerHTML = '‚è≥ <a href="' + fileUrl + '" target="_blank" style="color:#00ad9f;">' + fileUrl + '</a>' + (copied ? ' (Î≥µÏÇ¨Îê®!) - ÏóÖÎ°úÎìú Ï§ë...' : ' - ÏóÖÎ°úÎìú Ï§ë...');
                alert('üéâ ÎßÅÌÅ¨Í∞Ä ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§!\n\n' + fileUrl + (copied ? '\n\nÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏñ¥Ïöî.' : '\n\nÏúÑ ÎßÅÌÅ¨Î•º Í∏∏Í≤å ÎàåÎü¨ Î≥µÏÇ¨ÌïòÏÑ∏Ïöî.') + '\n\n‚è≥ Î∞±Í∑∏ÎùºÏö¥ÎìúÏóêÏÑú ÏóÖÎ°úÎìú ÏßÑÌñâ Ï§ë...');
                
                // ‚òÖ ÏóÖÎ°úÎìúÎäî form + iframe Î∞©ÏãùÏúºÎ°ú (CORS Ïö∞Ìöå)
                const webAppUrl = 'https://script.google.com/macros/s/AKfycbzlnTB3d3tO_qvRNKgiLkGgy3EmH_92eYslv4mODGzV7QCiVHYTDLEl4duNlp3PO_kclA/exec';

                const iframeName = 'uploadFrame_' + Date.now();
                const iframe = document.createElement('iframe');
                iframe.name = iframeName;
                iframe.style.display = 'none';
                document.body.appendChild(iframe);

                const form = document.createElement('form');
                form.method = 'POST';
                form.action = webAppUrl;
                form.target = iframeName;
                form.style.display = 'none';

                const params = {
                    action: 'uploadResult',
                    orderCode: metaData.orderCode,
                    fileName: fileName,
                    fileData: base64Data,
                    resultType: 'main',
                    inyeonFileName: inyeonFileName,
                    inyeonData: inyeonBase64
                };

                for (const key in params) {
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = key;
                    input.value = params[key] || '';
                    form.appendChild(input);
                }

                document.body.appendChild(form);
                form.submit();

                // 5Ï¥à ÌõÑ Ï†ïÎ¶¨ Î∞è ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                setTimeout(() => {
                    document.body.removeChild(form);
                    document.body.removeChild(iframe);
                    statusEl.innerHTML = '‚úÖ <a href="' + fileUrl + '" target="_blank" style="color:#00ad9f;">' + fileUrl + '</a> (ÏóÖÎ°úÎìú ÏôÑÎ£å!)';
                    console.log('ÏóÖÎ°úÎìú ÏôÑÎ£å!');

                    // ‚òÖ Í¥ÄÎ¶¨ÏûêÌéòÏù¥ÏßÄÎ°ú Í≤∞Í≥º URL Ï†ÑÎã¨ (window.opener ÏÇ¨Ïö©)
                    console.log('üîç window.opener ÌôïÏù∏:', window.opener);
                    console.log('üîç metaData:', metaData);
                    if (window.opener && !window.opener.closed) {
                        window.opener.postMessage({
                            action: 'resultUrlGenerated',
                            orderCode: metaData.orderCode,
                            resultUrl: fileUrl,
                            resultType: 'main'
                        }, '*');
                        console.log('‚úÖ Í¥ÄÎ¶¨ÏûêÌéòÏù¥ÏßÄÎ°ú Í≤∞Í≥º URL Ï†ÑÎã¨:', metaData.orderCode, fileUrl);
                    } else {
                        console.log('‚ö†Ô∏è window.opener ÏóÜÏùå - Í¥ÄÎ¶¨ÏûêÌéòÏù¥ÏßÄÏóêÏÑú Ïó¥ÏßÄ ÏïäÏïòÍ±∞ÎÇò Îã´Ìûò');
                        // localStorage Î∞©ÏãùÏúºÎ°ú Î∞±ÏóÖ Ï†ÑÎã¨
                        localStorage.setItem('lastResultUrl', JSON.stringify({
                            orderCode: metaData.orderCode,
                            resultUrl: fileUrl,
                            resultType: 'main',
                            timestamp: Date.now()
                        }));
                        console.log('üíæ localStorageÏóê Î∞±ÏóÖ Ï†ÄÏû•');
                    }
                }, 5000);
                
            } catch (error) {
                console.error(error);
                statusEl.textContent = '‚ùå Ïò§Î•ò Î∞úÏÉù';
                alert('Ïò§Î•ò: ' + error.message);
            }
        }
        
        // ‚òÖ Google SheetsÏóê Í∏∞Î≥∏ Í≤∞Í≥ºÏßÄ URL Ï†ÄÏû• (uploadResultÏóêÏÑú ÏûêÎèô Ï†ÄÏû•ÎêòÎØÄÎ°ú Î∞±ÏóÖÏö©)
        function saveMainResultUrl(orderCode, url) {
            const webAppUrl = 'https://script.google.com/macros/s/AKfycbzlnTB3d3tO_qvRNKgiLkGgy3EmH_92eYslv4mODGzV7QCiVHYTDLEl4duNlp3PO_kclA/exec';
            
            // form POST Î∞©Ïãù (CORS Ïö∞Ìöå)
            const iframeName = 'saveFrame_' + Date.now();
            const iframe = document.createElement('iframe');
            iframe.name = iframeName;
            iframe.style.display = 'none';
            document.body.appendChild(iframe);
            
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = webAppUrl;
            form.target = iframeName;
            form.style.display = 'none';
            
            const params = {
                action: 'saveResultUrl',
                orderCode: orderCode,
                resultType: 'main',
                url: url
            };
            
            for (const key in params) {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = key;
                input.value = params[key];
                form.appendChild(input);
            }
            
            document.body.appendChild(form);
            form.submit();
            
            console.log('‚úÖ Í∏∞Î≥∏ Í≤∞Í≥ºÏßÄ URL ÏûêÎèô Ï†ÄÏû•:', orderCode);
            
            // Ï†ïÎ¶¨ (3Ï¥à ÌõÑ)
            setTimeout(() => {
                if (form.parentNode) form.parentNode.removeChild(form);
                if (iframe.parentNode) iframe.parentNode.removeChild(iframe);
            }, 3000);
        }
        
        function downloadHTML() {
            const content = document.getElementById('previewContent').innerHTML;
            if (content.includes('empty-state')) { alert('Î®ºÏ†Ä Í≤∞Í≥ºÏßÄÎ•º ÏÉùÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî.'); return; }
            
            const baseStyles = document.getElementById('resultStyles').textContent;
            
            // ‚òÖ content ÏïàÏùò style ÌÉúÍ∑∏Î•º Ï∂îÏ∂úÌï¥ÏÑú headÎ°ú Ïù¥Îèô (Ïù∏Ïó∞ÏÉÅ CSS Îì±)
            let embeddedStyles = '';
            let cleanContent = content.replace(/<style[^>]*>([\s\S]*?)<\/style>/gi, (match, css) => {
                embeddedStyles += css;
                return '';
            });
            const styles = baseStyles + embeddedStyles;
            
            // Î™©Ï∞® Î≤ÑÌäº + Ïò§Î≤ÑÎ†àÏù¥ + Ïä§ÌÅ¨Î¶ΩÌä∏
            const tocElements = `
                <button id="tocToggle" onclick="toggleToc()" style="position:fixed;bottom:80px;right:20px;z-index:9998;width:50px;height:50px;border-radius:50%;background:linear-gradient(135deg,#d4af82,#b8956a);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:22px;box-shadow:0 4px 15px rgba(0,0,0,0.3);" title="Î™©Ï∞®">üìë</button>
                <div id="tocOverlay" style="position:fixed;bottom:140px;right:20px;z-index:9997;max-height:50vh;max-width:280px;overflow-y:auto;background:#fff;border-radius:16px;box-shadow:0 8px 30px rgba(0,0,0,0.25);display:none;">
                    <div style="padding:15px 20px;background:linear-gradient(135deg,#d4af82,#b8956a);color:#fff;font-weight:700;font-size:14px;border-radius:16px 16px 0 0;">üìö Î™©Ï∞®</div>
                    <div id="tocItems" style="padding:10px 0;"></div>
                </div>
                \x3cscript\x3e
                function toggleToc(){var o=document.getElementById('tocOverlay');o.style.display=o.style.display==='block'?'none':'block';}
                function scrollToSection(id){document.getElementById(id)?.scrollIntoView({behavior:'smooth'});document.getElementById('tocOverlay').style.display='none';}
                document.addEventListener('click',function(e){var o=document.getElementById('tocOverlay'),t=document.getElementById('tocToggle');if(o&&t&&!o.contains(e.target)&&!t.contains(e.target))o.style.display='none';});
                (function buildToc(){var items=document.getElementById('tocItems'),secs=document.querySelectorAll('.section-divider');if(!items||!secs.length)return;items.innerHTML='';secs.forEach(function(s){var n=s.dataset.num||'',title=s.querySelector('.title')?.textContent||'ÏÑπÏÖò',id=s.id;var a=document.createElement('a');a.href='javascript:void(0)';a.onclick=function(){scrollToSection(id);};a.style='display:block;padding:12px 20px;color:#4a3d30;text-decoration:none;font-size:13px;border-bottom:1px solid #f0ebe0;';a.innerHTML='<span style="display:inline-block;width:24px;height:24px;background:#f0ebe0;border-radius:50%;text-align:center;line-height:24px;font-size:11px;margin-right:10px;color:#8b7355;">'+n+'</span>'+title;items.appendChild(a);});})();
                \x3c/script\x3e`;
            
            const fullHTML = `<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>${metaData.name||'ÏÇ¨Ï£º'}ÎãòÏùò ÏÇ¨Ï£ºÎ™ÖÎ¶¨ Í∞êÏ†ïÏÑú</title><link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700;800&display=swap" rel="stylesheet"><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Nanum Myeongjo',serif;background:#f8f6f1}${styles}</style></head><body>${cleanContent}${tocElements}</body></html>`;
            
            const dataUri = 'data:text/html;charset=utf-8,' + encodeURIComponent(fullHTML);
            const a = document.createElement('a');
            a.href = dataUri;
            a.download = `${metaData.name||'ÏÇ¨Ï£º'}_Ïö¥ÏÑ∏Í≤∞Í≥º_${metaData.package||'Í≤∞Í≥º'}.html`;
            a.click();
        }
        
        function clearInput() {
            document.getElementById('claudeInput').value = '';
            document.getElementById('parseResult').className = 'parse-result';
            document.getElementById('previewContent').innerHTML = '<div class="empty-state"><div class="icon">üé¥</div><p>Claude Ï∂úÎ†•Î¨ºÏùÑ Î∂ôÏó¨ÎÑ£ÏúºÎ©¥<br>Í≤∞Í≥ºÏßÄÍ∞Ä ÏÉùÏÑ±Îê©ÎãàÎã§</p></div>';
            metaData = {}; pageData = [];
        }
        
        // ‚òÖ ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóêÏÑú Î∂ôÏó¨ÎÑ£Í∏∞
        async function pasteFromClipboard() {
            try {
                const text = await navigator.clipboard.readText();
                if (text) {
                    document.getElementById('claudeInput').value = text;
                    generateResult();
                } else {
                    alert('ÌÅ¥Î¶ΩÎ≥¥ÎìúÍ∞Ä ÎπÑÏñ¥ÏûàÏäµÎãàÎã§.');
                }
            } catch (err) {
                // Í∂åÌïú Í±∞Î∂Ä ÎòêÎäî ÏßÄÏõê Ïïà Ìï®
                alert('ÌÅ¥Î¶ΩÎ≥¥Îìú Ï†ëÍ∑º Í∂åÌïúÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.\\nÏßÅÏ†ë Ctrl+VÎ°ú Î∂ôÏó¨ÎÑ£Ïñ¥ Ï£ºÏÑ∏Ïöî.');
                console.error('ÌÅ¥Î¶ΩÎ≥¥Îìú Ïò§Î•ò:', err);
            }
        }
        
        // ‚òÖ ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú - localStorage ÏûêÎèô Î°úÎìú Ï†úÍ±∞Îê®
        // (Ïó¨Îü¨ ÏÇ¨Îûå ÏûëÏóÖ Ïãú Ïù¥Ï†Ñ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÑûÏù¥Îäî Î¨∏Ï†ú Î∞©ÏßÄ)
        // Ïù∏Ïó∞ÏÉÅ HTMLÏùÄ ÏßÅÏ†ë Î∂ôÏó¨ÎÑ£Í∏∞ Ìï¥Ï£ºÏÑ∏Ïöî!
        
        // ‚òÖ Î™©Ï∞® ÌÜ†Í∏Ä Í∏∞Îä•
        function toggleToc() {
            const overlay = document.getElementById('tocOverlay');
            overlay.classList.toggle('show');
        }
        
        // Î™©Ï∞® Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
        document.addEventListener('click', function(e) {
            const overlay = document.getElementById('tocOverlay');
            const toggle = document.getElementById('tocToggle');
            if (overlay && toggle && !overlay.contains(e.target) && !toggle.contains(e.target)) {
                overlay.classList.remove('show');
            }
        });
        
        // Î™©Ï∞® ÎßÅÌÅ¨ ÌÅ¥Î¶≠ Ïãú Ïä§ÌÅ¨Î°§ + Îã´Í∏∞
        function scrollToSection(sectionId) {
            const el = document.getElementById(sectionId);
            if (el) {
                el.scrollIntoView({ behavior: 'smooth', block: 'start' });
                document.getElementById('tocOverlay').classList.remove('show');
            }
        }
        
        // Î™©Ï∞® ÏûêÎèô ÏÉùÏÑ± (ÏÑπÏÖò divider Í∏∞Î∞ò)
        function buildToc() {
            const tocItems = document.getElementById('tocItems');
            const tocToggle = document.getElementById('tocToggle');
            if (!tocItems || !tocToggle) return;
            
            const sections = document.querySelectorAll('.section-divider');
            if (sections.length === 0) {
                tocToggle.style.display = 'none';
                return;
            }
            
            // ÏÑπÏÖò ÏûàÏúºÎ©¥ Î≤ÑÌäº ÌëúÏãú
            tocToggle.style.display = 'flex';
            
            tocItems.innerHTML = '';
            sections.forEach(sec => {
                const num = sec.dataset.num || '';
                const title = sec.querySelector('.title')?.textContent || 'ÏÑπÏÖò';
                const id = sec.id;
                
                const link = document.createElement('a');
                link.href = 'javascript:void(0)';
                link.onclick = () => scrollToSection(id);
                link.innerHTML = `<span class="toc-num">${num}</span>${title}`;
                tocItems.appendChild(link);
            });
        }
        
        // Í≤∞Í≥º ÏÉùÏÑ± ÌõÑ Î™©Ï∞® ÎπåÎìú
        const origGenerateResult = window.generateResult;
        window.generateResult = function() {
            origGenerateResult?.apply(this, arguments);
            setTimeout(buildToc, 500);
        };
    </script>
    
<!-- ÌîåÎ°úÌåÖ Î™©Ï∞® Î≤ÑÌäº + Ïò§Î≤ÑÎ†àÏù¥ -->
<button id="tocToggle" class="toc-toggle" onclick="toggleToc()" title="Î™©Ï∞®">üìë</button>
<div id="tocOverlay" class="toc-overlay">
    <div class="toc-header">üìö Î™©Ï∞®</div>
    <div id="tocItems" class="toc-items">
        <div style="padding:20px;color:#999;font-size:12px;text-align:center;">Í≤∞Í≥ºÎ•º ÏÉùÏÑ±ÌïòÎ©¥ Î™©Ï∞®Í∞Ä ÌëúÏãúÎê©ÎãàÎã§</div>
    </div>
</div>

<!-- ÌîåÎ°úÌåÖ Í¥ÄÎ¶¨Ïûê Î≤ÑÌäº -->
<a href="index.html" style="position:fixed; bottom:20px; right:20px; z-index:9999; width:50px; height:50px; background:linear-gradient(135deg,#d4af82,#b8956a); border-radius:50%; display:flex; align-items:center; justify-content:center; text-decoration:none; font-size:24px; box-shadow:0 4px 15px rgba(0,0,0,0.3);">üè†</a>
</body>
</html>
