<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì¸ì—°ìƒ ê³„ì‚°ê¸° - Step 3</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Noto Serif KR', serif;
      background: linear-gradient(135deg, #f5f0e8 0%, #e8e0d0 100%);
      min-height: 100vh;
      padding: 20px;
      color: #2d2418;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: linear-gradient(180deg, #fdfbf7 0%, #f8f4eb 100%);
      border: 2px solid #8b7355;
      border-radius: 12px;
      box-shadow: 0 15px 50px rgba(0,0,0,0.18);
      overflow: hidden;
    }
    
    .header {
      background: linear-gradient(135deg, #2c2416 0%, #4a3c2a 100%);
      color: #f0e6d3;
      text-align: center;
      padding: 35px 20px;
      position: relative;
    }
    
    .header::after {
      content: 'ç·£';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 120px;
      opacity: 0.05;
    }
    
    .header h1 {
      font-size: 26px;
      font-weight: 700;
      letter-spacing: 6px;
      margin-bottom: 8px;
      position: relative;
      z-index: 1;
      color: #f0e6d3;
      background: none;
      -webkit-text-fill-color: unset;
    }
    
    .header .subtitle {
      font-size: 13px;
      opacity: 0.8;
      letter-spacing: 2px;
      color: #d4c5a9;
    }
    
    .content-area {
      padding: 30px;
    }
    
    .subtitle {
      text-align: center;
      color: #8b7a60;
      margin-bottom: 30px;
      font-size: 0.9rem;
    }
    
    .input-section {
      background: #fff;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
      border: 1px solid #e0d5c5;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    .input-group {
      margin-bottom: 16px;
    }
    
    .input-group:last-child {
      margin-bottom: 0;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #5a4a3a;
    }
    
    select {
      width: 100%;
      padding: 12px 16px;
      border-radius: 8px;
      border: 1px solid #d4c5a9;
      background: #fdfbf7;
      color: #2d2418;
      font-size: 1rem;
      cursor: pointer;
    }
    
    select option {
      background: #fdfbf7;
      color: #2d2418;
    }
    
    /* ë³µë¶™ ì…ë ¥ ì˜ì—­ */
    .paste-input-area {
      width: 100%;
      min-height: 80px;
      padding: 14px 16px;
      border-radius: 8px;
      border: 1px solid #d4c5a9;
      background: #fdfbf7;
      color: #2d2418;
      font-size: 0.95rem;
      font-family: 'Courier New', monospace;
      resize: vertical;
      line-height: 1.6;
    }
    .paste-input-area:focus {
      outline: none;
      border-color: #8b7355;
      box-shadow: 0 0 0 3px rgba(139, 115, 85, 0.1);
    }
    .paste-input-area::placeholder {
      color: #a09080;
    }
    .btn-paste {
      width: 100%;
      padding: 12px;
      margin-bottom: 12px;
      border: none;
      border-radius: 8px;
      background: linear-gradient(135deg, #e8e0d0 0%, #d8d0c0 100%);
      color: #5a4a3a;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-paste:hover {
      background: linear-gradient(135deg, #d8d0c0 0%, #c8c0b0 100%);
    }
    .parse-status {
      margin-top: 10px;
      padding: 10px 14px;
      border-radius: 8px;
      font-size: 0.85rem;
      display: none;
    }
    .parse-status.success {
      display: block;
      background: #e8f5e9;
      color: #2e7d32;
      border: 1px solid #a5d6a7;
    }
    .parse-status.error {
      display: block;
      background: #ffebee;
      color: #c62828;
      border: 1px solid #ef9a9a;
    }
    
    .btn-calculate {
      width: 100%;
      padding: 16px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(135deg, #8b7355 0%, #6b5744 100%);
      color: #fff;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .btn-calculate:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(107, 87, 68, 0.4);
    }
    
    .result-section {
      display: none;
    }
    
    .result-section.show {
      display: block;
    }
    
    .result-card {
      background: #fff;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 16px;
      border: 1px solid #e0d5c5;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    .result-card h3 {
      font-size: 1.2rem;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .result-card.my-info h3 {
      color: #4a7c59;
    }
    
    .result-card.inyeon h3 {
      color: #c75050;
    }
    
    .result-card.baewuja h3 {
      color: #8b5a9b;
    }
    
    .info-row {
      display: flex;
      margin-bottom: 8px;
      padding: 8px 12px;
      background: #f9f6ef;
      border-radius: 8px;
    }
    
    .info-label {
      color: #8b7a60;
      min-width: 100px;
    }
    
    .info-value {
      color: #2d2418;
      flex: 1;
    }
    
    .tag {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.85rem;
      margin-right: 6px;
      margin-bottom: 4px;
    }
    
    .tag.ohang {
      background: rgba(212, 175, 130, 0.3);
      color: #8b6914;
    }
    
    .tag.napeum {
      background: rgba(74, 124, 89, 0.2);
      color: #4a7c59;
    }
    
    .tag.bojo {
      background: rgba(139, 90, 155, 0.2);
      color: #8b5a9b;
    }
    
    .oemo-section {
      margin-top: 16px;
      padding: 16px;
      background: #f9f6ef;
      border-radius: 12px;
    }
    
    .oemo-section h4 {
      font-size: 0.95rem;
      color: #5a4a3a;
      margin-bottom: 12px;
    }
    
    .oemo-item {
      display: flex;
      margin-bottom: 6px;
    }
    
    .oemo-item-label {
      color: #8b7a60;
      min-width: 80px;
    }
    
    .oemo-item-value {
      color: #2d2418;
    }
    
    .candidates {
      margin-top: 12px;
    }
    
    .candidates-title {
      font-size: 0.85rem;
      color: #8b7a60;
      margin-bottom: 8px;
    }
    
    .flow-section {
      background: #f9f6ef;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 24px;
    }
    
    .flow-section h4 {
      color: #5a4a3a;
      margin-bottom: 12px;
      font-size: 0.9rem;
    }
    
    .flow-step {
      display: flex;
      align-items: center;
      padding: 8px 0;
      font-size: 0.9rem;
    }
    
    .flow-step .step-num {
      background: rgba(139, 115, 85, 0.3);
      color: #6b5744;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      margin-right: 12px;
    }
    
    .flow-step .arrow {
      color: #8b7a60;
      margin: 0 8px;
    }
  
    .copy-section {
      display: none;
      background: #fff;
      border-radius: 12px;
      padding: 24px;
      margin-top: 24px;
      border: 1px solid #e0d5c5;
    }
    
    .copy-section.show {
      display: block;
    }
    
    .copy-section h4 {
      color: #5a4a3a;
      margin-bottom: 16px;
      font-size: 0.95rem;
    }
    
    .copy-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }
    
    .btn-copy {
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      background: rgba(139, 115, 85, 0.2);
      color: #6b5744;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .btn-copy:hover {
      background: rgba(139, 115, 85, 0.4);
    }
    
    .btn-copy.btn-all {
      background: rgba(199, 80, 80, 0.2);
      color: #c75050;
    }
    
    .btn-copy.btn-all:hover {
      background: rgba(199, 80, 80, 0.4);
    }
    
    #copyTextarea {
      width: 100%;
      height: 200px;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #e0d5c5;
      background: #f9f6ef;
      color: #4a7c59;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 0.8rem;
      resize: vertical;
    }
    
    .copy-status {
      margin-top: 10px;
      font-size: 0.85rem;
      color: #8f8;
      min-height: 20px;
    }

  
    .detail-hint {
      font-size: 0.75rem;
      color: #8b7a60;
      margin-left: 8px;
    }

    .copy-status {
      color: #4a7c59;
    }

  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ’˜ ì¸ì—°ìƒ ê³„ì‚°ê¸°</h1>
      <p class="subtitle">Step 3 | ì¼ì£¼ ë‚©ìŒ ê¸°ë°˜ ìƒìƒÂ·ì—­ìƒìƒ ê³„ì‚°ë²•</p>
    </div>
    
    <div class="content-area">
    <div class="input-section">
      <div class="input-group">
        <label>ğŸ“¥ ì‚¬ì£¼ê³„ì‚°ê¸° ê²°ê³¼ ë¶™ì—¬ë„£ê¸°</label>
        <button class="btn-paste" onclick="pasteFromClipboard()">ğŸ“‹ í´ë¦½ë³´ë“œì—ì„œ ë¶™ì—¬ë„£ê¸°</button>
        <textarea id="pasteInput" class="paste-input-area" placeholder="ì‚¬ì£¼ê³„ì‚°ê¸°ì—ì„œ ë³µì‚¬í•œ ë‚´ìš©ì„ ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.

ì˜ˆì‹œ í˜•ì‹:
ì¼ì£¼: ç”²å­ | ë³¸ì¸ì„±ë³„: ë‚¨ | ìƒëŒ€ì„±ë³„: ì—¬

ë˜ëŠ” ì‚¬ì£¼ê³„ì‚°ê¸° ì „ì²´ ê²°ê³¼ë¥¼ ë¶™ì—¬ë„£ìœ¼ë©´ ìë™ íŒŒì‹±ë©ë‹ˆë‹¤."></textarea>
        <div id="parseStatus" class="parse-status"></div>
      </div>
      
      <button class="btn-calculate" onclick="calculate()">ğŸ”® ê³„ì‚°í•˜ê¸°</button>
    </div>
    
    <div class="result-section" id="resultSection">
      <div class="flow-section" id="flowSection"></div>
      
      <div class="result-card my-info" id="myInfoCard"></div>
      <div class="result-card inyeon" id="inyeonCard"></div>
      <div class="result-card baewuja" id="baewujaCard"></div>
    
      <!-- ê²°ê³¼ ë³µì‚¬ ì˜ì—­ -->
      <div class="copy-section" id="copySection">
        <h4>ğŸ“‹ ê²°ê³¼ ë³µì‚¬ (ì¸ì—°ìƒ ìƒì„±ê¸°ìš©)</h4>
        <button class="btn-copy btn-all" onclick="copyResult('all')" style="width:100%; margin-bottom:12px;">ğŸ“¦ ì „ì²´ ê²°ê³¼ ë³µì‚¬ â†’ Step 4</button>
        <textarea id="copyTextarea" readonly placeholder="ê³„ì‚° í›„ ë³µì‚¬ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”"></textarea>
        <div class="copy-status" id="copyStatus"></div>
      </div>

    </div>
    </div>
  </div>

  <script>

    // ì „ì—­ ê²°ê³¼ ì €ì¥ ë³€ìˆ˜
    let lastResult = null;
    
    // íŒŒì‹±ëœ ì…ë ¥ê°’ ì €ì¥
    let parsedInput = {
      ilju: null,
      myGender: null,
      targetGender: null
    };
    
    // 60ê°‘ì ëª©ë¡
    const ìœ¡ì‹­ê°‘ìëª©ë¡ = [
      'ç”²å­','ä¹™ä¸‘','ä¸™å¯…','ä¸å¯','æˆŠè¾°','å·±å·³','åºšåˆ','è¾›æœª','å£¬ç”³','ç™¸é…‰',
      'ç”²æˆŒ','ä¹™äº¥','ä¸™å­','ä¸ä¸‘','æˆŠå¯…','å·±å¯','åºšè¾°','è¾›å·³','å£¬åˆ','ç™¸æœª',
      'ç”²ç”³','ä¹™é…‰','ä¸™æˆŒ','ä¸äº¥','æˆŠå­','å·±ä¸‘','åºšå¯…','è¾›å¯','å£¬è¾°','ç™¸å·³',
      'ç”²åˆ','ä¹™æœª','ä¸™ç”³','ä¸é…‰','æˆŠæˆŒ','å·±äº¥','åºšå­','è¾›ä¸‘','å£¬å¯…','ç™¸å¯',
      'ç”²è¾°','ä¹™å·³','ä¸™åˆ','ä¸æœª','æˆŠç”³','å·±é…‰','åºšæˆŒ','è¾›äº¥','å£¬å­','ç™¸ä¸‘',
      'ç”²å¯…','ä¹™å¯','ä¸™è¾°','ä¸å·³','æˆŠåˆ','å·±æœª','åºšç”³','è¾›é…‰','å£¬æˆŒ','ç™¸äº¥'
    ];
    
    // í´ë¦½ë³´ë“œì—ì„œ ë¶™ì—¬ë„£ê¸°
    async function pasteFromClipboard() {
      try {
        const text = await navigator.clipboard.readText();
        document.getElementById('pasteInput').value = text;
        parseInput(text);
      } catch (err) {
        alert('í´ë¦½ë³´ë“œ ì ‘ê·¼ ì‹¤íŒ¨. ì§ì ‘ ë¶™ì—¬ë„£ê¸° í•´ì£¼ì„¸ìš”.');
      }
    }
    
    // ì…ë ¥ í…ìŠ¤íŠ¸ íŒŒì‹±
    function parseInput(text) {
      const statusEl = document.getElementById('parseStatus');
      
      if (!text || !text.trim()) {
        statusEl.className = 'parse-status';
        statusEl.textContent = '';
        parsedInput = { ilju: null, myGender: null, targetGender: null };
        return false;
      }
      
      // ì¼ì£¼ ì°¾ê¸° (60ê°‘ì ì¤‘ í•˜ë‚˜)
      let foundIlju = null;
      for (const gapja of ìœ¡ì‹­ê°‘ìëª©ë¡) {
        if (text.includes(gapja)) {
          // ì¼ì£¼: ç”²å­ í˜•ì‹ ìš°ì„ 
          const iljuMatch = text.match(new RegExp(`ì¼ì£¼[:\\s]*${gapja}`));
          if (iljuMatch) {
            foundIlju = gapja;
            break;
          }
        }
      }
      // ì¼ì£¼: í˜•ì‹ì´ ì—†ìœ¼ë©´ ì¼ê°„/ì¼ì§€ íŒ¨í„´ìœ¼ë¡œ ì°¾ê¸°
      if (!foundIlju) {
        const dayPillarMatch = text.match(/ì¼ê°„[:\s]*([ç”²ä¹™ä¸™ä¸æˆŠå·±åºšè¾›å£¬ç™¸])[^\n]*ì¼ì§€[:\s]*([å­ä¸‘å¯…å¯è¾°å·³åˆæœªç”³é…‰æˆŒäº¥])/);
        if (dayPillarMatch) {
          foundIlju = dayPillarMatch[1] + dayPillarMatch[2];
        }
      }
      // ê·¸ë˜ë„ ì—†ìœ¼ë©´ ì²« ë²ˆì§¸ ë°œê²¬ëœ 60ê°‘ì ì‚¬ìš©
      if (!foundIlju) {
        for (const gapja of ìœ¡ì‹­ê°‘ìëª©ë¡) {
          if (text.includes(gapja)) {
            foundIlju = gapja;
            break;
          }
        }
      }
      
      // ë³¸ì¸ ì„±ë³„ ì°¾ê¸°
      let foundMyGender = null;
      if (text.match(/ë³¸ì¸\s*ì„±ë³„[:\s]*(ë‚¨|ë‚¨ì„±|ë‚¨ì)/i) || text.match(/ì„±ë³„[:\s]*(ë‚¨|ë‚¨ì„±|ë‚¨ì)/i)) {
        foundMyGender = 'ë‚¨';
      } else if (text.match(/ë³¸ì¸\s*ì„±ë³„[:\s]*(ì—¬|ì—¬ì„±|ì—¬ì)/i) || text.match(/ì„±ë³„[:\s]*(ì—¬|ì—¬ì„±|ì—¬ì)/i)) {
        foundMyGender = 'ì—¬';
      }
      
      // ìƒëŒ€ ì„±ë³„ ì°¾ê¸°
      let foundTargetGender = null;
      if (text.match(/ìƒëŒ€\s*ì„±ë³„[:\s]*(ë‚¨|ë‚¨ì„±|ë‚¨ì)/i) || text.match(/ì°¾ëŠ”\s*ìƒëŒ€[:\s]*(ë‚¨|ë‚¨ì„±|ë‚¨ì)/i) || text.match(/ì¸ì—°\s*ì„±ë³„[:\s]*(ë‚¨|ë‚¨ì„±|ë‚¨ì)/i)) {
        foundTargetGender = 'ë‚¨';
      } else if (text.match(/ìƒëŒ€\s*ì„±ë³„[:\s]*(ì—¬|ì—¬ì„±|ì—¬ì)/i) || text.match(/ì°¾ëŠ”\s*ìƒëŒ€[:\s]*(ì—¬|ì—¬ì„±|ì—¬ì)/i) || text.match(/ì¸ì—°\s*ì„±ë³„[:\s]*(ì—¬|ì—¬ì„±|ì—¬ì)/i)) {
        foundTargetGender = 'ì—¬';
      } else if (text.match(/ìƒëŒ€\s*ì„±ë³„[:\s]*(ë‘˜\s*ë‹¤|ì–‘ìª½)/i) || text.match(/ì°¾ëŠ”\s*ìƒëŒ€[:\s]*(ë‘˜\s*ë‹¤|ì–‘ìª½)/i)) {
        foundTargetGender = 'ë‘˜ë‹¤';
      }
      
      // ë³¸ì¸ ì„±ë³„ ì—†ìœ¼ë©´ ìƒëŒ€ ì„±ë³„ ë°˜ëŒ€ë¡œ ì¶”ë¡ 
      if (!foundMyGender && foundTargetGender) {
        foundMyGender = foundTargetGender === 'ë‚¨' ? 'ì—¬' : 'ë‚¨';
      }
      // ìƒëŒ€ ì„±ë³„ ì—†ìœ¼ë©´ ë³¸ì¸ ì„±ë³„ ë°˜ëŒ€ë¡œ ì¶”ë¡ 
      if (!foundTargetGender && foundMyGender) {
        foundTargetGender = foundMyGender === 'ë‚¨' ? 'ì—¬' : 'ë‚¨';
      }
      
      parsedInput = {
        ilju: foundIlju,
        myGender: foundMyGender,
        targetGender: foundTargetGender
      };
      
      // ìƒíƒœ í‘œì‹œ
      if (foundIlju && foundMyGender && foundTargetGender) {
        statusEl.className = 'parse-status success';
        statusEl.innerHTML = `âœ… íŒŒì‹± ì„±ê³µ!<br>ì¼ì£¼: <strong>${foundIlju}</strong> | ë³¸ì¸: <strong>${foundMyGender}</strong> | ìƒëŒ€: <strong>${foundTargetGender}</strong>`;
        return true;
      } else {
        const missing = [];
        if (!foundIlju) missing.push('ì¼ì£¼');
        if (!foundMyGender) missing.push('ë³¸ì¸ì„±ë³„');
        if (!foundTargetGender) missing.push('ìƒëŒ€ì„±ë³„');
        statusEl.className = 'parse-status error';
        statusEl.innerHTML = `âš ï¸ ëˆ„ë½ëœ ì •ë³´: ${missing.join(', ')}<br>í˜•ì‹ ì˜ˆì‹œ: ì¼ì£¼: ç”²å­ | ë³¸ì¸ì„±ë³„: ë‚¨ | ìƒëŒ€ì„±ë³„: ì—¬`;
        return false;
      }
    }
    
    // textarea ì…ë ¥ì‹œ ìë™ íŒŒì‹±
    document.addEventListener('DOMContentLoaded', function() {
      const pasteInput = document.getElementById('pasteInput');
      if (pasteInput) {
        pasteInput.addEventListener('input', function() {
          parseInput(this.value);
        });
        pasteInput.addEventListener('paste', function(e) {
          setTimeout(() => parseInput(this.value), 100);
        });
      }
    });
    
    // ê²°ê³¼ ë³µì‚¬ í•¨ìˆ˜
    function copyResult(type) {
      if (!lastResult) {
        alert('ë¨¼ì € ê³„ì‚°ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”!');
        return;
      }
      
      let copyData;
      let label;
      
      if (type === 'inyeon') {
        copyData = lastResult.ì¸ì—°ìƒ;
        label = 'ì¸ì—°ìƒ';
      } else if (type === 'baewuja') {
        copyData = lastResult.ë°°ìš°ììƒ;
        label = 'ë°°ìš°ììƒ';
      } else {
        copyData = lastResult;
        label = 'ì „ì²´ ê²°ê³¼';
      }
      
      const jsonStr = JSON.stringify(copyData, null, 2);
      document.getElementById('copyTextarea').value = jsonStr;
      
      // í´ë¦½ë³´ë“œì— ë³µì‚¬
      navigator.clipboard.writeText(jsonStr).then(() => {
        document.getElementById('copyStatus').innerHTML = 
          `âœ… ${label} ë³µì‚¬ ì™„ë£Œ! (í´ë¦½ë³´ë“œì— ì €ì¥ë¨)`;
        setTimeout(() => {
          document.getElementById('copyStatus').innerHTML = '';
        }, 3000);
      }).catch(() => {
        document.getElementById('copyStatus').innerHTML = 
          `âš ï¸ ìë™ ë³µì‚¬ ì‹¤íŒ¨ - í…ìŠ¤íŠ¸ ì˜ì—­ì—ì„œ ì§ì ‘ ë³µì‚¬í•´ì£¼ì„¸ìš”`;
      });
    }

    // ===== ë°ì´í„° í…Œì´ë¸” (JSON ì›ë³¸ ê·¸ëŒ€ë¡œ) =====
    
    // 1. ê°‘ìë‚©ìŒë§¤í•‘ (60ê°‘ì)
    const ê°‘ìë‚©ìŒë§¤í•‘ = {
  "ç”²å­": {
    "ë‚©ìŒ": "í•´ì¤‘ê¸ˆ",
    "ë‚©ìŒí•œì": "æµ·ä¸­é‡‘",
    "ì˜¤í–‰": "ê¸ˆ"
  },
  "ä¹™ä¸‘": {
    "ë‚©ìŒ": "í•´ì¤‘ê¸ˆ",
    "ë‚©ìŒí•œì": "æµ·ä¸­é‡‘",
    "ì˜¤í–‰": "ê¸ˆ"
  },
  "ä¸™å¯…": {
    "ë‚©ìŒ": "ë…¸ì¤‘í™”",
    "ë‚©ìŒí•œì": "ç‚‰ä¸­ç«",
    "ì˜¤í–‰": "í™”"
  },
  "ä¸å¯": {
    "ë‚©ìŒ": "ë…¸ì¤‘í™”",
    "ë‚©ìŒí•œì": "ç‚‰ä¸­ç«",
    "ì˜¤í–‰": "í™”"
  },
  "æˆŠè¾°": {
    "ë‚©ìŒ": "ëŒ€ë¦¼ëª©",
    "ë‚©ìŒí•œì": "å¤§æ—æœ¨",
    "ì˜¤í–‰": "ëª©"
  },
  "å·±å·³": {
    "ë‚©ìŒ": "ëŒ€ë¦¼ëª©",
    "ë‚©ìŒí•œì": "å¤§æ—æœ¨",
    "ì˜¤í–‰": "ëª©"
  },
  "åºšåˆ": {
    "ë‚©ìŒ": "ë…¸ë°©í† ",
    "ë‚©ìŒí•œì": "è·¯å‚åœŸ",
    "ì˜¤í–‰": "í† "
  },
  "è¾›æœª": {
    "ë‚©ìŒ": "ë…¸ë°©í† ",
    "ë‚©ìŒí•œì": "è·¯å‚åœŸ",
    "ì˜¤í–‰": "í† "
  },
  "å£¬ç”³": {
    "ë‚©ìŒ": "ê²€ë´‰ê¸ˆ",
    "ë‚©ìŒí•œì": "åŠé‹’é‡‘",
    "ì˜¤í–‰": "ê¸ˆ"
  },
  "ç™¸é…‰": {
    "ë‚©ìŒ": "ê²€ë´‰ê¸ˆ",
    "ë‚©ìŒí•œì": "åŠé‹’é‡‘",
    "ì˜¤í–‰": "ê¸ˆ"
  },
  "ç”²æˆŒ": {
    "ë‚©ìŒ": "ì‚°ë‘í™”",
    "ë‚©ìŒí•œì": "å±±é ­ç«",
    "ì˜¤í–‰": "í™”"
  },
  "ä¹™äº¥": {
    "ë‚©ìŒ": "ì‚°ë‘í™”",
    "ë‚©ìŒí•œì": "å±±é ­ç«",
    "ì˜¤í–‰": "í™”"
  },
  "ä¸™å­": {
    "ë‚©ìŒ": "ê°„í•˜ìˆ˜",
    "ë‚©ìŒí•œì": "æ¾—ä¸‹æ°´",
    "ì˜¤í–‰": "ìˆ˜"
  },
  "ä¸ä¸‘": {
    "ë‚©ìŒ": "ê°„í•˜ìˆ˜",
    "ë‚©ìŒí•œì": "æ¾—ä¸‹æ°´",
    "ì˜¤í–‰": "ìˆ˜"
  },
  "æˆŠå¯…": {
    "ë‚©ìŒ": "ì„±ë‘í† ",
    "ë‚©ìŒí•œì": "åŸé ­åœŸ",
    "ì˜¤í–‰": "í† "
  },
  "å·±å¯": {
    "ë‚©ìŒ": "ì„±ë‘í† ",
    "ë‚©ìŒí•œì": "åŸé ­åœŸ",
    "ì˜¤í–‰": "í† "
  },
  "åºšè¾°": {
    "ë‚©ìŒ": "ë°±ë‚©ê¸ˆ",
    "ë‚©ìŒí•œì": "ç™½è Ÿé‡‘",
    "ì˜¤í–‰": "ê¸ˆ"
  },
  "è¾›å·³": {
    "ë‚©ìŒ": "ë°±ë‚©ê¸ˆ",
    "ë‚©ìŒí•œì": "ç™½è Ÿé‡‘",
    "ì˜¤í–‰": "ê¸ˆ"
  },
  "å£¬åˆ": {
    "ë‚©ìŒ": "ì–‘ë¥˜ëª©",
    "ë‚©ìŒí•œì": "æ¥ŠæŸ³æœ¨",
    "ì˜¤í–‰": "ëª©"
  },
  "ç™¸æœª": {
    "ë‚©ìŒ": "ì–‘ë¥˜ëª©",
    "ë‚©ìŒí•œì": "æ¥ŠæŸ³æœ¨",
    "ì˜¤í–‰": "ëª©"
  },
  "ç”²ç”³": {
    "ë‚©ìŒ": "ì²œì¤‘ìˆ˜",
    "ë‚©ìŒí•œì": "æ³‰ä¸­æ°´",
    "ì˜¤í–‰": "ìˆ˜"
  },
  "ä¹™é…‰": {
    "ë‚©ìŒ": "ì²œì¤‘ìˆ˜",
    "ë‚©ìŒí•œì": "æ³‰ä¸­æ°´",
    "ì˜¤í–‰": "ìˆ˜"
  },
  "ä¸™æˆŒ": {
    "ë‚©ìŒ": "ì˜¥ìƒí† ",
    "ë‚©ìŒí•œì": "å±‹ä¸ŠåœŸ",
    "ì˜¤í–‰": "í† "
  },
  "ä¸äº¥": {
    "ë‚©ìŒ": "ì˜¥ìƒí† ",
    "ë‚©ìŒí•œì": "å±‹ä¸ŠåœŸ",
    "ì˜¤í–‰": "í† "
  },
  "æˆŠå­": {
    "ë‚©ìŒ": "ë²½ë ¥í™”",
    "ë‚©ìŒí•œì": "éœ¹é‚ç«",
    "ì˜¤í–‰": "í™”"
  },
  "å·±ä¸‘": {
    "ë‚©ìŒ": "ë²½ë ¥í™”",
    "ë‚©ìŒí•œì": "éœ¹é‚ç«",
    "ì˜¤í–‰": "í™”"
  },
  "åºšå¯…": {
    "ë‚©ìŒ": "ì†¡ë°±ëª©",
    "ë‚©ìŒí•œì": "æ¾æŸæœ¨",
    "ì˜¤í–‰": "ëª©"
  },
  "è¾›å¯": {
    "ë‚©ìŒ": "ì†¡ë°±ëª©",
    "ë‚©ìŒí•œì": "æ¾æŸæœ¨",
    "ì˜¤í–‰": "ëª©"
  },
  "å£¬è¾°": {
    "ë‚©ìŒ": "ì¥ë¥˜ìˆ˜",
    "ë‚©ìŒí•œì": "é•·æµæ°´",
    "ì˜¤í–‰": "ìˆ˜"
  },
  "ç™¸å·³": {
    "ë‚©ìŒ": "ì¥ë¥˜ìˆ˜",
    "ë‚©ìŒí•œì": "é•·æµæ°´",
    "ì˜¤í–‰": "ìˆ˜"
  },
  "ç”²åˆ": {
    "ë‚©ìŒ": "ì‚¬ì¤‘ê¸ˆ",
    "ë‚©ìŒí•œì": "æ²™ä¸­é‡‘",
    "ì˜¤í–‰": "ê¸ˆ"
  },
  "ä¹™æœª": {
    "ë‚©ìŒ": "ì‚¬ì¤‘ê¸ˆ",
    "ë‚©ìŒí•œì": "æ²™ä¸­é‡‘",
    "ì˜¤í–‰": "ê¸ˆ"
  },
  "ä¸™ç”³": {
    "ë‚©ìŒ": "ì‚°í•˜í™”",
    "ë‚©ìŒí•œì": "å±±ä¸‹ç«",
    "ì˜¤í–‰": "í™”"
  },
  "ä¸é…‰": {
    "ë‚©ìŒ": "ì‚°í•˜í™”",
    "ë‚©ìŒí•œì": "å±±ä¸‹ç«",
    "ì˜¤í–‰": "í™”"
  },
  "æˆŠæˆŒ": {
    "ë‚©ìŒ": "í‰ì§€ëª©",
    "ë‚©ìŒí•œì": "å¹³åœ°æœ¨",
    "ì˜¤í–‰": "ëª©"
  },
  "å·±äº¥": {
    "ë‚©ìŒ": "í‰ì§€ëª©",
    "ë‚©ìŒí•œì": "å¹³åœ°æœ¨",
    "ì˜¤í–‰": "ëª©"
  },
  "åºšå­": {
    "ë‚©ìŒ": "ë²½ìƒí† ",
    "ë‚©ìŒí•œì": "å£ä¸ŠåœŸ",
    "ì˜¤í–‰": "í† "
  },
  "è¾›ä¸‘": {
    "ë‚©ìŒ": "ë²½ìƒí† ",
    "ë‚©ìŒí•œì": "å£ä¸ŠåœŸ",
    "ì˜¤í–‰": "í† "
  },
  "å£¬å¯…": {
    "ë‚©ìŒ": "ê¸ˆë°•ê¸ˆ",
    "ë‚©ìŒí•œì": "é‡‘ç®”é‡‘",
    "ì˜¤í–‰": "ê¸ˆ"
  },
  "ç™¸å¯": {
    "ë‚©ìŒ": "ê¸ˆë°•ê¸ˆ",
    "ë‚©ìŒí•œì": "é‡‘ç®”é‡‘",
    "ì˜¤í–‰": "ê¸ˆ"
  },
  "ç”²è¾°": {
    "ë‚©ìŒ": "ë³µë“±í™”",
    "ë‚©ìŒí•œì": "è¦†ç‡ˆç«",
    "ì˜¤í–‰": "í™”"
  },
  "ä¹™å·³": {
    "ë‚©ìŒ": "ë³µë“±í™”",
    "ë‚©ìŒí•œì": "è¦†ç‡ˆç«",
    "ì˜¤í–‰": "í™”"
  },
  "ä¸™åˆ": {
    "ë‚©ìŒ": "ì²œí•˜ìˆ˜",
    "ë‚©ìŒí•œì": "å¤©æ²³æ°´",
    "ì˜¤í–‰": "ìˆ˜"
  },
  "ä¸æœª": {
    "ë‚©ìŒ": "ì²œí•˜ìˆ˜",
    "ë‚©ìŒí•œì": "å¤©æ²³æ°´",
    "ì˜¤í–‰": "ìˆ˜"
  },
  "æˆŠç”³": {
    "ë‚©ìŒ": "ëŒ€ì—­í† ",
    "ë‚©ìŒí•œì": "å¤§é©›åœŸ",
    "ì˜¤í–‰": "í† "
  },
  "å·±é…‰": {
    "ë‚©ìŒ": "ëŒ€ì—­í† ",
    "ë‚©ìŒí•œì": "å¤§é©›åœŸ",
    "ì˜¤í–‰": "í† "
  },
  "åºšæˆŒ": {
    "ë‚©ìŒ": "ì°¨ì²œê¸ˆ",
    "ë‚©ìŒí•œì": "é‡µé‡§é‡‘",
    "ì˜¤í–‰": "ê¸ˆ"
  },
  "è¾›äº¥": {
    "ë‚©ìŒ": "ì°¨ì²œê¸ˆ",
    "ë‚©ìŒí•œì": "é‡µé‡§é‡‘",
    "ì˜¤í–‰": "ê¸ˆ"
  },
  "å£¬å­": {
    "ë‚©ìŒ": "ìƒìëª©",
    "ë‚©ìŒí•œì": "æ¡‘æ‹“æœ¨",
    "ì˜¤í–‰": "ëª©"
  },
  "ç™¸ä¸‘": {
    "ë‚©ìŒ": "ìƒìëª©",
    "ë‚©ìŒí•œì": "æ¡‘æ‹“æœ¨",
    "ì˜¤í–‰": "ëª©"
  },
  "ç”²å¯…": {
    "ë‚©ìŒ": "ëŒ€ê³„ìˆ˜",
    "ë‚©ìŒí•œì": "å¤§æºªæ°´",
    "ì˜¤í–‰": "ìˆ˜"
  },
  "ä¹™å¯": {
    "ë‚©ìŒ": "ëŒ€ê³„ìˆ˜",
    "ë‚©ìŒí•œì": "å¤§æºªæ°´",
    "ì˜¤í–‰": "ìˆ˜"
  },
  "ä¸™è¾°": {
    "ë‚©ìŒ": "ì‚¬ì¤‘í† ",
    "ë‚©ìŒí•œì": "æ²™ä¸­åœŸ",
    "ì˜¤í–‰": "í† "
  },
  "ä¸å·³": {
    "ë‚©ìŒ": "ì‚¬ì¤‘í† ",
    "ë‚©ìŒí•œì": "æ²™ä¸­åœŸ",
    "ì˜¤í–‰": "í† "
  },
  "æˆŠåˆ": {
    "ë‚©ìŒ": "ì²œìƒí™”",
    "ë‚©ìŒí•œì": "å¤©ä¸Šç«",
    "ì˜¤í–‰": "í™”"
  },
  "å·±æœª": {
    "ë‚©ìŒ": "ì²œìƒí™”",
    "ë‚©ìŒí•œì": "å¤©ä¸Šç«",
    "ì˜¤í–‰": "í™”"
  },
  "åºšç”³": {
    "ë‚©ìŒ": "ì„ë¥˜ëª©",
    "ë‚©ìŒí•œì": "çŸ³æ¦´æœ¨",
    "ì˜¤í–‰": "ëª©"
  },
  "è¾›é…‰": {
    "ë‚©ìŒ": "ì„ë¥˜ëª©",
    "ë‚©ìŒí•œì": "çŸ³æ¦´æœ¨",
    "ì˜¤í–‰": "ëª©"
  },
  "å£¬æˆŒ": {
    "ë‚©ìŒ": "ëŒ€í•´ìˆ˜",
    "ë‚©ìŒí•œì": "å¤§æµ·æ°´",
    "ì˜¤í–‰": "ìˆ˜"
  },
  "ç™¸äº¥": {
    "ë‚©ìŒ": "ëŒ€í•´ìˆ˜",
    "ë‚©ìŒí•œì": "å¤§æµ·æ°´",
    "ì˜¤í–‰": "ìˆ˜"
  }
};
    
    // 2. ì˜¤í–‰ìƒìƒê´€ê³„
    const ì˜¤í–‰ìƒìƒê´€ê³„ = {
  "ëª©": {
    "ì¸ì—°ìƒì˜¤í–‰": "í™”",
    "ë°°ìš°ììƒì˜¤í–‰": "ìˆ˜"
  },
  "í™”": {
    "ì¸ì—°ìƒì˜¤í–‰": "í† ",
    "ë°°ìš°ììƒì˜¤í–‰": "ëª©"
  },
  "í† ": {
    "ì¸ì—°ìƒì˜¤í–‰": "ê¸ˆ",
    "ë°°ìš°ììƒì˜¤í–‰": "í™”"
  },
  "ê¸ˆ": {
    "ì¸ì—°ìƒì˜¤í–‰": "ìˆ˜",
    "ë°°ìš°ììƒì˜¤í–‰": "í† "
  },
  "ìˆ˜": {
    "ì¸ì—°ìƒì˜¤í–‰": "ëª©",
    "ë°°ìš°ììƒì˜¤í–‰": "ê¸ˆ"
  }
};
    
    // 3. ë‚©ìŒë§ˆìŠ¤í„° (30ê°œ)
    const ë‚©ìŒë§ˆìŠ¤í„° = {
  "í•´ì¤‘ê¸ˆ": {
    "ì˜¤í–‰": "ê¸ˆ",
    "í•œì": "æµ·ä¸­é‡‘",
    "ì¬ì§ˆ": "ë°”ë‹¤ ì†ì˜ ê¸ˆì†",
    "ëŒ€í‘œë‚©ìŒ": true,
    "ë³´ì¡°ìˆœìœ„": 1
  },
  "ê²€ë´‰ê¸ˆ": {
    "ì˜¤í–‰": "ê¸ˆ",
    "í•œì": "åŠé‹’é‡‘",
    "ì¬ì§ˆ": "ì¹¼ë‚ ì˜ ê¸ˆì†",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 2
  },
  "ì‚¬ì¤‘ê¸ˆ": {
    "ì˜¤í–‰": "ê¸ˆ",
    "í•œì": "æ²™ä¸­é‡‘",
    "ì¬ì§ˆ": "ëª¨ë˜ ì†ì˜ ê¸ˆ",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 3
  },
  "ë°±ë‚©ê¸ˆ": {
    "ì˜¤í–‰": "ê¸ˆ",
    "í•œì": "ç™½è Ÿé‡‘",
    "ì¬ì§ˆ": "í•˜ì–€ ê¸ˆì†",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 4
  },
  "ì°¨ì²œê¸ˆ": {
    "ì˜¤í–‰": "ê¸ˆ",
    "í•œì": "é‡µé‡§é‡‘",
    "ì¬ì§ˆ": "ì¥ì‹ ê¸ˆ",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 5
  },
  "ê¸ˆë°•ê¸ˆ": {
    "ì˜¤í–‰": "ê¸ˆ",
    "í•œì": "é‡‘ç®”é‡‘",
    "ì¬ì§ˆ": "ê¸ˆë°•",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 6
  },
  "ë…¸ì¤‘í™”": {
    "ì˜¤í–‰": "í™”",
    "í•œì": "ç‚‰ä¸­ç«",
    "ì¬ì§ˆ": "í™”ë¡œ ì†ì˜ ë¶ˆ",
    "ëŒ€í‘œë‚©ìŒ": true,
    "ë³´ì¡°ìˆœìœ„": 1
  },
  "ì‚°ë‘í™”": {
    "ì˜¤í–‰": "í™”",
    "í•œì": "å±±é ­ç«",
    "ì¬ì§ˆ": "ì‚°ì˜ ë¶ˆ",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 2
  },
  "ë³µë“±í™”": {
    "ì˜¤í–‰": "í™”",
    "í•œì": "è¦†ç‡ˆç«",
    "ì¬ì§ˆ": "ë“±ë¶ˆì˜ ë¶ˆ",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 3
  },
  "ì²œìƒí™”": {
    "ì˜¤í–‰": "í™”",
    "í•œì": "å¤©ä¸Šç«",
    "ì¬ì§ˆ": "í•˜ëŠ˜ì˜ ë¶ˆ",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 4
  },
  "ë²½ë ¥í™”": {
    "ì˜¤í–‰": "í™”",
    "í•œì": "éœ¹é‚ç«",
    "ì¬ì§ˆ": "ë²ˆê°œì˜ ë¶ˆ",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 5
  },
  "ì‚°í•˜í™”": {
    "ì˜¤í–‰": "í™”",
    "í•œì": "å±±ä¸‹ç«",
    "ì¬ì§ˆ": "ì‚° ì•„ë˜ ë¶ˆ",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 6
  },
  "ë…¸ë°©í† ": {
    "ì˜¤í–‰": "í† ",
    "í•œì": "è·¯å‚åœŸ",
    "ì¬ì§ˆ": "ê¸¸ê°€ì˜ í™",
    "ëŒ€í‘œë‚©ìŒ": true,
    "ë³´ì¡°ìˆœìœ„": 1
  },
  "ì„±ë‘í† ": {
    "ì˜¤í–‰": "í† ",
    "í•œì": "åŸé ­åœŸ",
    "ì¬ì§ˆ": "ì„±ë²½ì˜ í™",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 2
  },
  "ëŒ€ì—­í† ": {
    "ì˜¤í–‰": "í† ",
    "í•œì": "å¤§é©›åœŸ",
    "ì¬ì§ˆ": "ì—­í„°ì˜ í™",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 3
  },
  "ë²½ìƒí† ": {
    "ì˜¤í–‰": "í† ",
    "í•œì": "å£ä¸ŠåœŸ",
    "ì¬ì§ˆ": "ë‹´ë²¼ë½ì˜ í™",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 4
  },
  "ì‚¬ì¤‘í† ": {
    "ì˜¤í–‰": "í† ",
    "í•œì": "æ²™ä¸­åœŸ",
    "ì¬ì§ˆ": "ëª¨ë˜ ì†ì˜ í™",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 5
  },
  "ì˜¥ìƒí† ": {
    "ì˜¤í–‰": "í† ",
    "í•œì": "å±‹ä¸ŠåœŸ",
    "ì¬ì§ˆ": "ì§€ë¶•ì˜ í™",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 6
  },
  "ëŒ€ë¦¼ëª©": {
    "ì˜¤í–‰": "ëª©",
    "í•œì": "å¤§æ—æœ¨",
    "ì¬ì§ˆ": "í° ìˆ²ì˜ ë‚˜ë¬´",
    "ëŒ€í‘œë‚©ìŒ": true,
    "ë³´ì¡°ìˆœìœ„": 1
  },
  "ì†¡ë°±ëª©": {
    "ì˜¤í–‰": "ëª©",
    "í•œì": "æ¾æŸæœ¨",
    "ì¬ì§ˆ": "ì†Œë‚˜ë¬´",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 2
  },
  "ì„ë¥˜ëª©": {
    "ì˜¤í–‰": "ëª©",
    "í•œì": "çŸ³æ¦´æœ¨",
    "ì¬ì§ˆ": "ì„ë¥˜ë‚˜ë¬´",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 3
  },
  "ì–‘ë¥˜ëª©": {
    "ì˜¤í–‰": "ëª©",
    "í•œì": "æ¥ŠæŸ³æœ¨",
    "ì¬ì§ˆ": "ë²„ë“œë‚˜ë¬´",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 4
  },
  "ìƒìëª©": {
    "ì˜¤í–‰": "ëª©",
    "í•œì": "æ¡‘æ‹“æœ¨",
    "ì¬ì§ˆ": "ë½•ë‚˜ë¬´",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 5
  },
  "í‰ì§€ëª©": {
    "ì˜¤í–‰": "ëª©",
    "í•œì": "å¹³åœ°æœ¨",
    "ì¬ì§ˆ": "í‰ì›ì˜ ë‚˜ë¬´",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 6
  },
  "ëŒ€í•´ìˆ˜": {
    "ì˜¤í–‰": "ìˆ˜",
    "í•œì": "å¤§æµ·æ°´",
    "ì¬ì§ˆ": "ë°”ë‹¤ì˜ ë¬¼",
    "ëŒ€í‘œë‚©ìŒ": true,
    "ë³´ì¡°ìˆœìœ„": 1
  },
  "ì²œí•˜ìˆ˜": {
    "ì˜¤í–‰": "ìˆ˜",
    "í•œì": "å¤©æ²³æ°´",
    "ì¬ì§ˆ": "í•˜ëŠ˜ì˜ ê°•ë¬¼",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 2
  },
  "ì¥ë¥˜ìˆ˜": {
    "ì˜¤í–‰": "ìˆ˜",
    "í•œì": "é•·æµæ°´",
    "ì¬ì§ˆ": "ê¸´ ê°•ì˜ ë¬¼",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 3
  },
  "ì²œì¤‘ìˆ˜": {
    "ì˜¤í–‰": "ìˆ˜",
    "í•œì": "æ³‰ä¸­æ°´",
    "ì¬ì§ˆ": "ìƒ˜ë¬¼",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 4
  },
  "ëŒ€ê³„ìˆ˜": {
    "ì˜¤í–‰": "ìˆ˜",
    "í•œì": "å¤§æºªæ°´",
    "ì¬ì§ˆ": "í° ê³„ê³¡ì˜ ë¬¼",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 5
  },
  "ê°„í•˜ìˆ˜": {
    "ì˜¤í–‰": "ìˆ˜",
    "í•œì": "æ¾—ä¸‹æ°´",
    "ì¬ì§ˆ": "ê³„ê³¡ì˜ ë¬¼",
    "ëŒ€í‘œë‚©ìŒ": false,
    "ë³´ì¡°ìˆœìœ„": 6
  }
};
    
    // ===== ì²œê°„ ì˜¤í–‰ ë§¤í•‘ =====
    const ì²œê°„ì˜¤í–‰ = {
      "ç”²": "ëª©", "ä¹™": "ëª©",
      "ä¸™": "í™”", "ä¸": "í™”",
      "æˆŠ": "í† ", "å·±": "í† ",
      "åºš": "ê¸ˆ", "è¾›": "ê¸ˆ",
      "å£¬": "ìˆ˜", "ç™¸": "ìˆ˜"
    };

    
    // ===== ìœ¡í•© ë§¤í•‘ (ì„±ê²© ë„ì¶œìš©) =====
    const ìœ¡í•©ë§¤í•‘ = {
      "å­": { "ìœ¡í•©ì§€ì§€": "ä¸‘", "ì¸ì—°ìœ í˜•": "ì‹ ë¢°ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ì•ˆì •, ì‹ ë¢°, ì„±ì‹¤, ê¾¸ì¤€í•¨" },
      "ä¸‘": { "ìœ¡í•©ì§€ì§€": "å­", "ì¸ì—°ìœ í˜•": "ì§€í˜œì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ì§€í˜œ, ì°¨ë¶„í•¨, ë¶„ì„ë ¥, ê°ì„±" },
      "å¯…": { "ìœ¡í•©ì§€ì§€": "äº¥", "ì¸ì—°ìœ í˜•": "ê°ë™ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "í¬ìš©, ì´í•´, ê¹Šì€ ê°ì„±, ë°°ë ¤" },
      "å¯": { "ìœ¡í•©ì§€ì§€": "æˆŒ", "ì¸ì—°ìœ í˜•": "ì¶©ì„±ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ì˜ë¦¬, ë³´í˜¸, í—Œì‹ , ë¯¿ìŒì§" },
      "è¾°": { "ìœ¡í•©ì§€ì§€": "é…‰", "ì¸ì—°ìœ í˜•": "ì„¸ë ¨ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ë””í…Œì¼, í’ˆê²©, ì™„ë²½ì£¼ì˜, ì„¸ì‹¬" },
      "å·³": { "ìœ¡í•©ì§€ì§€": "ç”³", "ì¸ì—°ìœ í˜•": "ì§€ì„±ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ë˜‘ë˜’, ë…¼ë¦¬ì , ì†Œí†µ, ì¬ì¹˜" },
      "åˆ": { "ìœ¡í•©ì§€ì§€": "æœª", "ì¸ì—°ìœ í˜•": "í¬ìš©ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ë„ˆê·¸ëŸ¬ì›€, ì¤‘ì¬, ì¡°í™”, í‰í™”" },
      "æœª": { "ìœ¡í•©ì§€ì§€": "åˆ", "ì¸ì—°ìœ í˜•": "ì—ë„ˆì§€ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ì—´ì •, í™œë ¥, ê¸ì •, ì¶”ì§„ë ¥" },
      "ç”³": { "ìœ¡í•©ì§€ì§€": "å·³", "ì¸ì—°ìœ í˜•": "í†µì°°ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ì§ê´€, ì˜ì , í†µì°°ë ¥, ê¹Šì´" },
      "é…‰": { "ìœ¡í•©ì§€ì§€": "è¾°", "ì¸ì—°ìœ í˜•": "ë¹„ì „ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ì•¼ë§, ë„ì „, ë¦¬ë”ì‹­, ì°½ì˜" },
      "æˆŒ": { "ìœ¡í•©ì§€ì§€": "å¯", "ì¸ì—°ìœ í˜•": "ê°ì„±ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ì˜ˆìˆ ì , ê³µê°, ì„¬ì„¸í•¨, ê°ìˆ˜ì„±" },
      "äº¥": { "ìœ¡í•©ì§€ì§€": "å¯…", "ì¸ì—°ìœ í˜•": "ì—´ì •ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ì¶”ì§„ë ¥, ë¦¬ë”ì‹­, ì¹´ë¦¬ìŠ¤ë§ˆ, ë³´í˜¸" }
    };


    // ===== ì˜¤í–‰ â†’ ëŒ€í‘œì§€ì§€ ë§¤í•‘ (ë°°ìš°ììƒ ì„±ê²©ìš©) =====
    const ì˜¤í–‰ëŒ€í‘œì§€ì§€ = {
      "ëª©": { "ëŒ€í‘œì§€ì§€": "å¯", "ì¸ì—°ìœ í˜•": "ê°ì„±ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ì˜ˆìˆ ì , ê³µê°ë ¥, ì„¬ì„¸í•¨, ê°ìˆ˜ì„±" },
      "í™”": { "ëŒ€í‘œì§€ì§€": "åˆ", "ì¸ì—°ìœ í˜•": "ì—ë„ˆì§€ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ì—´ì •, ë‚™ì²œì , í™œë ¥, ê¸ì •" },
      "í† ": { "ëŒ€í‘œì§€ì§€": "æˆŒ", "ì¸ì—°ìœ í˜•": "ì¶©ì„±ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ì˜ë¦¬, ì‹ ë¢°, ë³´í˜¸, í—Œì‹ " },
      "ê¸ˆ": { "ëŒ€í‘œì§€ì§€": "é…‰", "ì¸ì—°ìœ í˜•": "ì„¸ë ¨ì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ë””í…Œì¼, í’ˆê²©, ì™„ë²½ì£¼ì˜, ì„¸ì‹¬" },
      "ìˆ˜": { "ëŒ€í‘œì§€ì§€": "å­", "ì¸ì—°ìœ í˜•": "ì§€í˜œì˜ ì¸ì—°", "í‚¤ì›Œë“œ": "ì°¨ë¶„í•¨, ì´ì„±ì , ë¶„ì„ë ¥, ê¹Šì´" }
    };

// ===== ìŒëŒ€ ë‚©ìŒ ë§¤í•‘ =====
    const ìŒëŒ€ë‚©ìŒë§¤í•‘ = {
      "í•´ì¤‘ê¸ˆ": "ëŒ€í•´ìˆ˜", "ê²€ë´‰ê¸ˆ": "ì„±ë‘í† ", "ì‚¬ì¤‘ê¸ˆ": "ì¥ë¥˜ìˆ˜", "ë°±ë‚©ê¸ˆ": "ì²œì¤‘ìˆ˜", "ì°¨ì²œê¸ˆ": null, "ê¸ˆë°•ê¸ˆ": null,
      "ëŒ€ë¦¼ëª©": "ë…¸ì¤‘í™”", "ì†¡ë°±ëª©": "ë³µë“±í™”", "ì„ë¥˜ëª©": "ë…¸ì¤‘í™”", "ì–‘ë¥˜ëª©": null, "ìƒìëª©": null, "í‰ì§€ëª©": "ë²½ìƒí† ",
      "ëŒ€í•´ìˆ˜": "í•´ì¤‘ê¸ˆ", "ì²œí•˜ìˆ˜": "ì‚¬ì¤‘ê¸ˆ", "ì¥ë¥˜ìˆ˜": "ì‚¬ì¤‘ê¸ˆ", "ì²œì¤‘ìˆ˜": "ë°±ë‚©ê¸ˆ", "ëŒ€ê³„ìˆ˜": null, "ê°„í•˜ìˆ˜": null,
      "ë…¸ì¤‘í™”": "ëŒ€ë¦¼ëª©", "ì‚°ë‘í™”": "ë…¸ë°©í† ", "ë³µë“±í™”": "ì†¡ë°±ëª©", "ì²œìƒí™”": "ì‚¬ì¤‘í† ", "ë²½ë ¥í™”": null, "ì‚°í•˜í™”": null,
      "ë…¸ë°©í† ": "ì‚°ë‘í™”", "ì„±ë‘í† ": "ê²€ë´‰ê¸ˆ", "ëŒ€ì—­í† ": "ì²œí•˜ìˆ˜", "ë²½ìƒí† ": "í‰ì§€ëª©", "ì‚¬ì¤‘í† ": "ì²œìƒí™”", "ì˜¥ìƒí† ": null
    };
    
    // ===== ë‚©ìŒ ê³„ì ˆ ì†ì„± =====
    const ë‚©ìŒê³„ì ˆê°’ = {
      "í•´ì¤‘ê¸ˆ": 4, "ê²€ë´‰ê¸ˆ": 3, "ì‚¬ì¤‘ê¸ˆ": 3, "ë°±ë‚©ê¸ˆ": 3, "ì°¨ì²œê¸ˆ": 3, "ê¸ˆë°•ê¸ˆ": 3.5,
      "ëŒ€ë¦¼ëª©": 1, "ì†¡ë°±ëª©": 4, "ì„ë¥˜ëª©": 2, "ì–‘ë¥˜ëª©": 1, "ìƒìëª©": 2, "í‰ì§€ëª©": 1,
      "ëŒ€í•´ìˆ˜": 4, "ì²œí•˜ìˆ˜": 3.5, "ì¥ë¥˜ìˆ˜": 1, "ì²œì¤‘ìˆ˜": 2, "ëŒ€ê³„ìˆ˜": 2.5, "ê°„í•˜ìˆ˜": 2,
      "ë…¸ì¤‘í™”": 2, "ì‚°ë‘í™”": 2.5, "ë³µë“±í™”": 3, "ì²œìƒí™”": 2, "ë²½ë ¥í™”": 3, "ì‚°í•˜í™”": 2,
      "ë…¸ë°©í† ": 2.5, "ì„±ë‘í† ": 2.5, "ëŒ€ì—­í† ": 3, "ë²½ìƒí† ": 3, "ì‚¬ì¤‘í† ": 2, "ì˜¥ìƒí† ": 2.8
    };
    
    // ===== ë™ê¸° ë‚©ìŒ ìš°ì„ ìˆœìœ„ =====
    const ë™ê¸°ë‚©ìŒìš°ì„ ìˆœìœ„ = {
      "ê¸ˆ": ["í•´ì¤‘ê¸ˆ", "ê²€ë´‰ê¸ˆ", "ì‚¬ì¤‘ê¸ˆ", "ë°±ë‚©ê¸ˆ", "ì°¨ì²œê¸ˆ", "ê¸ˆë°•ê¸ˆ"],
      "ëª©": ["ëŒ€ë¦¼ëª©", "ì†¡ë°±ëª©", "ì„ë¥˜ëª©", "í‰ì§€ëª©", "ìƒìëª©", "ì–‘ë¥˜ëª©"],
      "ìˆ˜": ["ëŒ€í•´ìˆ˜", "ì²œí•˜ìˆ˜", "ì¥ë¥˜ìˆ˜", "ì²œì¤‘ìˆ˜", "ëŒ€ê³„ìˆ˜", "ê°„í•˜ìˆ˜"],
      "í™”": ["ë…¸ì¤‘í™”", "ì‚°ë‘í™”", "ë³µë“±í™”", "ì²œìƒí™”", "ë²½ë ¥í™”", "ì‚°í•˜í™”"],
      "í† ": ["ë…¸ë°©í† ", "ì„±ë‘í† ", "ëŒ€ì—­í† ", "ë²½ìƒí† ", "ì‚¬ì¤‘í† ", "ì˜¥ìƒí† "]
    };
    
    // ===== ëŒ€í‘œ ë…„ì£¼ ë‚©ìŒ ì„ ì • í•¨ìˆ˜ =====
    function getê³„ì ˆê·¼ì ‘ì„±(napeum1, napeum2) {
      const s1 = ë‚©ìŒê³„ì ˆê°’[napeum1];
      const s2 = ë‚©ìŒê³„ì ˆê°’[napeum2];
      if (s1 === undefined || s2 === undefined) return 999;
      let diff = Math.abs(s1 - s2);
      if (diff > 2) diff = 4 - diff;
      return diff;
    }
    
    function selectëŒ€í‘œë…„ì£¼ë‚©ìŒ(myNapeum, targetOhang) {
      const ë…„ì£¼í›„ë³´ì „ì²´ = ë™ê¸°ë‚©ìŒìš°ì„ ìˆœìœ„[targetOhang];
      if (!ë…„ì£¼í›„ë³´ì „ì²´) return { ëŒ€í‘œë‚©ìŒ: null, ë³´ì¡°í›„ë³´: [], ì„ ì •ì´ìœ : "ì˜¤í–‰ì—†ìŒ", ë…„ì£¼í›„ë³´ì „ì²´: [] };
      
      // ìŒëŒ€ ë‚©ìŒ ì²´í¬ (ìµœìš°ì„ )
      const ë‚´ìŒëŒ€ = ìŒëŒ€ë‚©ìŒë§¤í•‘[myNapeum];
      if (ë‚´ìŒëŒ€ && ë…„ì£¼í›„ë³´ì „ì²´.includes(ë‚´ìŒëŒ€)) {
        const ë³´ì¡° = ë…„ì£¼í›„ë³´ì „ì²´.filter(n => n !== ë‚´ìŒëŒ€).slice(0, 2);
        return { ëŒ€í‘œë‚©ìŒ: ë‚´ìŒëŒ€, ë³´ì¡°í›„ë³´: ë³´ì¡°, ì„ ì •ì´ìœ : "ìŒëŒ€ë‚©ìŒ", ë…„ì£¼í›„ë³´ì „ì²´ };
      }
      
      // ë™ê¸° ìš°ì„ ìˆœìœ„ + ê³„ì ˆ ê·¼ì ‘ì„± ì¡°í•©
      const í›„ë³´ì ìˆ˜ = ë…„ì£¼í›„ë³´ì „ì²´.map((napeum, idx) => {
        const ê³„ì ˆì°¨ì´ = getê³„ì ˆê·¼ì ‘ì„±(myNapeum, napeum);
        const ì ìˆ˜ = idx * 2 + ê³„ì ˆì°¨ì´;
        return { napeum, ì ìˆ˜ };
      });
      í›„ë³´ì ìˆ˜.sort((a, b) => a.ì ìˆ˜ - b.ì ìˆ˜);
      
      return {
        ëŒ€í‘œë‚©ìŒ: í›„ë³´ì ìˆ˜[0].napeum,
        ë³´ì¡°í›„ë³´: [í›„ë³´ì ìˆ˜[1]?.napeum, í›„ë³´ì ìˆ˜[2]?.napeum].filter(Boolean),
        ì„ ì •ì´ìœ : "ë™ê¸°+ê³„ì ˆ",
        ë…„ì£¼í›„ë³´ì „ì²´
      };
    }


    // í•„í„°ëœ ë¦¬ìŠ¤íŠ¸ì—ì„œ ëŒ€í‘œ ë…„ì£¼ ë‚©ìŒ ì„ ì •
    function selectëŒ€í‘œë…„ì£¼ë‚©ìŒFromList(myNapeum, ë…„ì£¼í›„ë³´ë¦¬ìŠ¤íŠ¸) {
      if (!ë…„ì£¼í›„ë³´ë¦¬ìŠ¤íŠ¸ || ë…„ì£¼í›„ë³´ë¦¬ìŠ¤íŠ¸.length === 0) {
        return { ëŒ€í‘œë‚©ìŒ: null, ë³´ì¡°í›„ë³´: [], ì„ ì •ì´ìœ : "í›„ë³´ì—†ìŒ", ë…„ì£¼í›„ë³´ì „ì²´: [] };
      }
      
      // ìŒëŒ€ ë‚©ìŒ ì²´í¬ (ìµœìš°ì„ )
      const ë‚´ìŒëŒ€ = ìŒëŒ€ë‚©ìŒë§¤í•‘[myNapeum];
      if (ë‚´ìŒëŒ€ && ë…„ì£¼í›„ë³´ë¦¬ìŠ¤íŠ¸.includes(ë‚´ìŒëŒ€)) {
        const ë³´ì¡° = ë…„ì£¼í›„ë³´ë¦¬ìŠ¤íŠ¸.filter(n => n !== ë‚´ìŒëŒ€).slice(0, 2);
        return { ëŒ€í‘œë‚©ìŒ: ë‚´ìŒëŒ€, ë³´ì¡°í›„ë³´: ë³´ì¡°, ì„ ì •ì´ìœ : "ìŒëŒ€ë‚©ìŒ", ë…„ì£¼í›„ë³´ì „ì²´: ë…„ì£¼í›„ë³´ë¦¬ìŠ¤íŠ¸ };
      }
      
      // ë™ê¸° ìš°ì„ ìˆœìœ„ + ê³„ì ˆ ê·¼ì ‘ì„± ì¡°í•©
      const í›„ë³´ì ìˆ˜ = ë…„ì£¼í›„ë³´ë¦¬ìŠ¤íŠ¸.map((napeum, idx) => {
        const ê³„ì ˆì°¨ì´ = getê³„ì ˆê·¼ì ‘ì„±(myNapeum, napeum);
        const ì ìˆ˜ = idx * 2 + ê³„ì ˆì°¨ì´;
        return { napeum, ì ìˆ˜ };
      });
      í›„ë³´ì ìˆ˜.sort((a, b) => a.ì ìˆ˜ - b.ì ìˆ˜);
      
      return {
        ëŒ€í‘œë‚©ìŒ: í›„ë³´ì ìˆ˜[0].napeum,
        ë³´ì¡°í›„ë³´: [í›„ë³´ì ìˆ˜[1]?.napeum, í›„ë³´ì ìˆ˜[2]?.napeum].filter(Boolean),
        ì„ ì •ì´ìœ : "ë™ê¸°+ê³„ì ˆ",
        ë…„ì£¼í›„ë³´ì „ì²´: ë…„ì£¼í›„ë³´ë¦¬ìŠ¤íŠ¸
      };
    }

    // 4. ì˜¤í–‰ë³„ë‚©ìŒë¦¬ìŠ¤íŠ¸
    const ì˜¤í–‰ë³„ë‚©ìŒë¦¬ìŠ¤íŠ¸ = {
  "ëª©": [
    "ëŒ€ë¦¼ëª©",
    "ì†¡ë°±ëª©",
    "ì„ë¥˜ëª©",
    "ì–‘ë¥˜ëª©",
    "ìƒìëª©",
    "í‰ì§€ëª©"
  ],
  "í™”": [
    "ë…¸ì¤‘í™”",
    "ì‚°ë‘í™”",
    "ë³µë“±í™”",
    "ì²œìƒí™”",
    "ë²½ë ¥í™”",
    "ì‚°í•˜í™”"
  ],
  "í† ": [
    "ë…¸ë°©í† ",
    "ì„±ë‘í† ",
    "ëŒ€ì—­í† ",
    "ë²½ìƒí† ",
    "ì‚¬ì¤‘í† ",
    "ì˜¥ìƒí† "
  ],
  "ê¸ˆ": [
    "í•´ì¤‘ê¸ˆ",
    "ê²€ë´‰ê¸ˆ",
    "ì‚¬ì¤‘ê¸ˆ",
    "ë°±ë‚©ê¸ˆ",
    "ì°¨ì²œê¸ˆ",
    "ê¸ˆë°•ê¸ˆ"
  ],
  "ìˆ˜": [
    "ëŒ€í•´ìˆ˜",
    "ì²œí•˜ìˆ˜",
    "ì¥ë¥˜ìˆ˜",
    "ì²œì¤‘ìˆ˜",
    "ëŒ€ê³„ìˆ˜",
    "ê°„í•˜ìˆ˜"
  ]
};
    
    // 5. ì™¸ëª¨í…œí”Œë¦¿ (ì½”ë“œí˜•)
    const ì™¸ëª¨í…œí”Œë¦¿ = {
      // ===== ê¸ˆ(é‡‘) =====
      "í•´ì¤‘ê¸ˆ": {
        "ë‚¨": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "sharp", "í”¼ë¶€í†¤": "fair", "ë¶„ìœ„ê¸°": "ì§€ì ì´ê³  ì„¸ë ¨ëœ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "fair", "ë¶„ìœ„ê¸°": "ì§€ì ì´ê³  ì„¸ë ¨ëœ ì¸ìƒ" }
      },
      "ê²€ë´‰ê¸ˆ": {
        "ë‚¨": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "sharp", "í”¼ë¶€í†¤": "cool", "ë¶„ìœ„ê¸°": "ë‚ ì¹´ë¡­ê³  ê²°ë‹¨ë ¥ ìˆëŠ” ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "heart", "ëˆˆ": "sharp", "í”¼ë¶€í†¤": "cool", "ë¶„ìœ„ê¸°": "ë‚ ì¹´ë¡­ê³  ê²°ë‹¨ë ¥ ìˆëŠ” ì¸ìƒ" }
      },
      "ì‚¬ì¤‘ê¸ˆ": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "fair", "ë¶„ìœ„ê¸°": "ì„¬ì„¸í•˜ê³  ì •ì œëœ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "fair", "ë¶„ìœ„ê¸°": "ì„¬ì„¸í•˜ê³  ì •ì œëœ ì¸ìƒ" }
      },
      "ë°±ë‚©ê¸ˆ": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "fair", "ë¶„ìœ„ê¸°": "ë¶€ë“œëŸ½ê³  ë¹›ë‚˜ëŠ” ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "round", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "fair", "ë¶„ìœ„ê¸°": "ë¶€ë“œëŸ½ê³  ë¹›ë‚˜ëŠ” ì¸ìƒ" }
      },
      "ì°¨ì²œê¸ˆ": {
        "ë‚¨": { "ì–¼êµ´í˜•": "long", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "cool", "ë¶„ìœ„ê¸°": "ì˜ˆìˆ ì ì´ê³  ì„¸ë ¨ëœ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "cool", "ë¶„ìœ„ê¸°": "ì˜ˆìˆ ì ì´ê³  ì„¸ë ¨ëœ ì¸ìƒ" }
      },
      "ê¸ˆë°•ê¸ˆ": {
        "ë‚¨": { "ì–¼êµ´í˜•": "heart", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "fair", "ë¶„ìœ„ê¸°": "ì„¬ì„¸í•˜ê³  ê°ê°ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "heart", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "fair", "ë¶„ìœ„ê¸°": "ì„¬ì„¸í•˜ê³  ê°ê°ì ì¸ ì¸ìƒ" }
      },
      // ===== ëª©(æœ¨) =====
      "ëŒ€ë¦¼ëª©": {
        "ë‚¨": { "ì–¼êµ´í˜•": "long", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ë‹¨ë‹¨í•˜ê³  ìƒëª…ë ¥ ìˆëŠ” ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "long", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ì˜¨í™”í•˜ê³  ìƒëª…ë ¥ ìˆëŠ” ì¸ìƒ" }
      },
      "ì†¡ë°±ëª©": {
        "ë‚¨": { "ì–¼êµ´í˜•": "long", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ê³§ê³  ì¸ë‚´ì‹¬ ìˆëŠ” ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "long", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ê³§ê³  ì¸ë‚´ì‹¬ ìˆëŠ” ì¸ìƒ" }
      },
      "ì„ë¥˜ëª©": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "ê°ì„±ì ì´ê³  ì„±ìˆ™í•œ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "round", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "ê°ì„±ì ì´ê³  ì„±ìˆ™í•œ ì¸ìƒ" }
      },
      "ì–‘ë¥˜ëª©": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ìœ ì—°í•˜ê³  ê°ì„±ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "heart", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ìœ ì—°í•˜ê³  ê°ì„±ì ì¸ ì¸ìƒ" }
      },
      "ìƒìëª©": {
        "ë‚¨": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "ì‹¤ìš©ì ì´ê³  ì„±ì‹¤í•œ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "ì‹¤ìš©ì ì´ê³  ì„±ì‹¤í•œ ì¸ìƒ" }
      },
      "í‰ì§€ëª©": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ì•ˆì •ì ì´ê³  ê· í˜•ì¡íŒ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "round", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ì•ˆì •ì ì´ê³  ê· í˜•ì¡íŒ ì¸ìƒ" }
      },
      // ===== ìˆ˜(æ°´) =====
      "ëŒ€í•´ìˆ˜": {
        "ë‚¨": { "ì–¼êµ´í˜•": "round", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "fair", "ë¶„ìœ„ê¸°": "ê¹Šê³  ì‹ ë¹„ë¡œìš´ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "round", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "fair", "ë¶„ìœ„ê¸°": "ê¹Šê³  ì‹ ë¹„ë¡œìš´ ì¸ìƒ" }
      },
      "ì²œí•˜ìˆ˜": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "cool", "ë¶„ìœ„ê¸°": "ë‚­ë§Œì ì´ê³  ì˜ˆìˆ ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "heart", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "cool", "ë¶„ìœ„ê¸°": "ë‚­ë§Œì ì´ê³  ì˜ˆìˆ ì ì¸ ì¸ìƒ" }
      },
      "ì¥ë¥˜ìˆ˜": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "fair", "ë¶„ìœ„ê¸°": "ìœ ì—°í•˜ê³  ìˆœì‘ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "fair", "ë¶„ìœ„ê¸°": "ìœ ì—°í•˜ê³  ìˆœì‘ì ì¸ ì¸ìƒ" }
      },
      "ì²œì¤‘ìˆ˜": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "cool", "ë¶„ìœ„ê¸°": "ê¹Šì´ ìˆê³  ë‚´ë©´ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "round", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "cool", "ë¶„ìœ„ê¸°": "ê¹Šì´ ìˆê³  ë‚´ë©´ì ì¸ ì¸ìƒ" }
      },
      "ëŒ€ê³„ìˆ˜": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "cool", "ë¶„ìœ„ê¸°": "ì‹ ë¹„ë¡­ê³  ë‚´í–¥ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "heart", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "cool", "ë¶„ìœ„ê¸°": "ì‹ ë¹„ë¡­ê³  ë‚´í–¥ì ì¸ ì¸ìƒ" }
      },
      "ê°„í•˜ìˆ˜": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ì€ì€í•˜ê³  ê¹Šì€ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "round", "ëˆˆ": "deep", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ì€ì€í•˜ê³  ê¹Šì€ ì¸ìƒ" }
      },
      // ===== í™”(ç«) =====
      "ë…¸ì¤‘í™”": {
        "ë‚¨": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "bright", "í”¼ë¶€í†¤": "warm", "ë¶„ìœ„ê¸°": "ì—´ì •ì ì´ê³  ì§‘ì¤‘ë ¥ ìˆëŠ” ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "bright", "í”¼ë¶€í†¤": "warm", "ë¶„ìœ„ê¸°": "ì—´ì •ì ì´ê³  ì§‘ì¤‘ë ¥ ìˆëŠ” ì¸ìƒ" }
      },
      "ì‚°ë‘í™”": {
        "ë‚¨": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "bright", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "ë°ê³  ë¦¬ë”ì‹­ ìˆëŠ” ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "bright", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "ë°ê³  ë¦¬ë”ì‹­ ìˆëŠ” ì¸ìƒ" }
      },
      "ë³µë“±í™”": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "warm", "ë¶„ìœ„ê¸°": "ì˜¨í™”í•˜ê³  ì˜ê° ìˆëŠ” ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "round", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "warm", "ë¶„ìœ„ê¸°": "ì˜¨í™”í•˜ê³  ì˜ê° ìˆëŠ” ì¸ìƒ" }
      },
      "ì²œìƒí™”": {
        "ë‚¨": { "ì–¼êµ´í˜•": "long", "ëˆˆ": "bright", "í”¼ë¶€í†¤": "warm", "ë¶„ìœ„ê¸°": "ëŒ€ë²”í•˜ê³  í˜ì‹ ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "bright", "í”¼ë¶€í†¤": "warm", "ë¶„ìœ„ê¸°": "ëŒ€ë²”í•˜ê³  í˜ì‹ ì ì¸ ì¸ìƒ" }
      },
      "ë²½ë ¥í™”": {
        "ë‚¨": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "sharp", "í”¼ë¶€í†¤": "cool", "ë¶„ìœ„ê¸°": "ê°•ë ¬í•˜ê³  ìˆœê°„ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "heart", "ëˆˆ": "sharp", "í”¼ë¶€í†¤": "cool", "ë¶„ìœ„ê¸°": "ê°•ë ¬í•˜ê³  ìˆœê°„ì ì¸ ì¸ìƒ" }
      },
      "ì‚°í•˜í™”": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "í˜„ì‹¤ì ì´ê³  ë”°ëœ»í•œ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "round", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "í˜„ì‹¤ì ì´ê³  ë”°ëœ»í•œ ì¸ìƒ" }
      },
      // ===== í† (åœŸ) =====
      "ë…¸ë°©í† ": {
        "ë‚¨": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "ë”°ëœ»í•˜ê³  í¬ìš©ë ¥ ìˆëŠ” ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "round", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "ë”°ëœ»í•˜ê³  í¬ìš©ë ¥ ìˆëŠ” ì¸ìƒ" }
      },
      "ì„±ë‘í† ": {
        "ë‚¨": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "sharp", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ì•ˆì •ì ì´ê³  êµ¬ì¡°ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ì•ˆì •ì ì´ê³  êµ¬ì¡°ì ì¸ ì¸ìƒ" }
      },
      "ëŒ€ì—­í† ": {
        "ë‚¨": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "ì—°ê²°ì ì´ê³  ì‹¤ìš©ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "ì—°ê²°ì ì´ê³  ì‹¤ìš©ì ì¸ ì¸ìƒ" }
      },
      "ë²½ìƒí† ": {
        "ë‚¨": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "sharp", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ë°©ì–´ì ì´ê³  ì²´ê³„ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "clear", "í”¼ë¶€í†¤": "natural", "ë¶„ìœ„ê¸°": "ë°©ì–´ì ì´ê³  ì²´ê³„ì ì¸ ì¸ìƒ" }
      },
      "ì‚¬ì¤‘í† ": {
        "ë‚¨": { "ì–¼êµ´í˜•": "round", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "warm", "ë¶„ìœ„ê¸°": "ìœµí†µì„± ìˆê³  í¬ìš©ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "round", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "warm", "ë¶„ìœ„ê¸°": "ìœµí†µì„± ìˆê³  í¬ìš©ì ì¸ ì¸ìƒ" }
      },
      "ì˜¥ìƒí† ": {
        "ë‚¨": { "ì–¼êµ´í˜•": "square", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "ë‹¨ë‹¨í•˜ê³  ê°€ì •ì ì¸ ì¸ìƒ" },
        "ì—¬": { "ì–¼êµ´í˜•": "oval", "ëˆˆ": "warm", "í”¼ë¶€í†¤": "healthy", "ë¶„ìœ„ê¸°": "ë‹¨ë‹¨í•˜ê³  ê°€ì •ì ì¸ ì¸ìƒ" }
      }
    };

    // ì½”ë“œ â†’ í•œê¸€ ë§¤í•‘
    const ì™¸ëª¨ì½”ë“œë§¤í•‘ = {
      ì–¼êµ´í˜•: {
        "round": "ë‘¥ê·¼í˜•",
        "oval": "ê³„ë€í˜•", 
        "square": "ê°ì§„í˜•",
        "long": "ê¸´í˜•",
        "heart": "í•˜íŠ¸í˜•"
      },
      ëˆˆ: {
        "bright": "ë°ì€ ëˆˆ",
        "deep": "ê¹Šì€ ëˆˆ",
        "sharp": "ë‚ ì¹´ë¡œìš´ ëˆˆ",
        "warm": "ë”°ëœ»í•œ ëˆˆ",
        "clear": "ë§‘ì€ ëˆˆ"
      },
      í”¼ë¶€í†¤: {
        "fair": "í° í”¼ë¶€",
        "warm": "ì›œí†¤",
        "cool": "ì¿¨í†¤",
        "natural": "ìì—°í†¤",
        "healthy": "ê±´ê°•í†¤"
      }
    };

    // ì½”ë“œ â†’ í•œê¸€ ë³€í™˜ í•¨ìˆ˜
    function ì™¸ëª¨ë³€í™˜(oemo) {
      if (!oemo) return {};
      return {
        ì–¼êµ´í˜•: ì™¸ëª¨ì½”ë“œë§¤í•‘.ì–¼êµ´í˜•[oemo.ì–¼êµ´í˜•] || oemo.ì–¼êµ´í˜•,
        ëˆˆ: ì™¸ëª¨ì½”ë“œë§¤í•‘.ëˆˆ[oemo.ëˆˆ] || oemo.ëˆˆ,
        í”¼ë¶€í†¤: ì™¸ëª¨ì½”ë“œë§¤í•‘.í”¼ë¶€í†¤[oemo.í”¼ë¶€í†¤] || oemo.í”¼ë¶€í†¤,
        ë¶„ìœ„ê¸°: oemo.ë¶„ìœ„ê¸°
      };
    }


    // ===== ê³„ì‚° í•¨ìˆ˜ =====
    function calculate() {
      // ë³µë¶™ ì…ë ¥ì—ì„œ íŒŒì‹±ëœ ê°’ ì‚¬ìš©
      const inputText = document.getElementById('pasteInput').value;
      if (!inputText || !inputText.trim()) {
        alert('ë¨¼ì € ì‚¬ì£¼ê³„ì‚°ê¸° ê²°ê³¼ë¥¼ ë¶™ì—¬ë„£ê¸° í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      // íŒŒì‹± ì¬ì‹¤í–‰
      parseInput(inputText);
      
      if (!parsedInput.ilju || !parsedInput.myGender || !parsedInput.targetGender) {
        alert('í•„ìˆ˜ ì •ë³´ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.\n\ní•„ìš” ì •ë³´: ì¼ì£¼, ë³¸ì¸ì„±ë³„, ìƒëŒ€ì„±ë³„\nì˜ˆì‹œ: ì¼ì£¼: ç”²å­ | ë³¸ì¸ì„±ë³„: ë‚¨ | ìƒëŒ€ì„±ë³„: ì—¬');
        return;
      }
      
      const ilju = parsedInput.ilju;
      const myGender = parsedInput.myGender;
      const targetGender = parsedInput.targetGender;
      
      // Step 1: ì¼ì£¼ â†’ ì¼ê°„ ì˜¤í–‰ (ìƒìƒ ê³„ì‚°ìš©) + ë‚©ìŒ (ì™¸í˜•ìš©)
      const myData = ê°‘ìë‚©ìŒë§¤í•‘[ilju];
      if (!myData) {
        alert('ìœ íš¨í•˜ì§€ ì•Šì€ ì¼ì£¼ì…ë‹ˆë‹¤: ' + ilju);
        return;
      }
      const myNapeum = myData.ë‚©ìŒ;
      
      // ì¼ê°„(ì²œê°„) ì¶”ì¶œ â†’ ì¼ê°„ ì˜¤í–‰ (ìƒìƒ ê³„ì‚°ì˜ í•µì‹¬!)
      const ilgan = ilju.charAt(0);  // ì²« ê¸€ì = ì²œê°„
      const ilji = ilju.charAt(1);   // ë‘ ë²ˆì§¸ ê¸€ì = ì§€ì§€ (ìœ¡í•© ê³„ì‚°ìš©)
      const myOhang = ì²œê°„ì˜¤í–‰[ilgan];  // ì¼ê°„ ì˜¤í–‰
      
      // Step 2: ì˜¤í–‰ ìƒìƒê´€ê³„
      const inyeonOhang = ì˜¤í–‰ìƒìƒê´€ê³„[myOhang].ì¸ì—°ìƒì˜¤í–‰;
      const baewujaOhang = ì˜¤í–‰ìƒìƒê´€ê³„[myOhang].ë°°ìš°ììƒì˜¤í–‰;
      
      // Step 3: ì¼ì£¼ ë„ì¶œë‚©ìŒ (ì„±ê²©ìš©) - ìƒìƒ ì˜¤í–‰ì˜ ëŒ€í‘œ ë‚©ìŒ
      const inyeonì¼ì£¼ë‚©ìŒ = ë™ê¸°ë‚©ìŒìš°ì„ ìˆœìœ„[inyeonOhang][0];  // ì„±ê²©ìš©
      const baewujaì¼ì£¼ë‚©ìŒ = ë™ê¸°ë‚©ìŒìš°ì„ ìˆœìœ„[baewujaOhang][0]; // ì„±ê²©ìš©
      
      // Step 4: ë…„ì£¼ ì™¸í˜•í›„ë³´ (ì¼ì£¼ ë„ì¶œë‚©ìŒ ì œì™¸!)
      const inyeonNapeums = ë™ê¸°ë‚©ìŒìš°ì„ ìˆœìœ„[inyeonOhang].filter(n => n !== inyeonì¼ì£¼ë‚©ìŒ);
      const baewujaNapeums = ë™ê¸°ë‚©ìŒìš°ì„ ìˆœìœ„[baewujaOhang].filter(n => n !== baewujaì¼ì£¼ë‚©ìŒ);
      
      // Step 5: ë…„ì£¼ ëŒ€í‘œë‚©ìŒ ì„ ì • (ì œì™¸ëœ í›„ë³´ ì¤‘ì—ì„œ ìŒëŒ€â†’ë™ê¸°â†’ê³„ì ˆ)
      const inyeonë…„ì£¼ = selectëŒ€í‘œë…„ì£¼ë‚©ìŒFromList(myNapeum, inyeonNapeums);
      const baewujaë…„ì£¼ = selectëŒ€í‘œë…„ì£¼ë‚©ìŒFromList(myNapeum, baewujaNapeums);
      
      const inyeonDaepyo = inyeonë…„ì£¼.ëŒ€í‘œë‚©ìŒ;     // ë…„ì£¼ ëŒ€í‘œ (ì™¸ëª¨ìš©)
      const inyeonBojo = inyeonë…„ì£¼.ë³´ì¡°í›„ë³´ || [];
      console.log("inyeonë…„ì£¼:", inyeonë…„ì£¼);
      console.log("inyeonBojo:", inyeonBojo, "type:", typeof inyeonBojo, "isArray:", Array.isArray(inyeonBojo));
      const baewujaDaepyo = baewujaë…„ì£¼.ëŒ€í‘œë‚©ìŒ;   // ë…„ì£¼ ëŒ€í‘œ (ì™¸ëª¨ìš©)
      const baewujaBojo = baewujaë…„ì£¼.ë³´ì¡°í›„ë³´ || [];
      
      const inyeonì„ ì •ì´ìœ  = inyeonë…„ì£¼.ì„ ì •ì´ìœ ;
      const baewujaì„ ì •ì´ìœ  = baewujaë…„ì£¼.ì„ ì •ì´ìœ ;
      
      // Step 4: ì™¸ëª¨ ì •ë³´ (ë‘˜ë‹¤ ì„ íƒì‹œ ë‚¨/ì—¬ ëª¨ë‘)
      let inyeonOemo, baewujaOemo;
      if (targetGender === "ë‘˜ë‹¤") {
        inyeonOemo = {
          ë‚¨: ì™¸ëª¨ë³€í™˜(ì™¸ëª¨í…œí”Œë¦¿[inyeonDaepyo]?.["ë‚¨"] || {}),
          ì—¬: ì™¸ëª¨ë³€í™˜(ì™¸ëª¨í…œí”Œë¦¿[inyeonDaepyo]?.["ì—¬"] || {})
        };
        baewujaOemo = {
          ë‚¨: ì™¸ëª¨ë³€í™˜(ì™¸ëª¨í…œí”Œë¦¿[baewujaDaepyo]?.["ë‚¨"] || {}),
          ì—¬: ì™¸ëª¨ë³€í™˜(ì™¸ëª¨í…œí”Œë¦¿[baewujaDaepyo]?.["ì—¬"] || {})
        };
      } else {
        inyeonOemo = ì™¸ëª¨ë³€í™˜(ì™¸ëª¨í…œí”Œë¦¿[inyeonDaepyo]?.[targetGender] || {});
        baewujaOemo = ì™¸ëª¨ë³€í™˜(ì™¸ëª¨í…œí”Œë¦¿[baewujaDaepyo]?.[targetGender] || {});
      }
      
      // ê²°ê³¼ ë Œë”ë§
      renderFlow(ilju, myNapeum, myOhang, inyeonOhang, baewujaOhang, inyeonì¼ì£¼ë‚©ìŒ, baewujaì¼ì£¼ë‚©ìŒ, inyeonDaepyo, baewujaDaepyo);
      renderMyInfo(ilju, myNapeum, myOhang, myGender);
      renderInyeon(inyeonOhang, inyeonì¼ì£¼ë‚©ìŒ, inyeonDaepyo, inyeonBojo, inyeonNapeums, inyeonOemo, targetGender, inyeonì„ ì •ì´ìœ );
      renderBaewuja(baewujaOhang, baewujaì¼ì£¼ë‚©ìŒ, baewujaDaepyo, baewujaBojo, baewujaNapeums, baewujaOemo, targetGender, baewujaì„ ì •ì´ìœ );
      
      document.getElementById('resultSection').classList.add('show');
      document.getElementById('copySection').classList.add('show');
      
      // ê²°ê³¼ ì €ì¥ (ë³µì‚¬ìš©)
      lastResult = {
        "ì…ë ¥": {
          "ì¼ì£¼": ilju,
          "ì¼ê°„": ilgan,
          "ì¼ì§€": ilji,
          "ë³¸ì¸ì„±ë³„": myGender,
          "ìƒëŒ€ì„±ë³„": targetGender
        },
        "ë³¸ì¸": {
          "ë‚©ìŒ": myNapeum,
          "ì˜¤í–‰": myOhang
        },
        "ì¸ì—°ìƒ": {
          "ì˜¤í–‰": inyeonOhang,
          "ì„±ê²©_ìœ¡í•©ì§€ì§€": ìœ¡í•©ë§¤í•‘[ilji]?.ìœ¡í•©ì§€ì§€ || "",
          "ì¸ì—°ìœ í˜•": ìœ¡í•©ë§¤í•‘[ilji]?.ì¸ì—°ìœ í˜• || "",
          "ì„±ê²©_í‚¤ì›Œë“œ": ìœ¡í•©ë§¤í•‘[ilji]?.í‚¤ì›Œë“œ || "",
          "ì¼ì£¼ë„ì¶œë‚©ìŒ": inyeonì¼ì£¼ë‚©ìŒ,
          "ë…„ì£¼ëŒ€í‘œë‚©ìŒ": inyeonDaepyo,
          "ë³´ì¡°í›„ë³´": inyeonBojo,
          "ë…„ì£¼ì™¸í˜•í›„ë³´": inyeonNapeums,
          "ì„ ì •ì´ìœ ": inyeonì„ ì •ì´ìœ ,
          "ì™¸ëª¨": inyeonOemo
        },
        "ë°°ìš°ììƒ": {
          "ì˜¤í–‰": baewujaOhang,
          "ì„±ê²©_ëŒ€í‘œì§€ì§€": ì˜¤í–‰ëŒ€í‘œì§€ì§€[baewujaOhang]?.ëŒ€í‘œì§€ì§€ || "",
          "ì¸ì—°ìœ í˜•": ì˜¤í–‰ëŒ€í‘œì§€ì§€[baewujaOhang]?.ì¸ì—°ìœ í˜• || "",
          "ì„±ê²©_í‚¤ì›Œë“œ": ì˜¤í–‰ëŒ€í‘œì§€ì§€[baewujaOhang]?.í‚¤ì›Œë“œ || "",
          "ì¼ì£¼ë„ì¶œë‚©ìŒ": baewujaì¼ì£¼ë‚©ìŒ,
          "ë…„ì£¼ëŒ€í‘œë‚©ìŒ": baewujaDaepyo,
          "ë³´ì¡°í›„ë³´": baewujaBojo,
          "ë…„ì£¼ì™¸í˜•í›„ë³´": baewujaNapeums,
          "ì„ ì •ì´ìœ ": baewujaì„ ì •ì´ìœ ,
          "ì™¸ëª¨": baewujaOemo
        }
      };
    }
    
    function renderFlow(ilju, napeum, ohang, inyeonOhang, baewujaOhang, inyeonì¼ì£¼ë‚©ìŒ, baewujaì¼ì£¼ë‚©ìŒ, inyeonë…„ì£¼ë‚©ìŒ, baewujaë…„ì£¼ë‚©ìŒ) {
      const html = `
        <h4>ğŸ“Š ê³„ì‚° í”Œë¡œìš°</h4>
        <div class="flow-step">
          <span class="step-num">1</span>
          ì¼ì£¼ ë‚©ìŒ: ${ilju} <span class="arrow">â†’</span> ${napeum} <span class="arrow">â†’</span> ${ohang}
        </div>
        <div class="flow-step">
          <span class="step-num">2</span>
          ì¸ì—°ìƒ: ${ohang} <span class="arrow">â†’</span> ${inyeonOhang} (ë‚´ê°€ ìƒí•¨) <span class="arrow">â†’</span> ${inyeonì¼ì£¼ë‚©ìŒ}
        </div>
        <div class="flow-step">
          <span class="step-num">3</span>
          ë°°ìš°ììƒ: ${baewujaOhang} <span class="arrow">â†’</span> ${ohang} (ë‚˜ë¥¼ ìƒí•¨) <span class="arrow">â†’</span> ${baewujaì¼ì£¼ë‚©ìŒ}
        </div>
      `;
      document.getElementById('flowSection').innerHTML = html;
    }
    
    function renderMyInfo(ilju, napeum, ohang, gender) {
      const napeumInfo = ë‚©ìŒë§ˆìŠ¤í„°[napeum] || {};
      const html = `
        <h3>ğŸ”® ë³¸ì¸ ì •ë³´</h3>
        <div class="info-row">
          <span class="info-label">ì¼ì£¼</span>
          <span class="info-value">${ilju}</span>
        </div>
        <div class="info-row">
          <span class="info-label">ë‚©ìŒ</span>
          <span class="info-value">${napeum} (${napeumInfo.í•œì || ''})</span>
        </div>
        <div class="info-row">
          <span class="info-label">ì˜¤í–‰</span>
          <span class="info-value"><span class="tag ohang">${ohang}</span></span>
        </div>
        <div class="info-row">
          <span class="info-label">ì¬ì§ˆ</span>
          <span class="info-value">${napeumInfo.ì¬ì§ˆ || ''}</span>
        </div>
        <div class="info-row">
          <span class="info-label">ì„±ë³„</span>
          <span class="info-value">${gender === 'ë‚¨' ? 'ë‚¨ì„±' : 'ì—¬ì„±'}</span>
        </div>
      `;
      document.getElementById('myInfoCard').innerHTML = html;
    }
    
    function renderInyeon(ohang, iljuë‚©ìŒ, ë…„ì£¼ë‚©ìŒ, bojo, allNapeums, oemo, targetGender, reason) {
      const napeumInfo = ë‚©ìŒë§ˆìŠ¤í„°[ë…„ì£¼ë‚©ìŒ] || {};
      const html = `
        <h3>ğŸ’˜ ì¸ì—°ìƒ (ê°ì •ì  ëŒë¦¼)</h3>
        <p style="color:#888; font-size:0.85rem; margin-bottom:16px;">ë‚´ê°€ ìƒ(ç”Ÿ)í•´ì£¼ëŠ” ì˜¤í–‰ â€” ë³¸ëŠ¥ì ìœ¼ë¡œ ëŒë¦¬ëŠ” ìƒëŒ€</p>
        <div class="info-row">
          <span class="info-label">ì˜¤í–‰</span>
          <span class="info-value"><span class="tag ohang">${ohang}</span></span>
        </div>
        <div class="info-row">
          <span class="info-label">ì¼ì£¼ ë„ì¶œë‚©ìŒ</span>
          <span class="info-value"><span class="tag napeum">${iljuë‚©ìŒ}</span> <span style="color:#888;font-size:0.8em;">(ì„±ê²©)</span></span>
        </div>
        <div class="info-row">
          <span class="info-label">ë…„ì£¼ ëŒ€í‘œë‚©ìŒ</span>
          <span class="info-value"><span class="tag napeum">${ë…„ì£¼ë‚©ìŒ}</span> (${napeumInfo.í•œì || ''}) <span style="color:#888;font-size:0.8em;">(ì™¸ëª¨)</span></span>
        </div>
        <div class="info-row">
          <span class="info-label">ë³´ì¡°í›„ë³´</span>
          <span class="info-value">${bojo.map(n => `<span class="tag bojo">${n}</span>`).join('')}</span>
        </div>
        <div class="candidates">
          <div class="candidates-title">ğŸ“‹ ë…„ì£¼ ì™¸í˜• í›„ë³´êµ° (${allNapeums.filter(n => n !== ë…„ì£¼ë‚©ìŒ).length}ê°œ)</div>
          <div>${allNapeums.filter(n => n !== ë…„ì£¼ë‚©ìŒ).map(n => `<span class="tag bojo">${n}</span>`).join('')}</div>
        </div>
        <div class="oemo-section">
          <h4>ğŸ‘¤ ${targetGender === 'ë‚¨' ? 'ë‚¨ì„±' : 'ì—¬ì„±'} ì™¸ëª¨ íŠ¹ì§•</h4>
          ${Object.entries(oemo).map(([k, v]) => `
            <div class="oemo-item">
              <span class="oemo-item-label">${k}</span>
              <span class="oemo-item-value">${v}</span>
            </div>
          `).join('')}
        </div>
      `;
      document.getElementById('inyeonCard').innerHTML = html;
    }
    
    function renderBaewuja(ohang, iljuë‚©ìŒ, ë…„ì£¼ë‚©ìŒ, bojo, allNapeums, oemo, targetGender, reason) {
      const napeumInfo = ë‚©ìŒë§ˆìŠ¤í„°[ë…„ì£¼ë‚©ìŒ] || {};
      const html = `
        <h3>ğŸ’ ë°°ìš°ììƒ (í˜„ì‹¤ì  ì•ˆì •)</h3>
        <p style="color:#888; font-size:0.85rem; margin-bottom:16px;">ë‚˜ë¥¼ ìƒ(ç”Ÿ)í•´ì£¼ëŠ” ì˜¤í–‰ â€” í˜„ì‹¤ì—ì„œ ì•ˆì •ê°ì„ ì£¼ëŠ” ìƒëŒ€</p>
        <div class="info-row">
          <span class="info-label">ì˜¤í–‰</span>
          <span class="info-value"><span class="tag ohang">${ohang}</span></span>
        </div>
        <div class="info-row">
          <span class="info-label">ì¼ì£¼ ë„ì¶œë‚©ìŒ</span>
          <span class="info-value"><span class="tag napeum">${iljuë‚©ìŒ}</span> <span style="color:#888;font-size:0.8em;">(ì„±ê²©)</span></span>
        </div>
        <div class="info-row">
          <span class="info-label">ë…„ì£¼ ëŒ€í‘œë‚©ìŒ</span>
          <span class="info-value"><span class="tag napeum">${ë…„ì£¼ë‚©ìŒ}</span> (${napeumInfo.í•œì || ''}) <span style="color:#888;font-size:0.8em;">(ì™¸ëª¨)</span></span>
        </div>
        <div class="info-row">
          <span class="info-label">ë³´ì¡°í›„ë³´</span>
          <span class="info-value">${bojo.map(n => `<span class="tag bojo">${n}</span>`).join('')}</span>
        </div>
        <div class="candidates">
          <div class="candidates-title">ğŸ“‹ ë…„ì£¼ ì™¸í˜• í›„ë³´êµ° (${allNapeums.filter(n => n !== ë…„ì£¼ë‚©ìŒ).length}ê°œ)</div>
          <div>${allNapeums.filter(n => n !== ë…„ì£¼ë‚©ìŒ).map(n => `<span class="tag bojo">${n}</span>`).join('')}</div>
        </div>
        <div class="oemo-section">
          <h4>ğŸ‘¤ ${targetGender === 'ë‚¨' ? 'ë‚¨ì„±' : 'ì—¬ì„±'} ì™¸ëª¨ íŠ¹ì§•</h4>
          ${Object.entries(oemo).map(([k, v]) => `
            <div class="oemo-item">
              <span class="oemo-item-label">${k}</span>
              <span class="oemo-item-value">${v}</span>
            </div>
          `).join('')}
        </div>
      `;
      document.getElementById('baewujaCard').innerHTML = html;
    }
    
    // ========== iframe ìë™í™”ìš© postMessage í•¸ë“¤ëŸ¬ ==========
    window.addEventListener('message', function(event) {
      if (event.data && event.data.action === 'calculateInyeon') {
        try {
          const data = event.data.inyeonData;
          // ì…ë ¥ê°’ ì„¤ì •
          document.getElementById('pasteInput').value = data.inputText || '';
          
          // íŒŒì‹±
          parsedInput = {
            ilju: data.ilju || null,
            myGender: data.myGender || null,
            targetGender: data.targetGender || null
          };
          
          // ìœ íš¨ì„± ê²€ì‚¬
          if (!parsedInput.ilju || !parsedInput.myGender || !parsedInput.targetGender) {
            window.parent.postMessage({
              action: 'inyeonCalcResult',
              success: false,
              error: 'í•„ìˆ˜ ì •ë³´ ë¶€ì¡± (ì¼ì£¼, ë³¸ì¸ì„±ë³„, ìƒëŒ€ì„±ë³„)'
            }, '*');
            return;
          }
          
          // ê³„ì‚° ì‹¤í–‰ (calculate í•¨ìˆ˜ ë‚´ë¶€ ë¡œì§ ì§ì ‘ ì‹¤í–‰)
          const ilju = parsedInput.ilju;
          const myGender = parsedInput.myGender;
          const targetGender = parsedInput.targetGender;
          
          const myData = ê°‘ìë‚©ìŒë§¤í•‘[ilju];
          if (!myData) {
            window.parent.postMessage({
              action: 'inyeonCalcResult',
              success: false,
              error: 'ìœ íš¨í•˜ì§€ ì•Šì€ ì¼ì£¼: ' + ilju
            }, '*');
            return;
          }
          
          const myNapeum = myData.ë‚©ìŒ;
          const ilgan = ilju.charAt(0);
          const myOhang = ì²œê°„ì˜¤í–‰[ilgan];
          
          const inyeonOhang = ì˜¤í–‰ìƒìƒê´€ê³„[myOhang].ì¸ì—°ìƒì˜¤í–‰;
          const baewujaOhang = ì˜¤í–‰ìƒìƒê´€ê³„[myOhang].ë°°ìš°ììƒì˜¤í–‰;
          
          const inyeonì¼ì£¼ë‚©ìŒ = ë™ê¸°ë‚©ìŒìš°ì„ ìˆœìœ„[inyeonOhang][0];
          const baewujaì¼ì£¼ë‚©ìŒ = ë™ê¸°ë‚©ìŒìš°ì„ ìˆœìœ„[baewujaOhang][0];
          
          const inyeonNapeums = ë™ê¸°ë‚©ìŒìš°ì„ ìˆœìœ„[inyeonOhang].filter(n => n !== inyeonì¼ì£¼ë‚©ìŒ);
          const baewujaNapeums = ë™ê¸°ë‚©ìŒìš°ì„ ìˆœìœ„[baewujaOhang].filter(n => n !== baewujaì¼ì£¼ë‚©ìŒ);
          
          const inyeonë…„ì£¼ = selectëŒ€í‘œë…„ì£¼ë‚©ìŒFromList(myNapeum, inyeonNapeums);
          const baewujaë…„ì£¼ = selectëŒ€í‘œë…„ì£¼ë‚©ìŒFromList(myNapeum, baewujaNapeums);
          
          const inyeonDaepyo = inyeonë…„ì£¼.ëŒ€í‘œë‚©ìŒ;
          const baewujaDaepyo = baewujaë…„ì£¼.ëŒ€í‘œë‚©ìŒ;
          
          // ë³´ì¡°í›„ë³´, ì„ ì •ì´ìœ 
          const inyeonBojo = inyeonë…„ì£¼.ë³´ì¡°í›„ë³´ || [];
          const baewujaBojo = baewujaë…„ì£¼.ë³´ì¡°í›„ë³´ || [];
          const inyeonì„ ì •ì´ìœ  = inyeonë…„ì£¼.ì„ ì •ì´ìœ  || '';
          const baewujaì„ ì •ì´ìœ  = baewujaë…„ì£¼.ì„ ì •ì´ìœ  || '';
          
          let inyeonOemo, baewujaOemo;
          if (targetGender === "ë‘˜ë‹¤") {
            inyeonOemo = {
              ë‚¨: ì™¸ëª¨ë³€í™˜(ì™¸ëª¨í…œí”Œë¦¿[inyeonDaepyo]?.["ë‚¨"] || {}),
              ì—¬: ì™¸ëª¨ë³€í™˜(ì™¸ëª¨í…œí”Œë¦¿[inyeonDaepyo]?.["ì—¬"] || {})
            };
            baewujaOemo = {
              ë‚¨: ì™¸ëª¨ë³€í™˜(ì™¸ëª¨í…œí”Œë¦¿[baewujaDaepyo]?.["ë‚¨"] || {}),
              ì—¬: ì™¸ëª¨ë³€í™˜(ì™¸ëª¨í…œí”Œë¦¿[baewujaDaepyo]?.["ì—¬"] || {})
            };
          } else {
            inyeonOemo = ì™¸ëª¨ë³€í™˜(ì™¸ëª¨í…œí”Œë¦¿[inyeonDaepyo]?.[targetGender] || {});
            baewujaOemo = ì™¸ëª¨ë³€í™˜(ì™¸ëª¨í…œí”Œë¦¿[baewujaDaepyo]?.[targetGender] || {});
          }
          
          // ì¼ì§€ ì¶”ì¶œ (ìœ¡í•© ê³„ì‚°ìš©)
          const ilji = ilju.charAt(1);
          
          const result = {
            ì…ë ¥: { 
              ì¼ì£¼: ilju, 
              ì¼ê°„: ilgan,
              ì¼ì§€: ilji,
              ë³¸ì¸ì„±ë³„: myGender, 
              ìƒëŒ€ì„±ë³„: targetGender 
            },
            ë³¸ì¸: { ë‚©ìŒ: myNapeum, ì˜¤í–‰: myOhang },
            ì¸ì—°ìƒ: {
              ì˜¤í–‰: inyeonOhang,
              ì„±ê²©_ìœ¡í•©ì§€ì§€: ìœ¡í•©ë§¤í•‘[ilji]?.ìœ¡í•©ì§€ì§€ || "",
              ì¸ì—°ìœ í˜•: ìœ¡í•©ë§¤í•‘[ilji]?.ì¸ì—°ìœ í˜• || "",
              ì„±ê²©_í‚¤ì›Œë“œ: ìœ¡í•©ë§¤í•‘[ilji]?.í‚¤ì›Œë“œ || "",
              ì¼ì£¼ë„ì¶œë‚©ìŒ: inyeonì¼ì£¼ë‚©ìŒ,
              ë…„ì£¼ëŒ€í‘œë‚©ìŒ: inyeonDaepyo,
              ë³´ì¡°í›„ë³´: inyeonBojo,
              ë…„ì£¼ì™¸í˜•í›„ë³´: inyeonNapeums,
              ì„ ì •ì´ìœ : inyeonì„ ì •ì´ìœ ,
              ì™¸ëª¨: inyeonOemo
            },
            ë°°ìš°ììƒ: {
              ì˜¤í–‰: baewujaOhang,
              ì„±ê²©_ëŒ€í‘œì§€ì§€: ì˜¤í–‰ëŒ€í‘œì§€ì§€[baewujaOhang]?.ëŒ€í‘œì§€ì§€ || "",
              ì¸ì—°ìœ í˜•: ì˜¤í–‰ëŒ€í‘œì§€ì§€[baewujaOhang]?.ì¸ì—°ìœ í˜• || "",
              ì„±ê²©_í‚¤ì›Œë“œ: ì˜¤í–‰ëŒ€í‘œì§€ì§€[baewujaOhang]?.í‚¤ì›Œë“œ || "",
              ì¼ì£¼ë„ì¶œë‚©ìŒ: baewujaì¼ì£¼ë‚©ìŒ,
              ë…„ì£¼ëŒ€í‘œë‚©ìŒ: baewujaDaepyo,
              ë³´ì¡°í›„ë³´: baewujaBojo,
              ë…„ì£¼ì™¸í˜•í›„ë³´: baewujaNapeums,
              ì„ ì •ì´ìœ : baewujaì„ ì •ì´ìœ ,
              ì™¸ëª¨: baewujaOemo
            }
          };
          
          lastResult = result;
          
          // ê²°ê³¼ ë°˜í™˜
          window.parent.postMessage({
            action: 'inyeonCalcResult',
            success: true,
            result: JSON.stringify(result, null, 2)
          }, '*');
          
        } catch (error) {
          window.parent.postMessage({
            action: 'inyeonCalcResult',
            success: false,
            error: error.message
          }, '*');
        }
      }
    });
  </script>
  <a href="index.html" style="position:fixed; bottom:20px; right:20px; z-index:9999; width:50px; height:50px; background:linear-gradient(135deg,#d4af82,#b8956a); border-radius:50%; display:flex; align-items:center; justify-content:center; text-decoration:none; font-size:24px; box-shadow:0 4px 15px rgba(0,0,0,0.3);">ğŸ </a>
</body>
</html>
